import{j as e}from"./ui-D7Zc9tn1.js";import{r as c,u as D}from"./vendor-B7m-6-nt.js";import{S as A}from"./SkeletonLoader-1ZpraJm7.js";import{T as O}from"./triangle-alert-BtHSnAKW.js";import{D as $}from"./download-B0sxssfE.js";import{c as N}from"./index-C0m64t3w.js";import{T as v}from"./trending-up-DEwAvnGg.js";import{R as p,P as B,a as W,C as K,T as u,L as P,b as w,X as C,Y as S,c as z,B as U,d as Y}from"./charts-B6BcPGoj.js";import{T as h}from"./TouchFeedback-DCDl4U_0.js";import{T as k}from"./truck-BEbUxseg.js";import{H}from"./house-YwzmHMHO.js";const q=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Q=N("calendar",q);const X=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],T=N("package",X);const G=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],J=N("search",G);function Z(){const[d,x]=c.useState(!0),[r,g]=c.useState(null);c.useEffect(()=>{i();const o=setInterval(i,6e4);return()=>clearInterval(o)},[]);const i=async()=>{try{const o=await fetch("http://localhost:8787/ics218/forms?limit=1000");if(o.ok){const t=(await o.json()).forms||[],n=new Date,f=n.getMonth(),I=n.getFullYear(),F=new Date(n.getTime()-10080*60*1e3),L=t.filter(s=>{const a=new Date(s.created_at);return a.getMonth()===f&&a.getFullYear()===I}).length,_=t.filter(s=>new Date(s.created_at)>=F).length,M=t.reduce((s,a)=>s+(a.vehicleCount||0),0),b={};t.forEach(s=>{const a=s.vehicle_category||"Uncategorized";b[a]=(b[a]||0)+1});const E=Object.entries(b).map(([s,a])=>({category:s,count:a})).sort((s,a)=>a.count-s.count),V=new Date(n.getTime()-720*60*60*1e3),j={};t.filter(s=>new Date(s.created_at)>=V).forEach(s=>{const a=new Date(s.created_at).toISOString().split("T")[0];j[a]=(j[a]||0)+1});const R=Object.entries(j).map(([s,a])=>({date:s,count:a})).sort((s,a)=>s.date.localeCompare(a.date));g({totalForms:t.length,totalVehicles:M,formsByCategory:E,formsThisMonth:L,formsThisWeek:_,formsPerDay:R})}}catch(o){console.error("Error fetching ICS-218 analytics:",o)}finally{x(!1)}},y=()=>{if(!r)return;const o=[["Metric","Value"],["Total Forms",r.totalForms],["Total Vehicles",r.totalVehicles],["Forms This Month",r.formsThisMonth],["Forms This Week",r.formsThisWeek]].map(f=>f.join(",")).join(`
`),l=new Blob([o],{type:"text/csv"}),t=URL.createObjectURL(l),n=document.createElement("a");n.href=t,n.download=`ics218-analytics-${new Date().toISOString().split("T")[0]}.csv`,n.click()};if(d)return e.jsx("div",{className:"space-y-4",children:Array.from({length:4}).map((o,l)=>e.jsx(A,{type:"card"},l))});if(!r)return e.jsxs("div",{className:"text-center p-8 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl",children:[e.jsx(O,{className:"w-12 h-12 text-red-600 dark:text-red-400 mx-auto mb-3"}),e.jsx("p",{className:"text-red-800 dark:text-red-200 font-semibold",children:"Failed to load analytics data"}),e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 mt-1",children:"Please try refreshing the page"})]});const m=["#f97316","#fb923c","#fdba74","#fed7aa","#ffedd5"];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"ICS-218 Analytics"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Equipment & Vehicle Inventory Performance Metrics"})]}),e.jsxs("button",{onClick:y,className:"flex items-center gap-2 px-4 py-2 bg-orange-600 hover:bg-orange-700 text-white rounded-lg font-medium transition-colors shadow-sm",children:[e.jsx($,{className:"w-4 h-4"}),"Export Data"]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-orange-500 to-orange-600 text-white rounded-xl shadow-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-orange-100 text-sm font-medium",children:"Total Forms"}),e.jsx("div",{className:"text-2xl",children:"ðŸ“‹"})]}),e.jsx("p",{className:"text-4xl font-bold",children:r.totalForms}),e.jsx("p",{className:"text-orange-100 text-xs mt-2",children:"All-time submissions"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-red-500 to-red-600 text-white rounded-xl shadow-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-red-100 text-sm font-medium",children:"Total Vehicles"}),e.jsx(T,{className:"w-6 h-6 text-red-100"})]}),e.jsx("p",{className:"text-4xl font-bold",children:r.totalVehicles}),e.jsx("p",{className:"text-red-100 text-xs mt-2",children:"Tracked in inventory"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-amber-500 to-amber-600 text-white rounded-xl shadow-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-amber-100 text-sm font-medium",children:"This Month"}),e.jsx(v,{className:"w-6 h-6 text-amber-100"})]}),e.jsx("p",{className:"text-4xl font-bold",children:r.formsThisMonth}),e.jsx("p",{className:"text-amber-100 text-xs mt-2",children:"Current month activity"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-yellow-500 to-yellow-600 text-white rounded-xl shadow-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-yellow-100 text-sm font-medium",children:"This Week"}),e.jsx("div",{className:"text-2xl",children:"ðŸ“…"})]}),e.jsx("p",{className:"text-4xl font-bold",children:r.formsThisWeek}),e.jsx("p",{className:"text-yellow-100 text-xs mt-2",children:"Last 7 days"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 border border-gray-200 dark:border-gray-700",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-4 flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-8 bg-gradient-to-b from-orange-500 to-red-500 rounded-full"}),"Vehicle Category Distribution"]}),e.jsx(p,{width:"100%",height:300,children:e.jsxs(B,{children:[e.jsx(W,{data:r.formsByCategory,cx:"50%",cy:"50%",labelLine:!1,label:o=>`${o.category}: ${o.count}`,outerRadius:100,fill:"#8884d8",dataKey:"count",children:r.formsByCategory.map((o,l)=>e.jsx(K,{fill:m[l%m.length]},`cell-${l}`))}),e.jsx(u,{contentStyle:{backgroundColor:"#1f2937",border:"none",borderRadius:"8px",color:"#fff"}})]})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 border border-gray-200 dark:border-gray-700",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-4 flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-8 bg-gradient-to-b from-amber-500 to-yellow-500 rounded-full"}),"Inventory Activity (Last 30 Days)"]}),e.jsx(p,{width:"100%",height:300,children:e.jsxs(P,{data:r.formsPerDay,children:[e.jsx(w,{strokeDasharray:"3 3",stroke:"#374151"}),e.jsx(C,{dataKey:"date",stroke:"#9ca3af",tick:{fontSize:11},angle:-45,textAnchor:"end",height:60}),e.jsx(S,{stroke:"#9ca3af"}),e.jsx(u,{contentStyle:{backgroundColor:"#1f2937",border:"none",borderRadius:"8px"},labelStyle:{color:"#fff"}}),e.jsx(z,{type:"monotone",dataKey:"count",stroke:"#f97316",strokeWidth:3,dot:{fill:"#f97316",r:5,strokeWidth:2,stroke:"#fff"},activeDot:{r:7}})]})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 border border-gray-200 dark:border-gray-700 lg:col-span-2",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-4 flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-8 bg-gradient-to-b from-orange-500 to-amber-500 rounded-full"}),"Forms by Category"]}),e.jsx(p,{width:"100%",height:300,children:e.jsxs(U,{data:r.formsByCategory,children:[e.jsx(w,{strokeDasharray:"3 3",stroke:"#374151"}),e.jsx(C,{dataKey:"category",stroke:"#9ca3af",angle:-45,textAnchor:"end",height:100,tick:{fontSize:11}}),e.jsx(S,{stroke:"#9ca3af"}),e.jsx(u,{contentStyle:{backgroundColor:"#1f2937",border:"none",borderRadius:"8px"},labelStyle:{color:"#fff"}}),e.jsx(Y,{dataKey:"count",fill:"#f97316",radius:[8,8,0,0]})]})})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-orange-50 to-amber-50 dark:from-gray-800 dark:to-gray-900 border border-orange-100 dark:border-gray-700 rounded-xl p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-4",children:"ðŸ“Š Key Insights"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 bg-orange-100 dark:bg-orange-900/30 rounded-lg",children:e.jsx(T,{className:"w-5 h-5 text-orange-600 dark:text-orange-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"Inventory Scale"}),e.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:[r.totalVehicles," vehicles tracked across ",r.totalForms," forms"]})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 bg-amber-100 dark:bg-amber-900/30 rounded-lg",children:e.jsx(v,{className:"w-5 h-5 text-amber-600 dark:text-amber-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"Activity Level"}),e.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:[r.formsThisMonth," forms this month (",r.formsThisWeek," this week)"]})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 bg-yellow-100 dark:bg-yellow-900/30 rounded-lg",children:e.jsx("div",{className:"w-5 h-5 text-yellow-600 dark:text-yellow-400 flex items-center justify-center font-bold text-xs",children:"#1"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"Top Category"}),e.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:[r.formsByCategory[0]?.category||"N/A"," with ",r.formsByCategory[0]?.count||0," forms"]})]})]})]})]})]})}function ee(){const[d,x]=c.useState([]),[r,g]=c.useState(!0),[i,y]=c.useState(""),m=D();c.useEffect(()=>{o()},[]);const o=async()=>{try{const t=await fetch("http://localhost:8787/ics218/forms?limit=100");if(t.ok){const n=await t.json();x(n.forms||[])}}catch(t){console.error("Error fetching ICS-218 forms:",t)}finally{g(!1)}},l=d.filter(t=>t.incident_name?.toLowerCase().includes(i.toLowerCase())||t.vehicle_category?.toLowerCase().includes(i.toLowerCase())||t.id.toString().includes(i));return r?e.jsx("div",{className:"space-y-4",children:Array.from({length:5}).map((t,n)=>e.jsx(A,{type:"card"},n))}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(J,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search by incident name, category, or ID...",value:i,onChange:t=>y(t.target.value),className:"w-full pl-10 pr-4 py-3 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-700 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent transition-all"})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600 dark:text-gray-400",children:[e.jsxs("span",{children:[l.length," forms found"]}),e.jsx("button",{onClick:o,className:"text-orange-600 dark:text-orange-400 hover:underline",children:"Refresh"})]}),l.length===0?e.jsxs("div",{className:"text-center py-12 bg-gray-50 dark:bg-gray-800 rounded-xl border-2 border-dashed border-gray-300 dark:border-gray-700",children:[e.jsx(k,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 font-medium",children:"No ICS-218 forms found"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-500 mt-1",children:i?"Try a different search term":"Forms will appear here once submitted"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:l.map(t=>e.jsx(h,{children:e.jsxs("div",{onClick:()=>m(`/admin/ics218/${t.id}`),className:"bg-white dark:bg-gray-800 rounded-xl shadow-md hover:shadow-xl transition-all duration-300 p-6 cursor-pointer border border-gray-200 dark:border-gray-700 hover:border-orange-500 dark:hover:border-orange-500",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsx("div",{className:"p-3 bg-gradient-to-br from-orange-500 to-red-500 text-white rounded-lg",children:e.jsx(k,{className:"w-6 h-6"})}),e.jsx("span",{className:"px-3 py-1 bg-orange-100 dark:bg-orange-900/30 text-orange-800 dark:text-orange-400 text-xs font-semibold rounded-full",children:"ICS-218"})]}),e.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-2 line-clamp-1",children:t.incident_name||"Unnamed Incident"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-600 dark:text-gray-400",children:[e.jsx(Q,{className:"w-4 h-4"}),e.jsx("span",{children:new Date(t.created_at).toLocaleDateString()})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-600 dark:text-gray-400",children:[e.jsx(k,{className:"w-4 h-4"}),e.jsxs("span",{children:[t.vehicleCount||0," vehicles"]})]}),t.vehicle_category&&e.jsx("div",{className:"mt-2 px-2 py-1 bg-gray-100 dark:bg-gray-700 rounded text-xs font-medium text-gray-700 dark:text-gray-300 inline-block",children:t.vehicle_category})]}),e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:e.jsx("span",{className:"text-orange-600 dark:text-orange-400 text-sm font-semibold hover:underline",children:"View Details â†’"})})]})},t.id))})]})}function me(){const[d,x]=c.useState("list"),r=D();return e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[e.jsxs("header",{className:"sticky top-0 z-50 bg-white dark:bg-gray-800 shadow-md",children:[e.jsx("div",{className:"px-4 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:"/taskforce-io-logo.png",alt:"TASKFORCE IO",className:"w-10 h-10 object-contain"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"TASKFORCE IO Admin"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Equipment & Vehicle Inventory"})]}),e.jsx(h,{children:e.jsxs("button",{onClick:()=>r("/admin"),className:"flex items-center gap-2 px-4 py-2 bg-orange-600 hover:bg-orange-700 text-white rounded-lg transition-colors",title:"Return to Admin Hub",children:[e.jsx(H,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Hub"})]})})]})}),e.jsxs("nav",{className:"flex border-t border-gray-200 dark:border-gray-700",children:[e.jsx(h,{children:e.jsx("button",{onClick:()=>x("list"),className:`flex-1 px-4 py-3 text-sm font-medium transition-colors ${d==="list"?"border-b-2 border-orange-600 text-orange-600 dark:text-orange-400 bg-orange-50 dark:bg-orange-900/20":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-50 dark:hover:bg-gray-700/50"}`,children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("span",{children:"ðŸ“‹"}),e.jsx("span",{className:"hidden sm:inline",children:"Forms"})]})})}),e.jsx(h,{children:e.jsx("button",{onClick:()=>x("analytics"),className:`flex-1 px-4 py-3 text-sm font-medium transition-colors ${d==="analytics"?"border-b-2 border-orange-600 text-orange-600 dark:text-orange-400 bg-orange-50 dark:bg-orange-900/20":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-50 dark:hover:bg-gray-700/50"}`,children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("span",{children:"ðŸ“Š"}),e.jsx("span",{className:"hidden sm:inline",children:"Analytics"})]})})})]})]}),e.jsx("main",{className:"p-4 pb-20 md:p-6 lg:p-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[d==="list"&&e.jsx(ee,{}),d==="analytics"&&e.jsx(Z,{})]})})]})}export{me as ICS218AdminDashboard};
//# sourceMappingURL=ICS218AdminDashboard-7UOp2Yjs.js.map
