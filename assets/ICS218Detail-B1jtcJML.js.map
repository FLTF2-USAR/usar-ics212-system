{"version":3,"file":"ICS218Detail-B1jtcJML.js","sources":["../../src/components/admin/ICS218Detail.tsx"],"sourcesContent":["/**\n * ICS 218 Form Detail Component\n * \n * Displays complete ICS 218 form details when admin clicks on a form\n * Shows incident info, vehicle table, prepared by info, PDF link, and GitHub issue\n */\n\nimport { useState, useEffect } from 'react';\nimport { API_ENDPOINTS } from '../../lib/config';\nimport { SkeletonLoader } from '../mobile/SkeletonLoader';\n\ninterface ICS218Vehicle {\n  id: string;\n  order_request_number?: string;\n  incident_id_no?: string;\n  classification: string;\n  make: string;\n  category_kind_type: string;\n  features?: string;\n  agency_owner: string;\n  operator_name_contact: string;\n  vehicle_license_id: string;\n  incident_assignment: string;\n  start_date_time: string;\n  release_date_time?: string;\n  row_order: number;\n}\n\ninterface ICS218FormData {\n  id: string;\n  incident_name: string;\n  incident_number: string;\n  date_prepared: string;\n  time_prepared: string;\n  vehicle_category: string;\n  prepared_by_name: string;\n  prepared_by_position: string;\n  signature_data: string;\n  signature_timestamp: string;\n  pdf_url?: string;\n  pdf_filename?: string;\n  github_issue_url?: string;\n  github_issue_number?: number;\n  created_at: string;\n  vehicles: ICS218Vehicle[];\n}\n\ninterface Props {\n  formId: string;\n}\n\nexport function ICS218Detail({ formId }: Props) {\n  const [form, setForm] = useState<ICS218FormData | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n\n  useEffect(() => {\n    fetchFormDetails();\n  }, [formId]);\n\n  const fetchFormDetails = async () => {\n    setLoading(true);\n    setError(null);\n\n    try {\n      const response = await fetch(API_ENDPOINTS.ics218FormById(formId));\n      \n      if (!response.ok) {\n        throw new Error('Failed to fetch form details');\n      }\n\n      const data = await response.json();\n      setForm(data.form);\n    } catch (err) {\n      console.error('Error fetching ICS 218 form details:', err);\n      setError(err instanceof Error ? err.message : 'Unknown error');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleDownloadPDF = () => {\n    if (form?.pdf_url) {\n      window.open(form.pdf_url, '_blank');\n    }\n  };\n\n  const handleViewGitHub = () => {\n    if (form?.github_issue_url) {\n      window.open(form.github_issue_url, '_blank');\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"space-y-4 p-4\">\n        <SkeletonLoader type=\"card\" />\n        <SkeletonLoader type=\"card\" />\n        <SkeletonLoader type=\"card\" />\n      </div>\n    );\n  }\n\n  if (error || !form) {\n    return (\n      <div className=\"p-4\">\n        <div className=\"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4\">\n          <p className=\"text-red-800 dark:text-red-200\">\n            {error || 'Form not found'}\n          </p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6 p-4 max-h-[70vh] overflow-y-auto\">\n      {/* Header Section */}\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <h2 className=\"text-xl font-bold text-gray-900 dark:text-white\">\n            ICS 218 - Support Vehicle/Equipment Log\n          </h2>\n          <span className=\"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200\">\n            ICS 218\n          </span>\n        </div>\n        \n        {/* Incident Info */}\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm\">\n          <div>\n            <label className=\"font-semibold text-gray-700 dark:text-gray-300\">Incident Name:</label>\n            <p className=\"text-gray-900 dark:text-white\">{form.incident_name}</p>\n          </div>\n          <div>\n            <label className=\"font-semibold text-gray-700 dark:text-gray-300\">Incident Number:</label>\n            <p className=\"text-gray-900 dark:text-white\">{form.incident_number || 'N/A'}</p>\n          </div>\n          <div>\n            <label className=\"font-semibold text-gray-700 dark:text-gray-300\">Date Prepared:</label>\n            <p className=\"text-gray-900 dark:text-white\">\n              {new Date(form.date_prepared).toLocaleDateString()}\n            </p>\n          </div>\n          <div>\n            <label className=\"font-semibold text-gray-700 dark:text-gray-300\">Time Prepared:</label>\n            <p className=\"text-gray-900 dark:text-white\">{form.time_prepared}</p>\n          </div>\n          <div>\n            <label className=\"font-semibold text-gray-700 dark:text-gray-300\">Vehicle Category:</label>\n            <p className=\"text-gray-900 dark:text-white\">{form.vehicle_category}</p>\n          </div>\n        </div>\n      </div>\n\n      {/* Vehicles Table */}\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4\">\n        <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-4\">\n          Vehicles ({form.vehicles.length})\n        </h3>\n        \n        <div className=\"overflow-x-auto\">\n          <table className=\"min-w-full text-sm\">\n            <thead className=\"bg-gray-50 dark:bg-gray-700\">\n              <tr>\n                <th className=\"px-3 py-2 text-left font-semibold text-gray-700 dark:text-gray-300\">Classification</th>\n                <th className=\"px-3 py-2 text-left font-semibold text-gray-700 dark:text-gray-300\">Make/Type</th>\n                <th className=\"px-3 py-2 text-left font-semibold text-gray-700 dark:text-gray-300\">License ID</th>\n                <th className=\"px-3 py-2 text-left font-semibold text-gray-700 dark:text-gray-300\">Agency</th>\n                <th className=\"px-3 py-2 text-left font-semibold text-gray-700 dark:text-gray-300\">Operator</th>\n                <th className=\"px-3 py-2 text-left font-semibold text-gray-700 dark:text-gray-300\">Assignment</th>\n              </tr>\n            </thead>\n            <tbody className=\"divide-y divide-gray-200 dark:divide-gray-700\">\n              {form.vehicles.map((vehicle) => (\n                <tr key={vehicle.id} className=\"hover:bg-gray-50 dark:hover:bg-gray-700\">\n                  <td className=\"px-3 py-2 text-gray-900 dark:text-white\">{vehicle.classification}</td>\n                  <td className=\"px-3 py-2 text-gray-900 dark:text-white\">\n                    {vehicle.make} {vehicle.category_kind_type}\n                  </td>\n                  <td className=\"px-3 py-2 text-gray-900 dark:text-white\">{vehicle.vehicle_license_id}</td>\n                  <td className=\"px-3 py-2 text-gray-900 dark:text-white\">{vehicle.agency_owner}</td>\n                  <td className=\"px-3 py-2 text-gray-900 dark:text-white\">{vehicle.operator_name_contact}</td>\n                  <td className=\"px-3 py-2 text-gray-900 dark:text-white\">{vehicle.incident_assignment}</td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        </div>\n      </div>\n\n      {/* Prepared By Section */}\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4\">\n        <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-4\">\n          Prepared By\n        </h3>\n        \n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm\">\n          <div>\n            <label className=\"font-semibold text-gray-700 dark:text-gray-300\">Name:</label>\n            <p className=\"text-gray-900 dark:text-white\">{form.prepared_by_name}</p>\n          </div>\n          <div>\n            <label className=\"font-semibold text-gray-700 dark:text-gray-300\">Position/Title:</label>\n            <p className=\"text-gray-900 dark:text-white\">{form.prepared_by_position}</p>\n          </div>\n          <div>\n            <label className=\"font-semibold text-gray-700 dark:text-gray-300\">Signature Date/Time:</label>\n            <p className=\"text-gray-900 dark:text-white\">\n              {new Date(form.signature_timestamp).toLocaleString()}\n            </p>\n          </div>\n        </div>\n\n        {/* Signature Preview */}\n        {form.signature_data && (\n          <div className=\"mt-4\">\n            <label className=\"font-semibold text-gray-700 dark:text-gray-300 block mb-2\">Signature:</label>\n            <div className=\"border border-gray-300 dark:border-gray-600 rounded-lg p-2 bg-white dark:bg-gray-900 inline-block\">\n              <img \n                src={form.signature_data} \n                alt=\"Signature\" \n                className=\"max-w-xs h-20\"\n              />\n            </div>\n          </div>\n        )}\n      </div>\n\n      {/* Actions */}\n      <div className=\"flex gap-3\">\n        {form.pdf_url && (\n          <button\n            onClick={handleDownloadPDF}\n            className=\"flex-1 px-4 py-3 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition-colors flex items-center justify-center gap-2\"\n          >\n            <svg className=\"w-5 h-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\" />\n            </svg>\n            Download PDF\n          </button>\n        )}\n        \n        {form.github_issue_url && (\n          <button\n            onClick={handleViewGitHub}\n            className=\"flex-1 px-4 py-3 bg-gray-800 text-white rounded-lg font-semibold hover:bg-gray-900 transition-colors flex items-center justify-center gap-2\"\n          >\n            <svg className=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path d=\"M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z\"/>\n            </svg>\n            View GitHub Issue\n          </button>\n        )}\n      </div>\n\n      {/* Meta Info */}\n      <div className=\"text-xs text-gray-500 dark:text-gray-400 text-center\">\n        Form ID: {form.id} | Submitted: {new Date(form.created_at).toLocaleString()}\n      </div>\n    </div>\n  );\n}\n"],"names":["ICS218Detail","formId","form","setForm","useState","loading","setLoading","error","setError","useEffect","fetchFormDetails","response","API_ENDPOINTS","data","err","handleDownloadPDF","handleViewGitHub","jsxs","jsx","SkeletonLoader","vehicle"],"mappings":"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"}