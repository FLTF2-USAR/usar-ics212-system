import{j as e,c as ne,m as v,A as I}from"./ui-qyH4TQhP.js";import{r as u,R as ie}from"./vendor-Duk_Y8N0.js";import{z as k}from"./index-C-LK1zn9.js";import{T as j}from"./TouchFeedback-BRUDPQK4.js";import{S as ae}from"./SkeletonLoader-C6FHfKAz.js";const oe=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),le=r=>r.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,s,n)=>n?n.toUpperCase():s.toLowerCase()),V=r=>{const t=le(r);return t.charAt(0).toUpperCase()+t.slice(1)},q=(...r)=>r.filter((t,s,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===s).join(" ").trim(),de=r=>{for(const t in r)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};var ce={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const he=u.forwardRef(({color:r="currentColor",size:t=24,strokeWidth:s=2,absoluteStrokeWidth:n,className:a="",children:i,iconNode:d,...o},c)=>u.createElement("svg",{ref:c,...ce,width:t,height:t,stroke:r,strokeWidth:n?Number(s)*24/Number(t):s,className:q("lucide",a),...!i&&!de(o)&&{"aria-hidden":"true"},...o},[...d.map(([l,h])=>u.createElement(l,h)),...Array.isArray(i)?i:[i]]));const P=(r,t)=>{const s=u.forwardRef(({className:n,...a},i)=>u.createElement(he,{ref:i,iconNode:t,className:q(`lucide-${oe(V(r))}`,`lucide-${r}`,n),...a}));return s.displayName=V(r),s};const ue=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],xe=P("chevron-down",ue);const me=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],A=P("circle-check-big",me);const ge=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],pe=P("circle-x",ge);const be=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],ye=P("loader-circle",be);const fe=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],ve=P("lock",fe);const Ne=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],we=P("save",Ne);const je=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],T=P("square-pen",je);const ke=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Se=P("trash-2",ke);const _e=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],H=P("triangle-alert",_e);function Pe(r,t=[]){let s=[];function n(i,d){const o=u.createContext(d);o.displayName=i+"Context";const c=s.length;s=[...s,d];const l=x=>{const{scope:p,children:m,...g}=x,b=p?.[r]?.[c]||o,w=u.useMemo(()=>g,Object.values(g));return e.jsx(b.Provider,{value:w,children:m})};l.displayName=i+"Provider";function h(x,p){const m=p?.[r]?.[c]||o,g=u.useContext(m);if(g)return g;if(d!==void 0)return d;throw new Error(`\`${x}\` must be used within \`${i}\``)}return[l,h]}const a=()=>{const i=s.map(d=>u.createContext(d));return function(o){const c=o?.[r]||i;return u.useMemo(()=>({[`__scope${r}`]:{...o,[r]:c}}),[o,c])}};return a.scopeName=r,[n,Ce(a,...t)]}function Ce(...r){const t=r[0];if(r.length===1)return t;const s=()=>{const n=r.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(i){const d=n.reduce((o,{useScope:c,scopeName:l})=>{const x=c(i)[`__scope${l}`];return{...o,...x}},{});return u.useMemo(()=>({[`__scope${t.scopeName}`]:d}),[d])}};return s.scopeName=t.scopeName,s}var Ee=Symbol.for("react.lazy"),L=ie[" use ".trim().toString()];function Ie(r){return typeof r=="object"&&r!==null&&"then"in r}function G(r){return r!=null&&typeof r=="object"&&"$$typeof"in r&&r.$$typeof===Ee&&"_payload"in r&&Ie(r._payload)}function Te(r){const t=De(r),s=u.forwardRef((n,a)=>{let{children:i,...d}=n;G(i)&&typeof L=="function"&&(i=L(i._payload));const o=u.Children.toArray(i),c=o.find(Le);if(c){const l=c.props.children,h=o.map(x=>x===c?u.Children.count(l)>1?u.Children.only(null):u.isValidElement(l)?l.props.children:null:x);return e.jsx(t,{...d,ref:a,children:u.isValidElement(l)?u.cloneElement(l,void 0,h):null})}return e.jsx(t,{...d,ref:a,children:i})});return s.displayName=`${r}.Slot`,s}function De(r){const t=u.forwardRef((s,n)=>{let{children:a,...i}=s;if(G(a)&&typeof L=="function"&&(a=L(a._payload)),u.isValidElement(a)){const d=Re(a),o=Oe(i,a.props);return a.type!==u.Fragment&&(o.ref=n?ne(n,d):d),u.cloneElement(a,o)}return u.Children.count(a)>1?u.Children.only(null):null});return t.displayName=`${r}.SlotClone`,t}var Ae=Symbol("radix.slottable");function Le(r){return u.isValidElement(r)&&typeof r.type=="function"&&"__radixId"in r.type&&r.type.__radixId===Ae}function Oe(r,t){const s={...t};for(const n in t){const a=r[n],i=t[n];/^on[A-Z]/.test(n)?a&&i?s[n]=(...o)=>{const c=i(...o);return a(...o),c}:a&&(s[n]=a):n==="style"?s[n]={...a,...i}:n==="className"&&(s[n]=[a,i].filter(Boolean).join(" "))}return{...r,...s}}function Re(r){let t=Object.getOwnPropertyDescriptor(r.props,"ref")?.get,s=t&&"isReactWarning"in t&&t.isReactWarning;return s?r.ref:(t=Object.getOwnPropertyDescriptor(r,"ref")?.get,s=t&&"isReactWarning"in t&&t.isReactWarning,s?r.props.ref:r.props.ref||r.ref)}var $e=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Y=$e.reduce((r,t)=>{const s=Te(`Primitive.${t}`),n=u.forwardRef((a,i)=>{const{asChild:d,...o}=a,c=d?s:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(c,{...o,ref:i})});return n.displayName=`Primitive.${t}`,{...r,[t]:n}},{}),U="Progress",W=100,[Me]=Pe(U),[Fe,Ue]=Me(U),X=u.forwardRef((r,t)=>{const{__scopeProgress:s,value:n=null,max:a,getValueLabel:i=We,...d}=r;(a||a===0)&&!z(a)&&console.error(Ve(`${a}`,"Progress"));const o=z(a)?a:W;n!==null&&!B(n,o)&&console.error(He(`${n}`,"Progress"));const c=B(n,o)?n:null,l=O(c)?i(c,o):void 0;return e.jsx(Fe,{scope:s,value:c,max:o,children:e.jsx(Y.div,{"aria-valuemax":o,"aria-valuemin":0,"aria-valuenow":O(c)?c:void 0,"aria-valuetext":l,role:"progressbar","data-state":Q(c,o),"data-value":c??void 0,"data-max":o,...d,ref:t})})});X.displayName=U;var J="ProgressIndicator",Z=u.forwardRef((r,t)=>{const{__scopeProgress:s,...n}=r,a=Ue(J,s);return e.jsx(Y.div,{"data-state":Q(a.value,a.max),"data-value":a.value??void 0,"data-max":a.max,...n,ref:t})});Z.displayName=J;function We(r,t){return`${Math.round(r/t*100)}%`}function Q(r,t){return r==null?"indeterminate":r===t?"complete":"loading"}function O(r){return typeof r=="number"}function z(r){return O(r)&&!isNaN(r)&&r>0}function B(r,t){return O(r)&&!isNaN(r)&&r<=t&&r>=0}function Ve(r,t){return`Invalid prop \`max\` of value \`${r}\` supplied to \`${t}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${W}\`.`}function He(r,t){return`Invalid prop \`value\` of value \`${r}\` supplied to \`${t}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${W} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var ze=X,Be=Z;const qe=({currentStep:r,totalSteps:t,labels:s,showPercentage:n=!0,className:a=""})=>{const i=r/t*100;return e.jsxs("div",{className:`w-full ${a}`,children:[e.jsx("div",{className:"flex justify-between items-center mb-2",children:Array.from({length:t},(d,o)=>{const c=o<r,l=o===r-1,h=o+1;return e.jsxs("div",{className:"flex flex-col items-center flex-1",children:[e.jsx(v.div,{className:`
                  w-10 h-10 rounded-full flex items-center justify-center font-bold text-sm
                  ${c?"bg-green-600 text-white":""}
                  ${l?"bg-blue-600 text-white ring-4 ring-blue-200":""}
                  ${!c&&!l?"bg-gray-200 text-gray-600":""}
                `,initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:260,damping:20,delay:o*.1},children:c?"âœ“":h}),s&&s[o]&&e.jsx("span",{className:`
                    text-xs mt-1 text-center max-w-[60px] leading-tight
                    ${l?"font-semibold text-blue-600":"text-gray-600"}
                  `,children:s[o]})]},o)})}),e.jsx(ze,{className:"relative overflow-hidden bg-gray-200 rounded-full w-full h-3 mt-4",value:i,children:e.jsx(Be,{asChild:!0,children:e.jsx(v.div,{className:"bg-gradient-to-r from-blue-500 to-blue-600 h-full rounded-full",initial:{width:0},animate:{width:`${i}%`},transition:{type:"spring",stiffness:100,damping:20}})})}),n&&e.jsxs(v.div,{className:"text-center mt-2 text-sm font-semibold text-gray-700",initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},children:["Step ",r," of ",t," (",Math.round(i),"% complete)"]})]})},Ge=({formData:r,onChange:t,onNext:s,errors:n})=>{const a=o=>{o.preventDefault(),s()},i=()=>new Date().toISOString().split("T")[0],d=()=>{const o=new Date,c=String(o.getHours()).padStart(2,"0"),l=String(o.getMinutes()).padStart(2,"0");return`${c}:${l}`};return e.jsxs(v.form,{className:"space-y-6 p-4 md:p-6",onSubmit:a,initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Incident Information"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Complete prior to vehicle inspection"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"incidentName",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Incident Name *"}),e.jsx("input",{type:"text",id:"incidentName",value:r.incidentName||"",onChange:o=>t("incidentName",o.target.value),placeholder:"e.g., Wildfire Response 2024",maxLength:100,className:`
            w-full px-4 py-3 text-base rounded-xl border-2 transition-all
            focus:outline-none focus:ring-4
            ${n.incidentName?"border-red-500 focus:border-red-500 focus:ring-red-100":"border-gray-300 focus:border-blue-500 focus:ring-blue-100"}
          `,style:{minHeight:"56px"}}),n.incidentName&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:n.incidentName})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"inspectorDate",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Date *"}),e.jsx("input",{type:"date",id:"inspectorDate",value:r.inspectorDate||i(),onChange:o=>t("inspectorDate",o.target.value),max:i(),className:`
              w-full px-4 py-3 text-base rounded-xl border-2 transition-all
              focus:outline-none focus:ring-4
              ${n.inspectorDate?"border-red-500 focus:border-red-500 focus:ring-red-100":"border-gray-300 focus:border-blue-500 focus:ring-blue-100"}
            `,style:{minHeight:"56px"}}),n.inspectorDate&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:n.inspectorDate})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"inspectorTime",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Time *"}),e.jsx("input",{type:"time",id:"inspectorTime",value:r.inspectorTime||d(),onChange:o=>t("inspectorTime",o.target.value),className:`
              w-full px-4 py-3 text-base rounded-xl border-2 transition-all
              focus:outline-none focus:ring-4
              ${n.inspectorTime?"border-red-500 focus:border-red-500 focus:ring-red-100":"border-gray-300 focus:border-blue-500 focus:ring-blue-100"}
            `,style:{minHeight:"56px"}}),n.inspectorTime&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:n.inspectorTime})]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"orderNo",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:["Order Number ",e.jsx("span",{className:"text-gray-500",children:"(Optional)"})]}),e.jsx("input",{type:"text",id:"orderNo",value:r.orderNo||"",onChange:o=>t("orderNo",o.target.value),placeholder:"e.g., ORDER-2024-00123",maxLength:50,className:`
            w-full px-4 py-3 text-base rounded-xl border-2 border-gray-300
            transition-all focus:outline-none focus:ring-4
            focus:border-blue-500 focus:ring-blue-100
          `,style:{minHeight:"56px"}})]}),e.jsx(j,{onTap:()=>s(),hapticType:"medium",children:e.jsx("button",{type:"submit",className:`
            w-full bg-blue-600 hover:bg-blue-700 text-white font-bold
            py-4 px-6 rounded-xl transition-all shadow-lg hover:shadow-xl
            focus:outline-none focus:ring-4 focus:ring-blue-300
          `,style:{minHeight:"56px"},children:"Next: Vehicle Selection"})})]})},Ye=({value:r,onChange:t,onVehicleSelect:s,apiEndpoint:n="/api/vehicles/autocomplete",className:a="",error:i})=>{const[d,o]=u.useState(!1),[c,l]=u.useState([]),[h,x]=u.useState(!1),[p,m]=u.useState(r),g=u.useRef(null),b=u.useRef(null);u.useEffect(()=>{if(g.current&&clearTimeout(g.current),p.trim().length<2){l([]),o(!1);return}return g.current=setTimeout(async()=>{x(!0);try{const y=await fetch(`${n}?q=${encodeURIComponent(p)}`);if(y.ok){const C=await y.json();l(C.vehicles||[]),o(!0)}}catch(y){console.error("Vehicle search error:",y),l([])}finally{x(!1)}},300),()=>{g.current&&clearTimeout(g.current)}},[p,n]),u.useEffect(()=>{const y=C=>{b.current&&!b.current.contains(C.target)&&o(!1)};return document.addEventListener("mousedown",y),()=>document.removeEventListener("mousedown",y)},[]);const w=y=>{const C=y.target.value;m(C),t(C)},S=y=>{m(y.vehicleId),t(y.vehicleId,y),s?.(y),o(!1)};return e.jsxs("div",{ref:b,className:`relative ${a}`,children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:p,onChange:w,onFocus:()=>p.length>=2&&o(!0),placeholder:"Search vehicle ID, make, or model...",className:`
            w-full px-4 py-3 text-base rounded-xl border-2 transition-all
            focus:outline-none focus:ring-4
            ${i?"border-red-500 focus:border-red-500 focus:ring-red-100":"border-gray-300 focus:border-blue-500 focus:ring-blue-100"}
            ${h?"pr-12":""}
          `,style:{minHeight:"48px"}}),h&&e.jsx("div",{className:"absolute right-4 top-1/2 -translate-y-1/2",children:e.jsx(v.div,{className:"w-5 h-5 border-3 border-blue-500 border-t-transparent rounded-full",animate:{rotate:360},transition:{repeat:1/0,duration:1,ease:"linear"}})})]}),i&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:i}),e.jsx(I,{children:d&&c.length>0&&e.jsx(v.div,{className:"absolute z-50 w-full mt-2 bg-white dark:bg-gray-800 rounded-xl shadow-2xl max-h-80 overflow-y-auto",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},children:c.map(y=>e.jsx(v.button,{onClick:()=>S(y),className:"w-full px-4 py-3 text-left hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors border-b border-gray-200 dark:border-gray-700 last:border-b-0",style:{minHeight:"56px"},whileHover:{backgroundColor:"rgba(59, 130, 246, 0.1)"},whileTap:{scale:.98},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:y.vehicleId}),(y.make||y.model)&&e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[y.year,y.make,y.model].filter(Boolean).join(" ")}),y.agencyUnit&&e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500 mt-0.5",children:y.agencyUnit})]}),y.status&&e.jsx("span",{className:`
                        ml-3 px-2 py-1 text-xs font-medium rounded-full
                        ${y.status==="In Service"?"bg-green-100 text-green-800":y.status==="Out of Service"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}
                      `,children:y.status})]})},y.id))})}),h&&d&&e.jsx("div",{className:"absolute z-50 w-full mt-2 bg-white dark:bg-gray-800 rounded-xl shadow-2xl p-4",children:e.jsx(ae,{type:"text",count:3})})]})},Xe=({formData:r,onChange:t,onNext:s,onBack:n,errors:a})=>{const[i,d]=u.useState(null),o=l=>{d(l),t("vehicleIdNo",l.vehicleId),t("vehicleLicenseNo",l.licensePlate||""),t("vehicleType",l.vehicleType||""),t("agencyRegUnit",l.agencyUnit||"")},c=l=>{l.preventDefault(),s()};return e.jsxs(v.form,{className:"space-y-6 p-4 md:p-6",onSubmit:c,initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Vehicle Selection"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Select the vehicle to inspect"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Vehicle ID *"}),e.jsx(Ye,{value:r.vehicleIdNo||"",onChange:l=>t("vehicleIdNo",l),onVehicleSelect:o,error:a.vehicleIdNo,apiEndpoint:"/api/vehicles/autocomplete"}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Search by vehicle ID, make, or model"})]}),i&&e.jsxs(v.div,{className:"bg-blue-50 dark:bg-blue-900/20 border-2 border-blue-200 dark:border-blue-800 rounded-xl p-4",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},children:[e.jsx("h3",{className:"text-sm font-semibold text-blue-900 dark:text-blue-100 mb-3",children:"Selected Vehicle Details"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Make/Model"}),e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:[i.year,i.make,i.model].filter(Boolean).join(" ")||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"License Plate"}),e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:i.licensePlate||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Agency Unit"}),e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:i.agencyUnit||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Status"}),e.jsx("span",{className:`
                  inline-block px-2 py-1 text-xs font-medium rounded-full
                  ${i.status==="In Service"?"bg-green-100 text-green-800":i.status==="Out of Service"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}
                `,children:i.status||"Unknown"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"odometerReading",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Odometer Reading (miles) *"}),e.jsx("input",{type:"number",id:"odometerReading",value:r.odometerReading||"",onChange:l=>t("odometerReading",parseInt(l.target.value)||0),placeholder:"Enter current odometer reading",min:0,max:999999999,className:`
            w-full px-4 py-3 text-base rounded-xl border-2 transition-all
            focus:outline-none focus:ring-4
            ${a.odometerReading?"border-red-500 focus:border-red-500 focus:ring-red-100":"border-gray-300 focus:border-blue-500 focus:ring-blue-100"}
          `,style:{minHeight:"56px"}}),a.odometerReading&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.odometerReading}),i?.lastOdometer&&e.jsxs("p",{className:"mt-1 text-xs text-gray-500",children:["Last recorded: ",i.lastOdometer.toLocaleString()," miles"]})]}),e.jsxs("div",{className:"space-y-4 bg-gray-50 dark:bg-gray-800/50 rounded-xl p-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:"Auto-Populated Vehicle Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-600 dark:text-gray-400 mb-1",children:"License Number"}),e.jsx("input",{type:"text",value:r.vehicleLicenseNo||"",onChange:l=>t("vehicleLicenseNo",l.target.value),placeholder:"Enter license number",className:"w-full px-3 py-2 text-sm rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-600 dark:text-gray-400 mb-1",children:"Agency Reg/Unit"}),e.jsx("input",{type:"text",value:r.agencyRegUnit||"",onChange:l=>t("agencyRegUnit",l.target.value),placeholder:"Enter agency unit",className:"w-full px-3 py-2 text-sm rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-xs text-gray-600 dark:text-gray-400 mb-1",children:"Vehicle Type"}),e.jsx("input",{type:"text",value:r.vehicleType||"",onChange:l=>t("vehicleType",l.target.value),placeholder:"e.g., Rescue, Engine, Ladder",className:"w-full px-3 py-2 text-sm rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700"})]})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(j,{onTap:()=>n(),hapticType:"light",children:e.jsx("button",{type:"button",onClick:n,className:`
              flex-1 bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold
              py-4 px-6 rounded-xl transition-all
              focus:outline-none focus:ring-4 focus:ring-gray-300
            `,style:{minHeight:"56px"},children:"Back"})}),e.jsx(j,{onTap:()=>s(),hapticType:"medium",children:e.jsx("button",{type:"submit",className:`
              flex-[2] bg-blue-600 hover:bg-blue-700 text-white font-bold
              py-4 px-6 rounded-xl transition-all shadow-lg hover:shadow-xl
              focus:outline-none focus:ring-4 focus:ring-blue-300
            `,style:{minHeight:"56px"},children:"Next: Inspection Items"})})]})]})},D=[{itemNumber:1,description:"Gauges and lights",status:"n/a",isSafetyItem:!0,reference:"See back*"},{itemNumber:2,description:"Seat belts",status:"n/a",isSafetyItem:!0,reference:"See back*"},{itemNumber:3,description:"Glass and mirrors",status:"n/a",isSafetyItem:!0,reference:"See back*"},{itemNumber:4,description:"Wipers and horn",status:"n/a",isSafetyItem:!0,reference:"See back*"},{itemNumber:5,description:"Engine compartment",status:"n/a",isSafetyItem:!0,reference:"See back*"},{itemNumber:6,description:"Fuel System",status:"n/a",isSafetyItem:!0,reference:"See back*"},{itemNumber:7,description:"Steering",status:"n/a",isSafetyItem:!0,reference:"See back*"},{itemNumber:8,description:"Brakes",status:"n/a",isSafetyItem:!0,reference:"See back*"},{itemNumber:9,description:"Drive line U-joints",status:"n/a",isSafetyItem:!1,reference:"Check play"},{itemNumber:10,description:"Springs and shocks",status:"n/a",isSafetyItem:!0,reference:"See back*"},{itemNumber:11,description:"Exhaust system",status:"n/a",isSafetyItem:!0,reference:"See back*"},{itemNumber:12,description:"Frame",status:"n/a",isSafetyItem:!0,reference:"See back*"},{itemNumber:13,description:"Tire and wheels",status:"n/a",isSafetyItem:!0,reference:"See back*"},{itemNumber:14,description:"Coupling devices / Emergency exit (buses)",status:"n/a",isSafetyItem:!1},{itemNumber:15,description:"Pump operation",status:"n/a",isSafetyItem:!1},{itemNumber:16,description:"Damage on incident",status:"n/a",isSafetyItem:!1},{itemNumber:17,description:"Other",status:"n/a",isSafetyItem:!1}],Je=({formData:r,onChange:t,onNext:s,onBack:n,errors:a})=>{const[i,d]=u.useState(new Set(["pre-trip","safety","operational"])),o=r.inspectionItems||D,c=u.useMemo(()=>o.some(g=>g.isSafetyItem&&g.status==="fail")?"hold":"release",[o]),l=(m,g)=>{const b=o.map(w=>w.itemNumber===m?{...w,status:g}:w);t("inspectionItems",b),t("releaseStatus",c)},h=m=>{const g=new Set(i);g.has(m)?g.delete(m):g.add(m),d(g)},x=m=>{const g=o.find(b=>b.itemNumber===m.itemNumber)||m;return e.jsx("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-start gap-3",children:[m.isSafetyItem&&e.jsx(H,{className:"w-5 h-5 text-amber-500 flex-shrink-0 mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"flex items-start justify-between mb-2",children:e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold text-gray-900 dark:text-white",children:[m.itemNumber,". ",m.description]}),m.reference&&e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:m.reference})]})}),e.jsxs("div",{className:"flex gap-2 mt-3",children:[e.jsx(j,{onTap:()=>l(m.itemNumber,"pass"),hapticType:"light",children:e.jsxs("button",{type:"button",onClick:()=>l(m.itemNumber,"pass"),className:`
                    flex-1 flex items-center justify-center gap-2 py-3 px-4 rounded-lg
                    font-semibold transition-all border-2
                    ${g.status==="pass"?"bg-green-500 text-white border-green-600 shadow-lg":"bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 border-gray-300 dark:border-gray-600"}
                  `,style:{minHeight:"48px"},children:[e.jsx(A,{className:"w-4 h-4"}),"Pass"]})}),e.jsx(j,{onTap:()=>l(m.itemNumber,"fail"),hapticType:"medium",children:e.jsxs("button",{type:"button",onClick:()=>l(m.itemNumber,"fail"),className:`
                    flex-1 flex items-center justify-center gap-2 py-3 px-4 rounded-lg
                    font-semibold transition-all border-2
                    ${g.status==="fail"?"bg-red-500 text-white border-red-600 shadow-lg":"bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 border-gray-300 dark:border-gray-600"}
                  `,style:{minHeight:"48px"},children:[e.jsx(pe,{className:"w-4 h-4"}),"Fail"]})}),e.jsx(j,{onTap:()=>l(m.itemNumber,"n/a"),hapticType:"light",children:e.jsx("button",{type:"button",onClick:()=>l(m.itemNumber,"n/a"),className:`
                    flex-1 flex items-center justify-center gap-2 py-3 px-4 rounded-lg
                    font-semibold transition-all border-2
                    ${g.status==="n/a"?"bg-gray-400 text-white border-gray-500 shadow-lg":"bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 border-gray-300 dark:border-gray-600"}
                  `,style:{minHeight:"48px"},children:"N/A"})})]})]})]})},m.itemNumber)},p=(m,g,b,w)=>{const S=i.has(g);return e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 rounded-xl overflow-hidden",children:[e.jsxs("button",{type:"button",onClick:()=>h(g),className:"w-full p-4 flex items-center justify-between hover:bg-gray-100 dark:hover:bg-gray-700/50 transition-colors",children:[e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:m}),w&&e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:w})]}),e.jsx(xe,{className:`w-6 h-6 text-gray-600 dark:text-gray-400 transition-transform ${S?"rotate-180":""}`})]}),e.jsx(I,{children:S&&e.jsx(v.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3},className:"overflow-hidden",children:e.jsx("div",{className:"p-4 space-y-3",children:b.map(x)})})})]})};return e.jsxs(v.div,{className:"space-y-6 p-4 md:p-6",initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Vehicle Inspection"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Inspect all items and mark Pass, Fail, or N/A"})]}),e.jsx(v.div,{className:`
          p-4 rounded-xl border-2 flex items-center justify-between
          ${c==="hold"?"bg-red-50 border-red-500 dark:bg-red-900/20 dark:border-red-700":"bg-green-50 border-green-500 dark:bg-green-900/20 dark:border-green-700"}
        `,layout:!0,children:e.jsxs("div",{className:"flex items-center gap-3",children:[c==="hold"?e.jsx(H,{className:"w-6 h-6 text-red-600 dark:text-red-400"}):e.jsx(A,{className:"w-6 h-6 text-green-600 dark:text-green-400"}),e.jsxs("div",{children:[e.jsx("p",{className:`font-bold text-lg ${c==="hold"?"text-red-900 dark:text-red-100":"text-green-900 dark:text-green-100"}`,children:c==="hold"?"ðŸ”´ HOLD FOR REPAIRS":"ðŸŸ¢ RELEASED"}),c==="hold"&&e.jsx("p",{className:"text-sm text-red-700 dark:text-red-300",children:"Safety Item â€“ Do Not Release Until Repaired"})]})]})}),e.jsxs("div",{className:"space-y-4",children:[p("Pre-Trip Items","pre-trip",D.slice(0,5),"Items 1-5"),p("Safety Equipment","safety",D.slice(5,13),"âš ï¸ Items 6-13 - All Safety-Critical"),p("Operational Systems","operational",D.slice(13),"Items 14-17")]}),e.jsxs("div",{className:"flex gap-3 sticky bottom-4 bg-white dark:bg-gray-900 p-4 rounded-xl shadow-lg",children:[e.jsx(j,{onTap:()=>n(),hapticType:"light",children:e.jsx("button",{type:"button",onClick:n,className:`
              flex-1 bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold
              py-4 px-6 rounded-xl transition-all
              focus:outline-none focus:ring-4 focus:ring-gray-300
            `,style:{minHeight:"56px"},children:"Back"})}),e.jsx(j,{onTap:()=>s(),hapticType:"medium",children:e.jsx("button",{type:"button",onClick:s,className:`
              flex-[2] bg-blue-600 hover:bg-blue-700 text-white font-bold
              py-4 px-6 rounded-xl transition-all shadow-lg hover:shadow-xl
              focus:outline-none focus:ring-4 focus:ring-blue-300
            `,style:{minHeight:"56px"},children:"Next: Comments"})})]})]})},Ze=({formData:r,onChange:t,onNext:s,onBack:n})=>{const a=u.useRef(null),i=2e3,d=(r.additionalComments||"").length;return u.useEffect(()=>{a.current&&(a.current.style.height="auto",a.current.style.height=`${a.current.scrollHeight}px`)},[r.additionalComments]),e.jsxs(v.div,{className:"space-y-6 p-4 md:p-6",initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Additional Comments"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Add any notes, repair recommendations, or additional findings (optional)"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"additionalComments",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:["Comments ",e.jsx("span",{className:"text-gray-500",children:"(Optional)"})]}),e.jsx("textarea",{ref:a,id:"additionalComments",value:r.additionalComments||"",onChange:o=>t("additionalComments",o.target.value),placeholder:"Enter any additional comments, notes, or repair recommendations...",maxLength:i,rows:10,className:`
            w-full px-4 py-3 text-base rounded-xl border-2 border-gray-300
            transition-all focus:outline-none focus:ring-4
            focus:border-blue-500 focus:ring-blue-100 resize-none
            dark:bg-gray-800 dark:border-gray-600 dark:text-white
          `,style:{minHeight:"200px"}}),e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Detailed notes help with repairs and maintenance tracking"}),e.jsxs("p",{className:`text-sm font-medium ${d>i*.9?"text-red-600":"text-gray-600"}`,children:[d," / ",i]})]})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 rounded-xl p-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3",children:"Quick Suggestions"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:["No issues found","Minor wear observed","Requires immediate attention","Scheduled maintenance due","Pre-incident condition noted"].map(o=>e.jsxs("button",{type:"button",onClick:()=>{const c=r.additionalComments||"";t("additionalComments",`${c}${c?`
`:""}${o}`)},className:`
                px-3 py-2 text-sm rounded-lg bg-white dark:bg-gray-700
                border border-gray-300 dark:border-gray-600
                hover:bg-blue-50 hover:border-blue-300 dark:hover:bg-gray-600
                transition-colors text-gray-700 dark:text-gray-300
              `,children:["+ ",o]},o))})]}),e.jsxs("div",{className:"flex gap-3 sticky bottom-4 bg-white dark:bg-gray-900 p-4 rounded-xl shadow-lg",children:[e.jsx(j,{onTap:()=>n(),hapticType:"light",children:e.jsx("button",{type:"button",onClick:n,className:`
              flex-1 bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold
              py-4 px-6 rounded-xl transition-all
              focus:outline-none focus:ring-4 focus:ring-gray-300
            `,style:{minHeight:"56px"},children:"Back"})}),e.jsx(j,{onTap:()=>s(),hapticType:"medium",children:e.jsx("button",{type:"button",onClick:s,className:`
              flex-[2] bg-blue-600 hover:bg-blue-700 text-white font-bold
              py-4 px-6 rounded-xl transition-all shadow-lg hover:shadow-xl
              focus:outline-none focus:ring-4 focus:ring-blue-300
            `,style:{minHeight:"56px"},children:"Next: Inspector Signature"})})]})]})};var R=class{x;y;pressure;time;constructor(r,t,s,n){if(isNaN(r)||isNaN(t))throw new Error(`Point is invalid: (${r}, ${t})`);this.x=+r,this.y=+t,this.pressure=s||0,this.time=n||Date.now()}distanceTo(r){return Math.sqrt(Math.pow(this.x-r.x,2)+Math.pow(this.y-r.y,2))}equals(r){return this.x===r.x&&this.y===r.y&&this.pressure===r.pressure&&this.time===r.time}velocityFrom(r){return this.time!==r.time?this.distanceTo(r)/(this.time-r.time):0}},Qe=class K{constructor(t,s,n,a,i,d){this.startPoint=t,this.control2=s,this.control1=n,this.endPoint=a,this.startWidth=i,this.endWidth=d}static fromPoints(t,s){const n=this.calculateControlPoints(t[0],t[1],t[2]).c2,a=this.calculateControlPoints(t[1],t[2],t[3]).c1;return new K(t[1],n,a,t[2],s.start,s.end)}static calculateControlPoints(t,s,n){const a=t.x-s.x,i=t.y-s.y,d=s.x-n.x,o=s.y-n.y,c={x:(t.x+s.x)/2,y:(t.y+s.y)/2},l={x:(s.x+n.x)/2,y:(s.y+n.y)/2},h=Math.sqrt(a*a+i*i),x=Math.sqrt(d*d+o*o),p=c.x-l.x,m=c.y-l.y,g=h+x==0?0:x/(h+x),b={x:l.x+p*g,y:l.y+m*g},w=s.x-b.x,S=s.y-b.y;return{c1:new R(c.x+w,c.y+S),c2:new R(l.x+w,l.y+S)}}length(){let s=0,n,a;for(let i=0;i<=10;i+=1){const d=i/10,o=this.point(d,this.startPoint.x,this.control1.x,this.control2.x,this.endPoint.x),c=this.point(d,this.startPoint.y,this.control1.y,this.control2.y,this.endPoint.y);if(i>0){const l=o-n,h=c-a;s+=Math.sqrt(l*l+h*h)}n=o,a=c}return s}point(t,s,n,a,i){return s*(1-t)*(1-t)*(1-t)+3*n*(1-t)*(1-t)*t+3*a*(1-t)*t*t+i*t*t*t}},Ke=class{_et;constructor(){try{this._et=new EventTarget}catch{this._et=document}}addEventListener(r,t,s){this._et.addEventListener(r,t,s)}dispatchEvent(r){return this._et.dispatchEvent(r)}removeEventListener(r,t,s){this._et.removeEventListener(r,t,s)}};function et(r,t=250){let s=0,n=null,a,i,d;const o=()=>{s=Date.now(),n=null,a=r.apply(i,d),n||(i=null,d=[])};return function(...l){const h=Date.now(),x=t-(h-s);return i=this,d=l,x<=0||x>t?(n&&(clearTimeout(n),n=null),s=h,a=r.apply(i,d),n||(i=null,d=[])):n||(n=window.setTimeout(o,x)),a}}var tt=class F extends Ke{constructor(t,s={}){super(),this.canvas=t,this.velocityFilterWeight=s.velocityFilterWeight||.7,this.minWidth=s.minWidth||.5,this.maxWidth=s.maxWidth||2.5,this.throttle=s.throttle??16,this.minDistance=s.minDistance??5,this.dotSize=s.dotSize||0,this.penColor=s.penColor||"black",this.backgroundColor=s.backgroundColor||"rgba(0,0,0,0)",this.compositeOperation=s.compositeOperation||"source-over",this.canvasContextOptions=s.canvasContextOptions??{},this._strokeMoveUpdate=this.throttle?et(F.prototype._strokeUpdate,this.throttle):F.prototype._strokeUpdate,this._handleMouseDown=this._handleMouseDown.bind(this),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this._handleTouchStart=this._handleTouchStart.bind(this),this._handleTouchMove=this._handleTouchMove.bind(this),this._handleTouchEnd=this._handleTouchEnd.bind(this),this._handlePointerDown=this._handlePointerDown.bind(this),this._handlePointerMove=this._handlePointerMove.bind(this),this._handlePointerUp=this._handlePointerUp.bind(this),this._handlePointerCancel=this._handlePointerCancel.bind(this),this._handleTouchCancel=this._handleTouchCancel.bind(this),this._ctx=t.getContext("2d",this.canvasContextOptions),this.clear(),this.on()}dotSize;minWidth;maxWidth;penColor;minDistance;velocityFilterWeight;compositeOperation;backgroundColor;throttle;canvasContextOptions;_ctx;_drawingStroke=!1;_isEmpty=!0;_dataUrl;_dataUrlOptions;_lastPoints=[];_data=[];_lastVelocity=0;_lastWidth=0;_strokeMoveUpdate;_strokePointerId;clear(){const{_ctx:t,canvas:s}=this;t.fillStyle=this.backgroundColor,t.clearRect(0,0,s.width,s.height),t.fillRect(0,0,s.width,s.height),this._data=[],this._reset(this._getPointGroupOptions()),this._isEmpty=!0,this._dataUrl=void 0,this._dataUrlOptions=void 0,this._strokePointerId=void 0}redraw(){const t=this._data,s=this._dataUrl,n=this._dataUrlOptions;this.clear(),s&&this.fromDataURL(s,n),this.fromData(t,{clear:!1})}fromDataURL(t,s={}){return new Promise((n,a)=>{const i=new Image,d=s.ratio||window.devicePixelRatio||1,o=s.width||this.canvas.width/d,c=s.height||this.canvas.height/d,l=s.xOffset||0,h=s.yOffset||0;this._reset(this._getPointGroupOptions()),i.onload=()=>{this._ctx.drawImage(i,l,h,o,c),n()},i.onerror=x=>{a(x)},i.crossOrigin="anonymous",i.src=t,this._isEmpty=!1,this._dataUrl=t,this._dataUrlOptions={...s}})}toDataURL(t="image/png",s){switch(t){case"image/svg+xml":return typeof s!="object"&&(s=void 0),`data:image/svg+xml;base64,${btoa(this.toSVG(s))}`;default:return typeof s!="number"&&(s=void 0),this.canvas.toDataURL(t,s)}}on(){this.canvas.style.touchAction="none",this.canvas.style.msTouchAction="none",this.canvas.style.userSelect="none",this.canvas.style.webkitUserSelect="none";const t=/Macintosh/.test(navigator.userAgent)&&"ontouchstart"in document;window.PointerEvent&&!t?this._handlePointerEvents():(this._handleMouseEvents(),"ontouchstart"in window&&this._handleTouchEvents())}off(){this.canvas.style.touchAction="auto",this.canvas.style.msTouchAction="auto",this.canvas.style.userSelect="auto",this.canvas.style.webkitUserSelect="auto",this.canvas.removeEventListener("pointerdown",this._handlePointerDown),this.canvas.removeEventListener("mousedown",this._handleMouseDown),this.canvas.removeEventListener("touchstart",this._handleTouchStart),this._removeMoveUpEventListeners()}_getListenerFunctions(){const t=window.document===this.canvas.ownerDocument?window:this.canvas.ownerDocument.defaultView??this.canvas.ownerDocument;return{addEventListener:t.addEventListener.bind(t),removeEventListener:t.removeEventListener.bind(t)}}_removeMoveUpEventListeners(){const{removeEventListener:t}=this._getListenerFunctions();t("pointermove",this._handlePointerMove),t("pointerup",this._handlePointerUp),t("pointercancel",this._handlePointerCancel),t("mousemove",this._handleMouseMove),t("mouseup",this._handleMouseUp),t("touchmove",this._handleTouchMove),t("touchend",this._handleTouchEnd),t("touchcancel",this._handleTouchCancel)}isEmpty(){return this._isEmpty}fromData(t,{clear:s=!0}={}){s&&this.clear(),this._fromData(t,this._drawCurve.bind(this),this._drawDot.bind(this)),this._data=this._data.concat(t)}toData(){return this._data}_isLeftButtonPressed(t,s){return s?t.buttons===1:(t.buttons&1)===1}_pointerEventToSignatureEvent(t){return{event:t,type:t.type,x:t.clientX,y:t.clientY,pressure:"pressure"in t?t.pressure:0}}_touchEventToSignatureEvent(t){const s=t.changedTouches[0];return{event:t,type:t.type,x:s.clientX,y:s.clientY,pressure:s.force}}_handleMouseDown(t){!this._isLeftButtonPressed(t,!0)||this._drawingStroke||this._strokeBegin(this._pointerEventToSignatureEvent(t))}_handleMouseMove(t){if(!this._isLeftButtonPressed(t,!0)||!this._drawingStroke){this._strokeEnd(this._pointerEventToSignatureEvent(t),!1);return}this._strokeMoveUpdate(this._pointerEventToSignatureEvent(t))}_handleMouseUp(t){this._isLeftButtonPressed(t)||this._strokeEnd(this._pointerEventToSignatureEvent(t))}_handleTouchStart(t){t.targetTouches.length!==1||this._drawingStroke||(t.cancelable&&t.preventDefault(),this._strokeBegin(this._touchEventToSignatureEvent(t)))}_handleTouchMove(t){if(t.targetTouches.length===1){if(t.cancelable&&t.preventDefault(),!this._drawingStroke){this._strokeEnd(this._touchEventToSignatureEvent(t),!1);return}this._strokeMoveUpdate(this._touchEventToSignatureEvent(t))}}_handleTouchEnd(t){t.targetTouches.length===0&&(t.cancelable&&t.preventDefault(),this._strokeEnd(this._touchEventToSignatureEvent(t)))}_handlePointerCancel(t){this._allowPointerId(t)&&(t.preventDefault(),this._strokeEnd(this._pointerEventToSignatureEvent(t),!1))}_handleTouchCancel(t){t.cancelable&&t.preventDefault(),this._strokeEnd(this._touchEventToSignatureEvent(t),!1)}_getPointerId(t){return t.persistentDeviceId||t.pointerId}_allowPointerId(t,s=!1){return typeof this._strokePointerId>"u"?s:this._getPointerId(t)===this._strokePointerId}_handlePointerDown(t){this._drawingStroke||!this._isLeftButtonPressed(t)||!this._allowPointerId(t,!0)||(this._strokePointerId=this._getPointerId(t),t.preventDefault(),this._strokeBegin(this._pointerEventToSignatureEvent(t)))}_handlePointerMove(t){if(this._allowPointerId(t)){if(!this._isLeftButtonPressed(t,!0)||!this._drawingStroke){this._strokeEnd(this._pointerEventToSignatureEvent(t),!1);return}t.preventDefault(),this._strokeMoveUpdate(this._pointerEventToSignatureEvent(t))}}_handlePointerUp(t){this._isLeftButtonPressed(t)||!this._allowPointerId(t)||(t.preventDefault(),this._strokeEnd(this._pointerEventToSignatureEvent(t)))}_getPointGroupOptions(t){return{penColor:t&&"penColor"in t?t.penColor:this.penColor,dotSize:t&&"dotSize"in t?t.dotSize:this.dotSize,minWidth:t&&"minWidth"in t?t.minWidth:this.minWidth,maxWidth:t&&"maxWidth"in t?t.maxWidth:this.maxWidth,velocityFilterWeight:t&&"velocityFilterWeight"in t?t.velocityFilterWeight:this.velocityFilterWeight,compositeOperation:t&&"compositeOperation"in t?t.compositeOperation:this.compositeOperation}}_strokeBegin(t){if(!this.dispatchEvent(new CustomEvent("beginStroke",{detail:t,cancelable:!0})))return;const{addEventListener:n}=this._getListenerFunctions();switch(t.event.type){case"mousedown":n("mousemove",this._handleMouseMove,{passive:!1}),n("mouseup",this._handleMouseUp,{passive:!1});break;case"touchstart":n("touchmove",this._handleTouchMove,{passive:!1}),n("touchend",this._handleTouchEnd,{passive:!1}),n("touchcancel",this._handleTouchCancel,{passive:!1});break;case"pointerdown":n("pointermove",this._handlePointerMove,{passive:!1}),n("pointerup",this._handlePointerUp,{passive:!1}),n("pointercancel",this._handlePointerCancel,{passive:!1});break}this._drawingStroke=!0;const a=this._getPointGroupOptions(),i={...a,points:[]};this._data.push(i),this._reset(a),this._strokeUpdate(t)}_strokeUpdate(t){if(!this._drawingStroke)return;if(this._data.length===0){this._strokeBegin(t);return}this.dispatchEvent(new CustomEvent("beforeUpdateStroke",{detail:t}));const s=this._createPoint(t.x,t.y,t.pressure),n=this._data[this._data.length-1],a=n.points,i=a.length>0&&a[a.length-1],d=i?s.distanceTo(i)<=this.minDistance:!1,o=this._getPointGroupOptions(n);if(!i||!(i&&d)){const c=this._addPoint(s,o);i?c&&this._drawCurve(c,o):this._drawDot(s,o),a.push({time:s.time,x:s.x,y:s.y,pressure:s.pressure})}this.dispatchEvent(new CustomEvent("afterUpdateStroke",{detail:t}))}_strokeEnd(t,s=!0){this._removeMoveUpEventListeners(),this._drawingStroke&&(s&&this._strokeUpdate(t),this._drawingStroke=!1,this._strokePointerId=void 0,this.dispatchEvent(new CustomEvent("endStroke",{detail:t})))}_handlePointerEvents(){this._drawingStroke=!1,this.canvas.addEventListener("pointerdown",this._handlePointerDown,{passive:!1})}_handleMouseEvents(){this._drawingStroke=!1,this.canvas.addEventListener("mousedown",this._handleMouseDown,{passive:!1})}_handleTouchEvents(){this.canvas.addEventListener("touchstart",this._handleTouchStart,{passive:!1})}_reset(t){this._lastPoints=[],this._lastVelocity=0,this._lastWidth=(t.minWidth+t.maxWidth)/2,this._ctx.fillStyle=t.penColor,this._ctx.globalCompositeOperation=t.compositeOperation}_createPoint(t,s,n){const a=this.canvas.getBoundingClientRect();return new R(t-a.left,s-a.top,n,new Date().getTime())}_addPoint(t,s){const{_lastPoints:n}=this;if(n.push(t),n.length>2){n.length===3&&n.unshift(n[0]);const a=this._calculateCurveWidths(n[1],n[2],s),i=Qe.fromPoints(n,a);return n.shift(),i}return null}_calculateCurveWidths(t,s,n){const a=n.velocityFilterWeight*s.velocityFrom(t)+(1-n.velocityFilterWeight)*this._lastVelocity,i=this._strokeWidth(a,n),d={end:i,start:this._lastWidth};return this._lastVelocity=a,this._lastWidth=i,d}_strokeWidth(t,s){return Math.max(s.maxWidth/(t+1),s.minWidth)}_drawCurveSegment(t,s,n){const a=this._ctx;a.moveTo(t,s),a.arc(t,s,n,0,2*Math.PI,!1),this._isEmpty=!1}_drawCurve(t,s){const n=this._ctx,a=t.endWidth-t.startWidth,i=Math.ceil(t.length())*2;n.beginPath(),n.fillStyle=s.penColor;for(let d=0;d<i;d+=1){const o=d/i,c=o*o,l=c*o,h=1-o,x=h*h,p=x*h;let m=p*t.startPoint.x;m+=3*x*o*t.control1.x,m+=3*h*c*t.control2.x,m+=l*t.endPoint.x;let g=p*t.startPoint.y;g+=3*x*o*t.control1.y,g+=3*h*c*t.control2.y,g+=l*t.endPoint.y;const b=Math.min(t.startWidth+l*a,s.maxWidth);this._drawCurveSegment(m,g,b)}n.closePath(),n.fill()}_drawDot(t,s){const n=this._ctx,a=s.dotSize>0?s.dotSize:(s.minWidth+s.maxWidth)/2;n.beginPath(),this._drawCurveSegment(t.x,t.y,a),n.closePath(),n.fillStyle=s.penColor,n.fill()}_fromData(t,s,n){for(const a of t){const{points:i}=a,d=this._getPointGroupOptions(a);if(i.length>1)for(let o=0;o<i.length;o+=1){const c=i[o],l=new R(c.x,c.y,c.pressure,c.time);o===0&&this._reset(d);const h=this._addPoint(l,d);h&&s(h,d)}else this._reset(d),n(i[0],d)}}toSVG({includeBackgroundColor:t=!1,includeDataUrl:s=!1}={}){const n=this._data,a=Math.max(window.devicePixelRatio||1,1),i=0,d=0,o=this.canvas.width/a,c=this.canvas.height/a,l=document.createElementNS("http://www.w3.org/2000/svg","svg");if(l.setAttribute("xmlns","http://www.w3.org/2000/svg"),l.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),l.setAttribute("viewBox",`${i} ${d} ${o} ${c}`),l.setAttribute("width",o.toString()),l.setAttribute("height",c.toString()),t&&this.backgroundColor){const h=document.createElement("rect");h.setAttribute("width","100%"),h.setAttribute("height","100%"),h.setAttribute("fill",this.backgroundColor),l.appendChild(h)}if(s&&this._dataUrl){const h=this._dataUrlOptions?.ratio||window.devicePixelRatio||1,x=this._dataUrlOptions?.width||this.canvas.width/h,p=this._dataUrlOptions?.height||this.canvas.height/h,m=this._dataUrlOptions?.xOffset||0,g=this._dataUrlOptions?.yOffset||0,b=document.createElement("image");b.setAttribute("x",m.toString()),b.setAttribute("y",g.toString()),b.setAttribute("width",x.toString()),b.setAttribute("height",p.toString()),b.setAttribute("preserveAspectRatio","none"),b.setAttribute("href",this._dataUrl),l.appendChild(b)}return this._fromData(n,(h,{penColor:x})=>{const p=document.createElement("path");if(!isNaN(h.control1.x)&&!isNaN(h.control1.y)&&!isNaN(h.control2.x)&&!isNaN(h.control2.y)){const m=`M ${h.startPoint.x.toFixed(3)},${h.startPoint.y.toFixed(3)} C ${h.control1.x.toFixed(3)},${h.control1.y.toFixed(3)} ${h.control2.x.toFixed(3)},${h.control2.y.toFixed(3)} ${h.endPoint.x.toFixed(3)},${h.endPoint.y.toFixed(3)}`;p.setAttribute("d",m),p.setAttribute("stroke-width",(h.endWidth*2.25).toFixed(3)),p.setAttribute("stroke",x),p.setAttribute("fill","none"),p.setAttribute("stroke-linecap","round"),l.appendChild(p)}},(h,{penColor:x,dotSize:p,minWidth:m,maxWidth:g})=>{const b=document.createElement("circle"),w=p>0?p:(m+g)/2;b.setAttribute("r",w.toString()),b.setAttribute("cx",h.x.toString()),b.setAttribute("cy",h.y.toString()),b.setAttribute("fill",x),l.appendChild(b)}),l.outerHTML}};const ee=({onSave:r,initialSignature:t,disabled:s=!1,label:n="Signature",className:a=""})=>{const i=u.useRef(null),d=u.useRef(null),[o,c]=u.useState(!0);u.useEffect(()=>{if(!i.current)return;const x=i.current,p=new tt(x,{backgroundColor:"rgb(255, 255, 255)",penColor:"rgb(0, 0, 0)",minWidth:.5,maxWidth:2.5});d.current=p;const m=()=>{const g=Math.max(window.devicePixelRatio||1,1);x.width=x.offsetWidth*g,x.height=x.offsetHeight*g,x.getContext("2d")?.scale(g,g),p.clear(),t&&!p.isEmpty()&&p.fromDataURL(t)};return m(),window.addEventListener("resize",m),p.addEventListener("endStroke",()=>{c(p.isEmpty())}),t&&(p.fromDataURL(t),c(!1)),s&&p.off(),()=>{window.removeEventListener("resize",m),p.off()}},[t,s]);const l=()=>{d.current&&(d.current.clear(),c(!0))},h=()=>{if(d.current&&!d.current.isEmpty()){const x=d.current.toDataURL("image/png");r(x)}};return e.jsxs(v.div,{className:`bg-white dark:bg-gray-800 rounded-xl p-4 ${a}`,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:[n," ",s&&e.jsx("span",{className:"text-gray-500",children:"(Locked)"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("canvas",{ref:i,className:`
            w-full border-2 rounded-lg touch-none
            ${s?"border-gray-300 bg-gray-100 cursor-not-allowed":"border-blue-400 bg-white"}
          `,style:{height:"150px",maxHeight:"200px"}}),o&&!s&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:e.jsx("p",{className:"text-gray-400 text-sm",children:"Sign here"})})]}),!s&&e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsx(j,{onTap:l,hapticType:"light",children:e.jsx("button",{type:"button",onClick:l,disabled:o,className:`
                flex-1 px-4 py-3 rounded-xl font-semibold transition-all
                ${o?"bg-gray-200 text-gray-400 cursor-not-allowed":"bg-gray-300 hover:bg-gray-400 text-gray-800"}
              `,style:{minHeight:"48px"},children:"Clear"})}),e.jsx(j,{onTap:h,hapticType:"medium",children:e.jsx("button",{type:"button",onClick:h,disabled:o,className:`
                flex-1 px-4 py-3 rounded-xl font-semibold transition-all
                ${o?"bg-blue-200 text-blue-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 text-white"}
              `,style:{minHeight:"48px"},children:"Save Signature"})})]})]})},st=({formData:r,onChange:t,onNext:s,onBack:n,errors:a})=>{const[i,d]=u.useState(!!r.inspectorSignature),o=x=>{const p={imageData:x,signedAt:new Date().toISOString(),signedBy:r.inspectorNamePrint||"",ipAddress:void 0,deviceId:navigator.userAgent};t("inspectorSignature",p),d(!0),t("status","inspector_signed")},c=()=>{const x=new Date;return{date:x.toISOString().split("T")[0],time:x.toTimeString().slice(0,5)}},{date:l,time:h}=c();return e.jsxs(v.div,{className:"space-y-6 p-4 md:p-6",initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Inspector Signature"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Sign to lock the inspection form and proceed to review"})]}),i&&e.jsx(v.div,{className:"bg-amber-50 dark:bg-amber-900/20 border-2 border-amber-500 rounded-xl p-4",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ve,{className:"w-6 h-6 text-amber-600 dark:text-amber-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-amber-900 dark:text-amber-100",children:"Form Locked"}),e.jsx("p",{className:"text-sm text-amber-700 dark:text-amber-300",children:"Inspector signature has been recorded. Form is read-only."})]})]})}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"inspectorNamePrint",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Inspector Name (Print) *"}),e.jsx("input",{type:"text",id:"inspectorNamePrint",value:r.inspectorNamePrint||"",onChange:x=>t("inspectorNamePrint",x.target.value),placeholder:"Enter your full name",maxLength:100,disabled:i,className:`
            w-full px-4 py-3 text-base rounded-xl border-2 transition-all
            focus:outline-none focus:ring-4
            ${i?"bg-gray-100 dark:bg-gray-800 border-gray-300 cursor-not-allowed":a.inspectorNamePrint?"border-red-500 focus:border-red-500 focus:ring-red-100":"border-gray-300 focus:border-blue-500 focus:ring-blue-100"}
          `,style:{minHeight:"56px"}}),a.inspectorNamePrint&&!i&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.inspectorNamePrint})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 rounded-xl p-4",children:[e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mb-1",children:"Date"}),e.jsx("p",{className:"text-lg font-bold text-gray-900 dark:text-white",children:new Date(r.inspectorDate||l).toLocaleDateString()})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 rounded-xl p-4",children:[e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mb-1",children:"Time"}),e.jsx("p",{className:"text-lg font-bold text-gray-900 dark:text-white",children:r.inspectorTime||h})]})]}),e.jsx("div",{children:e.jsx(ee,{onSave:o,initialSignature:r.inspectorSignature?.imageData,disabled:i,label:"Inspector Signature"})}),i&&r.inspectorSignature&&e.jsx(v.div,{className:"bg-green-50 dark:bg-green-900/20 border-2 border-green-500 rounded-xl p-4",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(A,{className:"w-6 h-6 text-green-600 dark:text-green-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-green-900 dark:text-green-100",children:"Signature Recorded"}),e.jsxs("p",{className:"text-sm text-green-700 dark:text-green-300",children:["Signed by ",r.inspectorNamePrint," on"," ",new Date(r.inspectorSignature.signedAt).toLocaleString()]})]})]})}),e.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-3",children:e.jsxs("p",{className:"text-xs text-blue-900 dark:text-blue-100",children:[e.jsx("strong",{children:"Notice:"})," By signing this form, you certify that the inspection was conducted in accordance with ICS-212 standards and that all information is accurate to the best of your knowledge."]})}),e.jsxs("div",{className:"flex gap-3 sticky bottom-4 bg-white dark:bg-gray-900 p-4 rounded-xl shadow-lg",children:[!i&&e.jsx(j,{onTap:()=>n(),hapticType:"light",children:e.jsx("button",{type:"button",onClick:n,className:`
                flex-1 bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold
                py-4 px-6 rounded-xl transition-all
                focus:outline-none focus:ring-4 focus:ring-gray-300
              `,style:{minHeight:"56px"},children:"Back"})}),e.jsx(j,{onTap:()=>s(),hapticType:"medium",children:e.jsx("button",{type:"button",onClick:s,disabled:!i,className:`
              ${i?"flex-1":"flex-[2]"}
              font-bold py-4 px-6 rounded-xl transition-all shadow-lg
              focus:outline-none focus:ring-4
              ${i?"bg-blue-600 hover:bg-blue-700 text-white focus:ring-blue-300 hover:shadow-xl":"bg-gray-300 text-gray-500 cursor-not-allowed"}
            `,style:{minHeight:"56px"},children:i?"Next: Review & Submit":"Sign Form to Continue"})})]})]})},rt=({formData:r,onChange:t,onBack:s,onGoToStep:n,onSubmit:a})=>{const[i,d]=u.useState(!1),[o,c]=u.useState(!!r.operatorSignature),l=b=>{const w={imageData:b,signedAt:new Date().toISOString(),signedBy:r.operatorNamePrint||"",ipAddress:void 0,deviceId:navigator.userAgent};t("operatorSignature",w),t("operatorDate",new Date().toISOString().split("T")[0]),t("operatorTime",new Date().toTimeString().slice(0,5)),c(!0)},h=async()=>{if(!o){k.error("Operator signature required");return}d(!0);try{await a(),k.success("Form submitted successfully!")}catch(b){k.error("Submission failed. Please try again."),console.error("Submission error:",b)}finally{d(!1)}},x=r.inspectionItems?.filter(b=>b.status==="pass").length||0,p=r.inspectionItems?.filter(b=>b.status==="fail").length||0,m=r.inspectionItems?.filter(b=>b.status==="n/a").length||0,g=r.releaseStatus||"release";return e.jsxs(v.div,{className:"space-y-6 p-4 md:p-6 pb-24",initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Review & Submit"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Review all information before final submission"})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border-2 border-gray-200 dark:border-gray-700 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Incident Information"}),e.jsxs("button",{type:"button",onClick:()=>n(0),className:"text-blue-600 hover:text-blue-700 flex items-center gap-1 text-sm",children:[e.jsx(T,{className:"w-4 h-4"})," Edit"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Incident Name"}),e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:r.incidentName||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Date/Time"}),e.jsxs("p",{className:"font-semibold text-gray-900 dark:text-white",children:[r.inspectorDate," ",r.inspectorTime]})]}),r.orderNo&&e.jsxs("div",{className:"col-span-2",children:[e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Order Number"}),e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:r.orderNo})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border-2 border-gray-200 dark:border-gray-700 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Vehicle Information"}),e.jsxs("button",{type:"button",onClick:()=>n(1),className:"text-blue-600 hover:text-blue-700 flex items-center gap-1 text-sm",children:[e.jsx(T,{className:"w-4 h-4"})," Edit"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Vehicle ID"}),e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:r.vehicleIdNo||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Odometer"}),e.jsxs("p",{className:"font-semibold text-gray-900 dark:text-white",children:[r.odometerReading?.toLocaleString()||"N/A"," mi"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"License Plate"}),e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:r.vehicleLicenseNo||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Type"}),e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:r.vehicleType||"N/A"})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border-2 border-gray-200 dark:border-gray-700 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Inspection Results"}),e.jsxs("button",{type:"button",onClick:()=>n(2),className:"text-blue-600 hover:text-blue-700 flex items-center gap-1 text-sm",children:[e.jsx(T,{className:"w-4 h-4"})," Edit"]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-4",children:[e.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-lg p-3 text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:x}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Passed"})]}),e.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 rounded-lg p-3 text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-red-600 dark:text-red-400",children:p}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Failed"})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-3 text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-gray-600 dark:text-gray-400",children:m}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"N/A"})]})]}),e.jsx("div",{className:`
          p-4 rounded-lg text-center font-bold text-lg
          ${g==="hold"?"bg-red-100 text-red-900 dark:bg-red-900/30 dark:text-red-100":"bg-green-100 text-green-900 dark:bg-green-900/30 dark:text-green-100"}
        `,children:g==="hold"?"ðŸ”´ HOLD FOR REPAIRS":"ðŸŸ¢ RELEASED"})]}),r.additionalComments&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border-2 border-gray-200 dark:border-gray-700 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Additional Comments"}),e.jsxs("button",{type:"button",onClick:()=>n(3),className:"text-blue-600 hover:text-blue-700 flex items-center gap-1 text-sm",children:[e.jsx(T,{className:"w-4 h-4"})," Edit"]})]}),e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 whitespace-pre-wrap",children:r.additionalComments})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border-2 border-gray-200 dark:border-gray-700 p-4",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-3",children:"Inspector Signature"}),e.jsxs("div",{className:"flex items-center gap-4",children:[r.inspectorSignature?.imageData&&e.jsx("img",{src:r.inspectorSignature.imageData,alt:"Inspector signature",className:"h-20 border border-gray-300 rounded bg-white"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:r.inspectorNamePrint}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Signed: ",r.inspectorSignature&&new Date(r.inspectorSignature.signedAt).toLocaleString()]})]})]})]}),e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-xl border-2 border-blue-200 dark:border-blue-800 p-4",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-3",children:"Operator Signature Required"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"operatorNamePrint",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Operator Name (Print) *"}),e.jsx("input",{type:"text",id:"operatorNamePrint",value:r.operatorNamePrint||"",onChange:b=>t("operatorNamePrint",b.target.value),placeholder:"Enter operator full name",maxLength:100,disabled:o,className:`
                w-full px-4 py-3 text-base rounded-xl border-2 transition-all
                focus:outline-none focus:ring-4
                ${o?"bg-gray-100 dark:bg-gray-800 border-gray-300 cursor-not-allowed":"border-gray-300 focus:border-blue-500 focus:ring-blue-100"}
              `})]}),e.jsx(ee,{onSave:l,initialSignature:r.operatorSignature?.imageData,disabled:o,label:"Operator Signature"})]})]}),e.jsx("div",{className:"sticky bottom-4 bg-white dark:bg-gray-900 p-4 rounded-xl shadow-lg",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx(j,{onTap:()=>s(),hapticType:"light",children:e.jsx("button",{type:"button",onClick:s,disabled:i,className:`
                flex-1 bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold
                py-4 px-6 rounded-xl transition-all
                focus:outline-none focus:ring-4 focus:ring-gray-300
                disabled:opacity-50 disabled:cursor-not-allowed
              `,style:{minHeight:"56px"},children:"Back"})}),e.jsx(j,{onTap:h,hapticType:"heavy",children:e.jsx("button",{type:"button",onClick:h,disabled:!o||i,className:`
                flex-[2] font-bold py-4 px-6 rounded-xl transition-all
                focus:outline-none focus:ring-4 flex items-center justify-center gap-2
                ${o&&!i?"bg-green-600 hover:bg-green-700 text-white focus:ring-green-300 shadow-lg hover:shadow-xl":"bg-gray-300 text-gray-500 cursor-not-allowed"}
              `,style:{minHeight:"56px"},children:i?e.jsxs(e.Fragment,{children:[e.jsx(ye,{className:"w-5 h-5 animate-spin"}),"Submitting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(A,{className:"w-5 h-5"}),"Submit Final Form"]})})})]})})]})},E=[{id:0,title:"Incident Info",component:Ge},{id:1,title:"Vehicle",component:Xe},{id:2,title:"Inspection",component:Je},{id:3,title:"Comments",component:Ze},{id:4,title:"Inspector Sign",component:st},{id:5,title:"Review & Submit",component:rt}],M={status:"draft",incidentName:"",orderNo:"",vehicleIdNo:"",vehicleLicenseNo:"",agencyRegUnit:"",vehicleType:"",odometerReading:0,inspectionItems:[],additionalComments:"",releaseStatus:"release",inspectorDate:new Date().toISOString().split("T")[0],inspectorTime:new Date().toTimeString().slice(0,5),inspectorNamePrint:""},dt=()=>{const[r,t]=u.useState(0),[s,n]=u.useState(M),[a,i]=u.useState({}),[d,o]=u.useState(!1),[c,l]=u.useState(!1),[h,x]=u.useState(null);u.useEffect(()=>{const f=setInterval(()=>{if(s&&!d&&r>0){const N={formData:s,currentStep:r,savedAt:new Date().toISOString(),expiresAt:new Date(Date.now()+6048e5).toISOString()};localStorage.setItem("ics212-draft",JSON.stringify(N)),k.success("Draft auto-saved",{duration:1500,icon:"ðŸ’¾"})}},3e4);return()=>clearInterval(f)},[s,r,d]),u.useEffect(()=>{const f=localStorage.getItem("ics212-draft");if(f)try{const N=JSON.parse(f);new Date(N.expiresAt)>new Date?(x(N),l(!0)):localStorage.removeItem("ics212-draft")}catch(N){console.error("Failed to parse draft:",N),localStorage.removeItem("ics212-draft")}},[]);const p=()=>{h&&(n(h.formData),t(h.currentStep),l(!1),k.success("Draft restored!"))},m=()=>{localStorage.removeItem("ics212-draft"),l(!1),x(null),k("Draft discarded",{icon:"ðŸ—‘ï¸"})},g=(f,N)=>{n(_=>({..._,[f]:N})),a[f]&&i(_=>{const $={..._};return delete $[f],$})},b=f=>{const N={};switch(f){case 0:(!s.incidentName||s.incidentName.length<3)&&(N.incidentName="Incident name must be at least 3 characters"),s.inspectorDate||(N.inspectorDate="Date is required"),s.inspectorTime||(N.inspectorTime="Time is required");break;case 1:s.vehicleIdNo||(N.vehicleIdNo="Vehicle ID is required"),(!s.odometerReading||s.odometerReading===0)&&(N.odometerReading="Odometer reading is required");break;case 4:(!s.inspectorNamePrint||(s.inspectorNamePrint||"").length<2)&&(N.inspectorNamePrint="Inspector name must be at least 2 characters"),s.inspectorSignature||(N.inspectorSignature="Signature is required");break}return i(N),Object.keys(N).length===0},w=()=>{b(r)?r<E.length-1&&t(r+1):k.error("Please complete all required fields")},S=()=>{r>0&&t(r-1)},y=f=>{f>=0&&f<E.length&&t(f)},C=()=>{const f={formData:s,currentStep:r,savedAt:new Date().toISOString(),expiresAt:new Date(Date.now()+6048e5).toISOString()};localStorage.setItem("ics212-draft",JSON.stringify(f)),k.success("Draft saved manually!",{icon:"ðŸ’¾"})},te=()=>{confirm("Are you sure you want to clear all form data? This cannot be undone.")&&(n(M),t(0),i({}),localStorage.removeItem("ics212-draft"),k("Form cleared",{icon:"ðŸ—‘ï¸"}))},se=async()=>{try{const f={...s,submittedAt:new Date().toISOString(),status:"submitted"},N=await fetch("/api/ics212/submit",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(f)});if(!N.ok)throw new Error("Submission failed");const _=await N.json();if(_.success)o(!0),localStorage.removeItem("ics212-draft"),k.success(`Form submitted! ID: ${_.formId}`),console.log("Submission result:",_);else throw new Error(_.error||"Submission failed")}catch(f){throw console.error("Submission error:",f),f}},re=E[r].component;return e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[e.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 sticky top-0 z-40 shadow-sm",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"ICS-212 Vehicle Safety Inspection"}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Step ",r+1," of ",E.length,": ",E[r].title]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",onClick:C,className:"p-2 rounded-lg bg-blue-100 text-blue-600 hover:bg-blue-200 transition-colors",title:"Save Draft",children:e.jsx(we,{className:"w-5 h-5"})}),e.jsx("button",{type:"button",onClick:te,className:"p-2 rounded-lg bg-red-100 text-red-600 hover:bg-red-200 transition-colors",title:"Clear Form",children:e.jsx(Se,{className:"w-5 h-5"})})]})]}),e.jsx(qe,{currentStep:r+1,totalSteps:E.length,labels:E.map(f=>f.title)})]})}),e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsx(I,{mode:"wait",children:e.jsx(v.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:e.jsx(re,{formData:s,onChange:g,onNext:w,onBack:S,onGoToStep:y,onSubmit:se,errors:a})},r)})}),e.jsx(I,{children:c&&e.jsx(v.div,{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:e.jsxs(v.div,{className:"bg-white dark:bg-gray-800 rounded-xl shadow-2xl max-w-md w-full p-6",initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:"Resume Draft?"}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:["We found a saved draft from"," ",h&&new Date(h.savedAt).toLocaleString(),". Would you like to resume where you left off?"]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"button",onClick:m,className:"flex-1 px-4 py-3 bg-gray-200 hover:bg-gray-300 text-gray-800 font-semibold rounded-xl transition-colors",children:"Start Fresh"}),e.jsx("button",{type:"button",onClick:p,className:"flex-1 px-4 py-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-xl transition-colors",children:"Resume Draft"})]})]})})}),e.jsx(I,{children:d&&e.jsx(v.div,{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",initial:{opacity:0},animate:{opacity:1},children:e.jsxs(v.div,{className:"bg-white dark:bg-gray-800 rounded-xl shadow-2xl max-w-md w-full p-8 text-center",initial:{scale:.9,y:20},animate:{scale:1,y:0},children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("svg",{className:"w-8 h-8 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsx("h3",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Form Submitted!"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"Your ICS-212 form has been successfully submitted and logged."}),e.jsx("button",{type:"button",onClick:()=>{o(!1),n(M),t(0)},className:"w-full px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-xl transition-colors",children:"Start New Form"})]})})})]})};export{dt as ICS212Form,dt as default};
//# sourceMappingURL=ICS212Form-hMM1hB71.js.map
