import{j as e,m as N,A as T}from"./ui-CK6awmVK.js";import{r as h}from"./vendor-DtipCrYl.js";import{c as q,s as F,L as B,z as v}from"./index-3s77kdUO.js";import{S as P,P as z}from"./SignatureCanvas-DRYd7Mbo.js";import{T as j}from"./TouchFeedback-jmoWXbnW.js";import{S as L,a as W,T as J}from"./SkeletonLoader-Ds0Hx_eH.js";import{X,A as U,P as G,T as O}from"./config-s1YJj8rv.js";import{C as D,a as Q,S as C}from"./square-pen-BsvLH7MU.js";import{C as Y}from"./chevron-down-BSneyYJM.js";const K=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Z=q("loader-circle",K),ee=({formData:t,onChange:n,onNext:d,errors:a})=>{const o=i=>{i.preventDefault(),d()},l=()=>new Date().toISOString().split("T")[0],y=()=>{const i=new Date,x=String(i.getHours()).padStart(2,"0"),u=String(i.getMinutes()).padStart(2,"0");return`${x}:${u}`};return e.jsxs(N.form,{className:"space-y-6 p-4 md:p-6",onSubmit:o,initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Incident Information"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Complete prior to vehicle inspection"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"incidentName",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Incident Name *"}),e.jsx("input",{type:"text",id:"incidentName",value:t.incidentName||"",onChange:i=>n("incidentName",i.target.value),placeholder:"e.g., Wildfire Response 2024",maxLength:100,className:`
            w-full px-4 py-3 text-base rounded-xl border-2 transition-all
            focus:outline-none focus:ring-4
            ${a.incidentName?"border-red-500 focus:border-red-500 focus:ring-red-100":"border-gray-300 focus:border-blue-500 focus:ring-blue-100"}
          `,style:{minHeight:"56px"}}),a.incidentName&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.incidentName})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"inspectorDate",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Date *"}),e.jsx("input",{type:"date",id:"inspectorDate",value:t.inspectorDate||l(),onChange:i=>n("inspectorDate",i.target.value),max:l(),className:`
              w-full px-4 py-3 text-base rounded-xl border-2 transition-all
              focus:outline-none focus:ring-4
              ${a.inspectorDate?"border-red-500 focus:border-red-500 focus:ring-red-100":"border-gray-300 focus:border-blue-500 focus:ring-blue-100"}
            `,style:{minHeight:"56px"}}),a.inspectorDate&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.inspectorDate})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"inspectorTime",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Time *"}),e.jsx("input",{type:"time",id:"inspectorTime",value:t.inspectorTime||y(),onChange:i=>n("inspectorTime",i.target.value),className:`
              w-full px-4 py-3 text-base rounded-xl border-2 transition-all
              focus:outline-none focus:ring-4
              ${a.inspectorTime?"border-red-500 focus:border-red-500 focus:ring-red-100":"border-gray-300 focus:border-blue-500 focus:ring-blue-100"}
            `,style:{minHeight:"56px"}}),a.inspectorTime&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.inspectorTime})]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"orderNo",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:["Order Number ",e.jsx("span",{className:"text-gray-500",children:"(Optional)"})]}),e.jsx("input",{type:"text",id:"orderNo",value:t.orderNo||"",onChange:i=>n("orderNo",i.target.value),placeholder:"e.g., ORDER-2024-00123",maxLength:50,className:`
            w-full px-4 py-3 text-base rounded-xl border-2 border-gray-300
            transition-all focus:outline-none focus:ring-4
            focus:border-blue-500 focus:ring-blue-100
          `,style:{minHeight:"56px"}})]}),e.jsx(j,{onTap:()=>d(),hapticType:"medium",children:e.jsx("button",{type:"submit",className:`
            w-full bg-blue-600 hover:bg-blue-700 text-white font-bold
            py-4 px-6 rounded-xl transition-all shadow-lg hover:shadow-xl
            focus:outline-none focus:ring-4 focus:ring-blue-300
          `,style:{minHeight:"56px"},children:"Next: Vehicle Selection"})})]})};function te({isOpen:t,onClose:n,onVehicleAdded:d}){const[a,o]=h.useState({regUnit:"",agency:"",vehicleMake:"",vehicleType:"",incidentId:"",vehicleId:"",features:"",licenseNumber:"",notes:"",vehicleStatus:"Active"}),[l,y]=h.useState({}),[i,x]=h.useState(!1),u=()=>{o({regUnit:"",agency:"",vehicleMake:"",vehicleType:"",incidentId:"",vehicleId:"",features:"",licenseNumber:"",notes:"",vehicleStatus:"Active"}),y({})},b=()=>{i||(u(),n())},f=()=>{const s={};return a.regUnit.trim()?a.regUnit.length>100&&(s.regUnit="Registered Unit must be 100 characters or less"):s.regUnit="Registered Unit is required",a.vehicleMake.trim()||(s.vehicleMake="Vehicle Make is required"),[a.agency,a.vehicleType,a.incidentId,a.vehicleId,a.features,a.licenseNumber,a.notes].some(r=>r.trim())||(s.general="At least one additional field must be filled"),y(s),Object.keys(s).length===0},k=async s=>{if(s.preventDefault(),!f()){F({message:"Please fix the validation errors",type:"error"});return}x(!0);try{const c=await fetch(`${U}/vehicles`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!c.ok){const g=await c.json();throw new Error(g.message||"Failed to create vehicle")}const r=await c.json();F({message:"Vehicle created successfully",type:"success"}),d(r.vehicle),u(),n()}catch(c){console.error("Error creating vehicle:",c),F({message:c instanceof Error?c.message:"Failed to create vehicle",type:"error"})}finally{x(!1)}};return t?e.jsx(T,{children:e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex min-h-screen items-center justify-center p-4",children:[e.jsx(N.div,{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:b,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0}}),e.jsxs(N.div,{className:"relative bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{duration:.2},children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700 sticky top-0 bg-white dark:bg-gray-800 z-10",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Add New Vehicle"}),e.jsx("button",{onClick:b,disabled:i,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(X,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:k,className:"p-6",children:[e.jsxs("div",{className:"space-y-4",children:[l.general&&e.jsx("div",{className:"p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg text-red-700 dark:text-red-400 text-sm",children:l.general}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Registered Unit ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:a.regUnit,onChange:s=>o({...a,regUnit:s.target.value}),className:`w-full px-3 py-2 border rounded-lg dark:bg-gray-700 dark:text-white ${l.regUnit?"border-red-500":"border-gray-300 dark:border-gray-600"}`,placeholder:"e.g., USAR-01",disabled:i}),l.regUnit&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:l.regUnit})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Agency"}),e.jsx("input",{type:"text",value:a.agency,onChange:s=>o({...a,agency:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white",placeholder:"e.g., FEMA",disabled:i})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Make ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:a.vehicleMake,onChange:s=>o({...a,vehicleMake:s.target.value}),className:`w-full px-3 py-2 border rounded-lg dark:bg-gray-700 dark:text-white ${l.vehicleMake?"border-red-500":"border-gray-300 dark:border-gray-600"}`,placeholder:"e.g., Ford, Chevrolet, International",disabled:i}),l.vehicleMake&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:l.vehicleMake})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Category/Type"}),e.jsx("input",{type:"text",value:a.vehicleType,onChange:s=>o({...a,vehicleType:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white",placeholder:"e.g., Heavy Rescue Truck, Cargo Trailer",disabled:i})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"License Number"}),e.jsx("input",{type:"text",value:a.licenseNumber,onChange:s=>o({...a,licenseNumber:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white",placeholder:"e.g., ABC-1234",disabled:i})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Incident ID"}),e.jsx("input",{type:"text",value:a.incidentId,onChange:s=>o({...a,incidentId:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white",placeholder:"e.g., INC-2024-001",disabled:i})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Classification"}),e.jsx("input",{type:"text",value:a.vehicleId,onChange:s=>o({...a,vehicleId:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white",placeholder:"e.g., VEHICLE-001",disabled:i})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Features"}),e.jsx("textarea",{value:a.features,onChange:s=>o({...a,features:s.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white",placeholder:"Describe special features, equipment, or capabilities",disabled:i})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Status"}),e.jsxs("select",{value:a.vehicleStatus,onChange:s=>o({...a,vehicleStatus:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white",disabled:i,children:[e.jsx("option",{value:"Active",children:"Active"}),e.jsx("option",{value:"Inactive",children:"Inactive"}),e.jsx("option",{value:"Maintenance",children:"Maintenance"}),e.jsx("option",{value:"Deployed",children:"Deployed"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Notes"}),e.jsx("textarea",{value:a.notes,onChange:s=>o({...a,notes:s.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white",placeholder:"Additional notes or comments",disabled:i})]})]}),e.jsxs("div",{className:"flex gap-3 justify-end pt-6 sticky bottom-0 bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 -mx-6 px-6 py-4 mt-6",children:[e.jsx("button",{type:"button",onClick:b,disabled:i,className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:i,className:"px-4 py-2 bg-[#0066FF] text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:i?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}),"Creating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(L,{className:"w-4 h-4"}),"Create Vehicle"]})})]})]})]})]})})}):null}const re=({formData:t,onChange:n,onNext:d,onBack:a,errors:o})=>{const[l,y]=h.useState([]),[i,x]=h.useState(!0),[u,b]=h.useState(!1);h.useEffect(()=>{f()},[]);const f=async()=>{x(!0);try{const r=await fetch(`${U}/vehicles`);if(!r.ok)throw new Error("Failed to fetch vehicles");const g=await r.json();y(g.vehicles||[])}catch(r){console.error("Error fetching vehicles:",r),F({message:"Failed to load vehicles",type:"error"})}finally{x(!1)}},k=r=>{if(!r){n("selectedVehicleId",""),n("vehicleIdNo",""),n("vehicleLicenseNo",""),n("vehicleType",""),n("agencyRegUnit","");return}if(r==="__ADD_NEW__"){b(!0);return}const g=l.find(I=>I.id===r);g&&(n("selectedVehicleId",g.id),n("vehicleIdNo",g.vehicleId||""),n("vehicleLicenseNo",g.licenseNumber||""),n("vehicleType",g.vehicleType||""),n("agencyRegUnit",g.regUnit||""))},s=async r=>{await f(),n("selectedVehicleId",r.id),n("vehicleIdNo",r.vehicleId||""),n("vehicleLicenseNo",r.licenseNumber||""),n("vehicleType",r.vehicleType||""),n("agencyRegUnit",r.regUnit||""),b(!1)},c=r=>{r.preventDefault(),d()};return e.jsxs(N.form,{className:"space-y-6 p-4 md:p-6",onSubmit:c,initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Vehicle Selection"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Select the vehicle to inspect or add a new one"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Vehicle Type"}),i?e.jsx(W,{type:"rectangle"}):e.jsxs("select",{value:t.selectedVehicleId||"",onChange:r=>k(r.target.value),className:`
              w-full px-4 py-3 text-base rounded-xl border-2 transition-all
              focus:outline-none focus:ring-4
              ${o.vehicleIdNo?"border-red-500 focus:border-red-500 focus:ring-red-100":"border-gray-300 focus:border-blue-500 focus:ring-blue-100"}
              dark:bg-gray-700 dark:text-white
            `,style:{minHeight:"56px"},children:[e.jsx("option",{value:"",children:"Select a vehicle (optional)"}),l.map(r=>e.jsx("option",{value:r.id,children:r.vehicleType&&r.vehicleMake?`${r.vehicleType} - ${r.vehicleMake} ${r.regUnit||""}`:r.regUnit||r.vehicleType||r.vehicleMake||"Unknown Vehicle"},r.id)),e.jsx("option",{value:"__ADD_NEW__",className:"font-semibold",children:"+ Add New Vehicle"})]}),!i&&l.length===0&&e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:'No vehicles found. Click "+ Add New Vehicle" to create one.'})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("button",{type:"button",onClick:()=>b(!0),className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg transition-colors",children:[e.jsx(G,{className:"w-4 h-4"}),"Add New Vehicle"]})}),t.selectedVehicleId&&e.jsx(N.div,{className:"bg-blue-50 dark:bg-blue-900/20 border-2 border-blue-200 dark:border-blue-800 rounded-xl p-4",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},children:(()=>{const r=l.find(g=>g.id===t.selectedVehicleId);return r?e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"text-sm font-semibold text-blue-900 dark:text-blue-100 mb-3",children:"Selected Vehicle Details"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Make/Type"}),e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:[r.vehicleMake,r.vehicleType].filter(Boolean).join(" ")||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"License Plate"}),e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:r.licenseNumber||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Agency Unit"}),e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:r.regUnit||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Status"}),e.jsx("span",{className:`
                        inline-block px-2 py-1 text-xs font-medium rounded-full
                        ${r.vehicleStatus==="Active"?"bg-green-100 text-green-800":r.vehicleStatus==="Inactive"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}
                      `,children:r.vehicleStatus||"Unknown"})]})]})]}):null})()}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"odometerReading",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Odometer Reading (miles)"}),e.jsx("input",{type:"number",id:"odometerReading",value:t.odometerReading||"",onChange:r=>n("odometerReading",parseInt(r.target.value)||0),placeholder:"Enter current odometer reading",min:0,max:999999999,className:`
            w-full px-4 py-3 text-base rounded-xl border-2 transition-all
            focus:outline-none focus:ring-4
            ${o.odometerReading?"border-red-500 focus:border-red-500 focus:ring-red-100":"border-gray-300 focus:border-blue-500 focus:ring-blue-100"}
            dark:bg-gray-700 dark:text-white
          `,style:{minHeight:"56px"}}),o.odometerReading&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:o.odometerReading})]}),e.jsxs("div",{className:"space-y-4 bg-gray-50 dark:bg-gray-800/50 rounded-xl p-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:"Vehicle Information (Auto-populated, editable)"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-600 dark:text-gray-400 mb-1",children:"License Number"}),e.jsx("input",{type:"text",value:t.vehicleLicenseNo||"",onChange:r=>n("vehicleLicenseNo",r.target.value),placeholder:"Enter license number",className:"w-full px-3 py-2 text-sm rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 dark:text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-600 dark:text-gray-400 mb-1",children:"Agency Reg/Unit"}),e.jsx("input",{type:"text",value:t.agencyRegUnit||"",onChange:r=>n("agencyRegUnit",r.target.value),placeholder:"Enter agency unit",className:"w-full px-3 py-2 text-sm rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 dark:text-white"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-xs text-gray-600 dark:text-gray-400 mb-1",children:"Vehicle Type"}),e.jsx("input",{type:"text",value:t.vehicleType||"",onChange:r=>n("vehicleType",r.target.value),placeholder:"e.g., Rescue, Engine, Ladder",className:"w-full px-3 py-2 text-sm rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 dark:text-white"})]})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(j,{onTap:()=>a(),hapticType:"light",children:e.jsx("button",{type:"button",onClick:a,className:`
              flex-1 bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold
              py-4 px-6 rounded-xl transition-all
              focus:outline-none focus:ring-4 focus:ring-gray-300
            `,style:{minHeight:"56px"},children:"Back"})}),e.jsx(j,{onTap:()=>d(),hapticType:"medium",children:e.jsx("button",{type:"submit",className:`
              flex-[2] bg-blue-600 hover:bg-blue-700 text-white font-bold
              py-4 px-6 rounded-xl transition-all shadow-lg hover:shadow-xl
              focus:outline-none focus:ring-4 focus:ring-blue-300
            `,style:{minHeight:"56px"},children:"Next: Inspection Items"})})]}),e.jsx(te,{isOpen:u,onClose:()=>b(!1),onVehicleAdded:s})]})},A=[{itemNumber:1,description:"Gauges and lights",status:"n/a",isSafetyItem:!0,reference:"See back*"},{itemNumber:2,description:"Seat belts",status:"n/a",isSafetyItem:!0,reference:"See back*"},{itemNumber:3,description:"Glass and mirrors",status:"n/a",isSafetyItem:!0,reference:"See back*"},{itemNumber:4,description:"Wipers and horn",status:"n/a",isSafetyItem:!0,reference:"See back*"},{itemNumber:5,description:"Engine compartment",status:"n/a",isSafetyItem:!0,reference:"See back*"},{itemNumber:6,description:"Fuel System",status:"n/a",isSafetyItem:!0,reference:"See back*"},{itemNumber:7,description:"Steering",status:"n/a",isSafetyItem:!0,reference:"See back*"},{itemNumber:8,description:"Brakes",status:"n/a",isSafetyItem:!0,reference:"See back*"},{itemNumber:9,description:"Drive line U-joints",status:"n/a",isSafetyItem:!1,reference:"Check play"},{itemNumber:10,description:"Springs and shocks",status:"n/a",isSafetyItem:!0,reference:"See back*"},{itemNumber:11,description:"Exhaust system",status:"n/a",isSafetyItem:!0,reference:"See back*"},{itemNumber:12,description:"Frame",status:"n/a",isSafetyItem:!0,reference:"See back*"},{itemNumber:13,description:"Tire and wheels",status:"n/a",isSafetyItem:!0,reference:"See back*"},{itemNumber:14,description:"Coupling devices / Emergency exit (buses)",status:"n/a",isSafetyItem:!1},{itemNumber:15,description:"Pump operation",status:"n/a",isSafetyItem:!1},{itemNumber:16,description:"Damage on incident",status:"n/a",isSafetyItem:!1},{itemNumber:17,description:"Other",status:"n/a",isSafetyItem:!1}],ae=({formData:t,onChange:n,onNext:d,onBack:a,errors:o})=>{const[l,y]=h.useState(new Set(["pre-trip","safety","operational"])),i=t.inspectionItems||A,x=h.useMemo(()=>i.some(c=>c.isSafetyItem&&c.status==="fail")?"hold":"release",[i]),u=(s,c)=>{const r=i.map(g=>g.itemNumber===s?{...g,status:c}:g);n("inspectionItems",r),n("releaseStatus",x)},b=s=>{const c=new Set(l);c.has(s)?c.delete(s):c.add(s),y(c)},f=s=>{const c=i.find(r=>r.itemNumber===s.itemNumber)||s;return e.jsx("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-start gap-3",children:[s.isSafetyItem&&e.jsx(O,{className:"w-5 h-5 text-amber-500 flex-shrink-0 mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"flex items-start justify-between mb-2",children:e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold text-gray-900 dark:text-white",children:[s.itemNumber,". ",s.description]}),s.reference&&e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:s.reference})]})}),e.jsxs("div",{className:"flex gap-2 mt-3",children:[e.jsx(j,{onTap:()=>u(s.itemNumber,"pass"),hapticType:"light",children:e.jsxs("button",{type:"button",onClick:()=>u(s.itemNumber,"pass"),className:`
                    flex-1 flex items-center justify-center gap-2 py-3 px-4 rounded-lg
                    font-semibold transition-all border-2
                    ${c.status==="pass"?"bg-green-500 text-white border-green-600 shadow-lg":"bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 border-gray-300 dark:border-gray-600"}
                  `,style:{minHeight:"48px"},children:[e.jsx(D,{className:"w-4 h-4"}),"Pass"]})}),e.jsx(j,{onTap:()=>u(s.itemNumber,"fail"),hapticType:"medium",children:e.jsxs("button",{type:"button",onClick:()=>u(s.itemNumber,"fail"),className:`
                    flex-1 flex items-center justify-center gap-2 py-3 px-4 rounded-lg
                    font-semibold transition-all border-2
                    ${c.status==="fail"?"bg-red-500 text-white border-red-600 shadow-lg":"bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 border-gray-300 dark:border-gray-600"}
                  `,style:{minHeight:"48px"},children:[e.jsx(Q,{className:"w-4 h-4"}),"Fail"]})}),e.jsx(j,{onTap:()=>u(s.itemNumber,"n/a"),hapticType:"light",children:e.jsx("button",{type:"button",onClick:()=>u(s.itemNumber,"n/a"),className:`
                    flex-1 flex items-center justify-center gap-2 py-3 px-4 rounded-lg
                    font-semibold transition-all border-2
                    ${c.status==="n/a"?"bg-gray-400 text-white border-gray-500 shadow-lg":"bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 border-gray-300 dark:border-gray-600"}
                  `,style:{minHeight:"48px"},children:"N/A"})})]})]})]})},s.itemNumber)},k=(s,c,r,g)=>{const I=l.has(c);return e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 rounded-xl overflow-hidden",children:[e.jsxs("button",{type:"button",onClick:()=>b(c),className:"w-full p-4 flex items-center justify-between hover:bg-gray-100 dark:hover:bg-gray-700/50 transition-colors",children:[e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:s}),g&&e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:g})]}),e.jsx(Y,{className:`w-6 h-6 text-gray-600 dark:text-gray-400 transition-transform ${I?"rotate-180":""}`})]}),e.jsx(T,{children:I&&e.jsx(N.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3},className:"overflow-hidden",children:e.jsx("div",{className:"p-4 space-y-3",children:r.map(f)})})})]})};return e.jsxs(N.div,{className:"space-y-6 p-4 md:p-6",initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Vehicle Inspection"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Inspect all items and mark Pass, Fail, or N/A"})]}),e.jsx(N.div,{className:`
          p-4 rounded-xl border-2 flex items-center justify-between
          ${x==="hold"?"bg-red-50 border-red-500 dark:bg-red-900/20 dark:border-red-700":"bg-green-50 border-green-500 dark:bg-green-900/20 dark:border-green-700"}
        `,layout:!0,children:e.jsxs("div",{className:"flex items-center gap-3",children:[x==="hold"?e.jsx(O,{className:"w-6 h-6 text-red-600 dark:text-red-400"}):e.jsx(D,{className:"w-6 h-6 text-green-600 dark:text-green-400"}),e.jsxs("div",{children:[e.jsx("p",{className:`font-bold text-lg ${x==="hold"?"text-red-900 dark:text-red-100":"text-green-900 dark:text-green-100"}`,children:x==="hold"?"ðŸ”´ HOLD FOR REPAIRS":"ðŸŸ¢ RELEASED"}),x==="hold"&&e.jsx("p",{className:"text-sm text-red-700 dark:text-red-300",children:"Safety Item â€“ Do Not Release Until Repaired"})]})]})}),e.jsxs("div",{className:"space-y-4",children:[k("Pre-Trip Items","pre-trip",A.slice(0,5),"Items 1-5"),k("Safety Equipment","safety",A.slice(5,13),"âš ï¸ Items 6-13 - All Safety-Critical"),k("Operational Systems","operational",A.slice(13),"Items 14-17")]}),e.jsxs("div",{className:"flex gap-3 sticky bottom-4 bg-white dark:bg-gray-900 p-4 rounded-xl shadow-lg",children:[e.jsx(j,{onTap:()=>a(),hapticType:"light",children:e.jsx("button",{type:"button",onClick:a,className:`
              flex-1 bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold
              py-4 px-6 rounded-xl transition-all
              focus:outline-none focus:ring-4 focus:ring-gray-300
            `,style:{minHeight:"56px"},children:"Back"})}),e.jsx(j,{onTap:()=>d(),hapticType:"medium",children:e.jsx("button",{type:"button",onClick:d,className:`
              flex-[2] bg-blue-600 hover:bg-blue-700 text-white font-bold
              py-4 px-6 rounded-xl transition-all shadow-lg hover:shadow-xl
              focus:outline-none focus:ring-4 focus:ring-blue-300
            `,style:{minHeight:"56px"},children:"Next: Comments"})})]})]})},se=({formData:t,onChange:n,onNext:d,onBack:a})=>{const o=h.useRef(null),l=2e3,y=(t.additionalComments||"").length;return h.useEffect(()=>{o.current&&(o.current.style.height="auto",o.current.style.height=`${o.current.scrollHeight}px`)},[t.additionalComments]),e.jsxs(N.div,{className:"space-y-6 p-4 md:p-6",initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Additional Comments"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Add any notes, repair recommendations, or additional findings (optional)"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"additionalComments",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:["Comments ",e.jsx("span",{className:"text-gray-500",children:"(Optional)"})]}),e.jsx("textarea",{ref:o,id:"additionalComments",value:t.additionalComments||"",onChange:i=>n("additionalComments",i.target.value),placeholder:"Enter any additional comments, notes, or repair recommendations...",maxLength:l,rows:10,className:`
            w-full px-4 py-3 text-base rounded-xl border-2 border-gray-300
            transition-all focus:outline-none focus:ring-4
            focus:border-blue-500 focus:ring-blue-100 resize-none
            dark:bg-gray-800 dark:border-gray-600 dark:text-white
          `,style:{minHeight:"200px"}}),e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Detailed notes help with repairs and maintenance tracking"}),e.jsxs("p",{className:`text-sm font-medium ${y>l*.9?"text-red-600":"text-gray-600"}`,children:[y," / ",l]})]})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 rounded-xl p-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3",children:"Quick Suggestions"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:["No issues found","Minor wear observed","Requires immediate attention","Scheduled maintenance due","Pre-incident condition noted"].map(i=>e.jsxs("button",{type:"button",onClick:()=>{const x=t.additionalComments||"";n("additionalComments",`${x}${x?`
`:""}${i}`)},className:`
                px-3 py-2 text-sm rounded-lg bg-white dark:bg-gray-700
                border border-gray-300 dark:border-gray-600
                hover:bg-blue-50 hover:border-blue-300 dark:hover:bg-gray-600
                transition-colors text-gray-700 dark:text-gray-300
              `,children:["+ ",i]},i))})]}),e.jsxs("div",{className:"flex gap-3 sticky bottom-4 bg-white dark:bg-gray-900 p-4 rounded-xl shadow-lg",children:[e.jsx(j,{onTap:()=>a(),hapticType:"light",children:e.jsx("button",{type:"button",onClick:a,className:`
              flex-1 bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold
              py-4 px-6 rounded-xl transition-all
              focus:outline-none focus:ring-4 focus:ring-gray-300
            `,style:{minHeight:"56px"},children:"Back"})}),e.jsx(j,{onTap:()=>d(),hapticType:"medium",children:e.jsx("button",{type:"button",onClick:d,className:`
              flex-[2] bg-blue-600 hover:bg-blue-700 text-white font-bold
              py-4 px-6 rounded-xl transition-all shadow-lg hover:shadow-xl
              focus:outline-none focus:ring-4 focus:ring-blue-300
            `,style:{minHeight:"56px"},children:"Next: Inspector Signature"})})]})]})},ie=({formData:t,onChange:n,onNext:d,onBack:a,errors:o})=>{const[l,y]=h.useState(!!t.inspectorSignature),i=f=>{const k={imageData:f,signedAt:new Date().toISOString(),signedBy:t.inspectorNamePrint||"",ipAddress:void 0,deviceId:navigator.userAgent};n("inspectorSignature",k),y(!0),n("status","inspector_signed")},x=()=>{const f=new Date;return{date:f.toISOString().split("T")[0],time:f.toTimeString().slice(0,5)}},{date:u,time:b}=x();return e.jsxs(N.div,{className:"space-y-6 p-4 md:p-6",initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Inspector Signature"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Sign to lock the inspection form and proceed to review"})]}),l&&e.jsx(N.div,{className:"bg-amber-50 dark:bg-amber-900/20 border-2 border-amber-500 rounded-xl p-4",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(B,{className:"w-6 h-6 text-amber-600 dark:text-amber-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-amber-900 dark:text-amber-100",children:"Form Locked"}),e.jsx("p",{className:"text-sm text-amber-700 dark:text-amber-300",children:"Inspector signature has been recorded. Form is read-only."})]})]})}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"inspectorNamePrint",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Inspector Name (Print) *"}),e.jsx("input",{type:"text",id:"inspectorNamePrint",value:t.inspectorNamePrint||"",onChange:f=>n("inspectorNamePrint",f.target.value),placeholder:"Enter your full name",maxLength:100,disabled:l,className:`
            w-full px-4 py-3 text-base rounded-xl border-2 transition-all
            focus:outline-none focus:ring-4
            ${l?"bg-gray-100 dark:bg-gray-800 border-gray-300 cursor-not-allowed":o.inspectorNamePrint?"border-red-500 focus:border-red-500 focus:ring-red-100":"border-gray-300 focus:border-blue-500 focus:ring-blue-100"}
          `,style:{minHeight:"56px"}}),o.inspectorNamePrint&&!l&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:o.inspectorNamePrint})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 rounded-xl p-4",children:[e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mb-1",children:"Date"}),e.jsx("p",{className:"text-lg font-bold text-gray-900 dark:text-white",children:new Date(t.inspectorDate||u).toLocaleDateString()})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 rounded-xl p-4",children:[e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mb-1",children:"Time"}),e.jsx("p",{className:"text-lg font-bold text-gray-900 dark:text-white",children:t.inspectorTime||b})]})]}),e.jsx("div",{children:e.jsx(P,{onSave:i,initialSignature:t.inspectorSignature?.imageData,disabled:l,label:"Inspector Signature"})}),l&&t.inspectorSignature&&e.jsx(N.div,{className:"bg-green-50 dark:bg-green-900/20 border-2 border-green-500 rounded-xl p-4",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(D,{className:"w-6 h-6 text-green-600 dark:text-green-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-green-900 dark:text-green-100",children:"Signature Recorded"}),e.jsxs("p",{className:"text-sm text-green-700 dark:text-green-300",children:["Signed by ",t.inspectorNamePrint," on"," ",new Date(t.inspectorSignature.signedAt).toLocaleString()]})]})]})}),e.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-3",children:e.jsxs("p",{className:"text-xs text-blue-900 dark:text-blue-100",children:[e.jsx("strong",{children:"Notice:"})," By signing this form, you certify that the inspection was conducted in accordance with ICS-212 standards and that all information is accurate to the best of your knowledge."]})}),e.jsxs("div",{className:"flex gap-3 sticky bottom-4 bg-white dark:bg-gray-900 p-4 rounded-xl shadow-lg",children:[!l&&e.jsx(j,{onTap:()=>a(),hapticType:"light",children:e.jsx("button",{type:"button",onClick:a,className:`
                flex-1 bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold
                py-4 px-6 rounded-xl transition-all
                focus:outline-none focus:ring-4 focus:ring-gray-300
              `,style:{minHeight:"56px"},children:"Back"})}),e.jsx(j,{onTap:()=>d(),hapticType:"medium",children:e.jsx("button",{type:"button",onClick:d,disabled:!l,className:`
              ${l?"flex-1":"flex-[2]"}
              font-bold py-4 px-6 rounded-xl transition-all shadow-lg
              focus:outline-none focus:ring-4
              ${l?"bg-blue-600 hover:bg-blue-700 text-white focus:ring-blue-300 hover:shadow-xl":"bg-gray-300 text-gray-500 cursor-not-allowed"}
            `,style:{minHeight:"56px"},children:l?"Next: Review & Submit":"Sign Form to Continue"})})]})]})},ne=({formData:t,onChange:n,onBack:d,onGoToStep:a,onSubmit:o})=>{const[l,y]=h.useState(!1),[i,x]=h.useState(!!t.operatorSignature),u=r=>{const g={imageData:r,signedAt:new Date().toISOString(),signedBy:t.operatorNamePrint||"",ipAddress:void 0,deviceId:navigator.userAgent};n("operatorSignature",g),n("operatorDate",new Date().toISOString().split("T")[0]),n("operatorTime",new Date().toTimeString().slice(0,5)),x(!0)},b=async()=>{if(!i){v.error("Operator signature required");return}y(!0);try{await o(),v.success("Form submitted successfully!")}catch(r){v.error("Submission failed. Please try again."),console.error("Submission error:",r)}finally{y(!1)}},f=t.inspectionItems?.filter(r=>r.status==="pass").length||0,k=t.inspectionItems?.filter(r=>r.status==="fail").length||0,s=t.inspectionItems?.filter(r=>r.status==="n/a").length||0,c=t.releaseStatus||"release";return e.jsxs(N.div,{className:"space-y-6 p-4 md:p-6 pb-24",initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Review & Submit"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Review all information before final submission"})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border-2 border-gray-200 dark:border-gray-700 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Incident Information"}),e.jsxs("button",{type:"button",onClick:()=>a(0),className:"text-blue-600 hover:text-blue-700 flex items-center gap-1 text-sm",children:[e.jsx(C,{className:"w-4 h-4"})," Edit"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Incident Name"}),e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:t.incidentName||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Date/Time"}),e.jsxs("p",{className:"font-semibold text-gray-900 dark:text-white",children:[t.inspectorDate," ",t.inspectorTime]})]}),t.orderNo&&e.jsxs("div",{className:"col-span-2",children:[e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Order Number"}),e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:t.orderNo})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border-2 border-gray-200 dark:border-gray-700 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Vehicle Information"}),e.jsxs("button",{type:"button",onClick:()=>a(1),className:"text-blue-600 hover:text-blue-700 flex items-center gap-1 text-sm",children:[e.jsx(C,{className:"w-4 h-4"})," Edit"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Vehicle ID"}),e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:t.vehicleIdNo||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Odometer"}),e.jsxs("p",{className:"font-semibold text-gray-900 dark:text-white",children:[t.odometerReading?.toLocaleString()||"N/A"," mi"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"License Plate"}),e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:t.vehicleLicenseNo||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Type"}),e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:t.vehicleType||"N/A"})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border-2 border-gray-200 dark:border-gray-700 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Inspection Results"}),e.jsxs("button",{type:"button",onClick:()=>a(2),className:"text-blue-600 hover:text-blue-700 flex items-center gap-1 text-sm",children:[e.jsx(C,{className:"w-4 h-4"})," Edit"]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-4",children:[e.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-lg p-3 text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:f}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Passed"})]}),e.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 rounded-lg p-3 text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-red-600 dark:text-red-400",children:k}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Failed"})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-3 text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-gray-600 dark:text-gray-400",children:s}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"N/A"})]})]}),e.jsx("div",{className:`
          p-4 rounded-lg text-center font-bold text-lg
          ${c==="hold"?"bg-red-100 text-red-900 dark:bg-red-900/30 dark:text-red-100":"bg-green-100 text-green-900 dark:bg-green-900/30 dark:text-green-100"}
        `,children:c==="hold"?"ðŸ”´ HOLD FOR REPAIRS":"ðŸŸ¢ RELEASED"})]}),t.additionalComments&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border-2 border-gray-200 dark:border-gray-700 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Additional Comments"}),e.jsxs("button",{type:"button",onClick:()=>a(3),className:"text-blue-600 hover:text-blue-700 flex items-center gap-1 text-sm",children:[e.jsx(C,{className:"w-4 h-4"})," Edit"]})]}),e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 whitespace-pre-wrap",children:t.additionalComments})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border-2 border-gray-200 dark:border-gray-700 p-4",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-3",children:"Inspector Signature"}),e.jsxs("div",{className:"flex items-center gap-4",children:[t.inspectorSignature?.imageData&&e.jsx("img",{src:t.inspectorSignature.imageData,alt:"Inspector signature",className:"h-20 border border-gray-300 rounded bg-white"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:t.inspectorNamePrint}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Signed: ",t.inspectorSignature&&new Date(t.inspectorSignature.signedAt).toLocaleString()]})]})]})]}),e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-xl border-2 border-blue-200 dark:border-blue-800 p-4",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-3",children:"Operator Signature Required"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"operatorNamePrint",className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Operator Name (Print) *"}),e.jsx("input",{type:"text",id:"operatorNamePrint",value:t.operatorNamePrint||"",onChange:r=>n("operatorNamePrint",r.target.value),placeholder:"Enter operator full name",maxLength:100,disabled:i,className:`
                w-full px-4 py-3 text-base rounded-xl border-2 transition-all
                focus:outline-none focus:ring-4
                ${i?"bg-gray-100 dark:bg-gray-800 border-gray-300 cursor-not-allowed":"border-gray-300 focus:border-blue-500 focus:ring-blue-100"}
              `})]}),e.jsx(P,{onSave:u,initialSignature:t.operatorSignature?.imageData,disabled:i,label:"Operator Signature"})]})]}),e.jsx("div",{className:"sticky bottom-4 bg-white dark:bg-gray-900 p-4 rounded-xl shadow-lg",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx(j,{onTap:()=>d(),hapticType:"light",children:e.jsx("button",{type:"button",onClick:d,disabled:l,className:`
                flex-1 bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold
                py-4 px-6 rounded-xl transition-all
                focus:outline-none focus:ring-4 focus:ring-gray-300
                disabled:opacity-50 disabled:cursor-not-allowed
              `,style:{minHeight:"56px"},children:"Back"})}),e.jsx(j,{onTap:b,hapticType:"heavy",children:e.jsx("button",{type:"button",onClick:b,disabled:!i||l,className:`
                flex-[2] font-bold py-4 px-6 rounded-xl transition-all
                focus:outline-none focus:ring-4 flex items-center justify-center gap-2
                ${i&&!l?"bg-green-600 hover:bg-green-700 text-white focus:ring-green-300 shadow-lg hover:shadow-xl":"bg-gray-300 text-gray-500 cursor-not-allowed"}
              `,style:{minHeight:"56px"},children:l?e.jsxs(e.Fragment,{children:[e.jsx(Z,{className:"w-5 h-5 animate-spin"}),"Submitting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(D,{className:"w-5 h-5"}),"Submit Final Form"]})})})]})})]})},S=[{id:0,title:"Incident Info",component:ee},{id:1,title:"Vehicle",component:re},{id:2,title:"Inspection",component:ae},{id:3,title:"Comments",component:se},{id:4,title:"Inspector Sign",component:ie},{id:5,title:"Review & Submit",component:ne}],E={status:"draft",incidentName:"",orderNo:"",vehicleIdNo:"",vehicleLicenseNo:"",agencyRegUnit:"",vehicleType:"",selectedVehicleId:"",odometerReading:0,inspectionItems:[],additionalComments:"",releaseStatus:"release",inspectorDate:new Date().toISOString().split("T")[0],inspectorTime:new Date().toTimeString().slice(0,5),inspectorNamePrint:""},be=()=>{const[t,n]=h.useState(0),[d,a]=h.useState(E),[o,l]=h.useState({}),[y,i]=h.useState(!1),[x,u]=h.useState(!1),[b,f]=h.useState(null);h.useEffect(()=>{const m=setInterval(()=>{if(d&&!y&&t>0){const p={formData:d,currentStep:t,savedAt:new Date().toISOString(),expiresAt:new Date(Date.now()+6048e5).toISOString()};localStorage.setItem("ics212-draft",JSON.stringify(p)),v.success("Draft auto-saved",{duration:1500,icon:"ðŸ’¾"})}},3e4);return()=>clearInterval(m)},[d,t,y]),h.useEffect(()=>{const m=localStorage.getItem("ics212-draft");if(m)try{const p=JSON.parse(m);new Date(p.expiresAt)>new Date?(f(p),u(!0)):localStorage.removeItem("ics212-draft")}catch(p){console.error("Failed to parse draft:",p),localStorage.removeItem("ics212-draft")}},[]);const k=()=>{b&&(a(b.formData),n(b.currentStep),u(!1),v.success("Draft restored!"))},s=()=>{localStorage.removeItem("ics212-draft"),u(!1),f(null),v("Draft discarded",{icon:"ðŸ—‘ï¸"})},c=(m,p)=>{a(w=>({...w,[m]:p})),o[m]&&l(w=>{const R={...w};return delete R[m],R})},r=m=>{const p={};switch(m){case 0:(!d.incidentName||d.incidentName.length<3)&&(p.incidentName="Incident name must be at least 3 characters"),d.inspectorDate||(p.inspectorDate="Date is required"),d.inspectorTime||(p.inspectorTime="Time is required");break;case 1:d.selectedVehicleId||(p.vehicleIdNo="Please select a vehicle"),(!d.odometerReading||d.odometerReading<=0)&&(p.odometerReading="Odometer reading is required");break;case 4:(!d.inspectorNamePrint||(d.inspectorNamePrint||"").length<2)&&(p.inspectorNamePrint="Inspector name must be at least 2 characters"),d.inspectorSignature||(p.inspectorSignature="Signature is required");break}return l(p),Object.keys(p).length===0},g=()=>{r(t)?t<S.length-1&&n(t+1):v.error("Please complete all required fields")},I=()=>{t>0&&n(t-1)},V=m=>{m>=0&&m<S.length&&n(m)},$=()=>{const m={formData:d,currentStep:t,savedAt:new Date().toISOString(),expiresAt:new Date(Date.now()+6048e5).toISOString()};localStorage.setItem("ics212-draft",JSON.stringify(m)),v.success("Draft saved manually!",{icon:"ðŸ’¾"})},H=()=>{confirm("Are you sure you want to clear all form data? This cannot be undone.")&&(a(E),n(0),l({}),localStorage.removeItem("ics212-draft"),v("Form cleared",{icon:"ðŸ—‘ï¸"}))},M=async()=>{try{const m={...d,submittedAt:new Date().toISOString(),status:"submitted"},p=await fetch("/api/ics212/submit",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(m)});if(!p.ok)throw new Error("Submission failed");const w=await p.json();if(w.success)i(!0),localStorage.removeItem("ics212-draft"),v.success(`Form submitted! ID: ${w.formId}`),console.log("Submission result:",w);else throw new Error(w.error||"Submission failed")}catch(m){throw console.error("Submission error:",m),m}},_=S[t].component;return e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[e.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 sticky top-0 z-40 shadow-sm",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:"/taskforce-io-logo.png",alt:"TASKFORCE IO",className:"w-10 h-10 object-contain"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"ICS-212 Vehicle Safety Inspection"}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Step ",t+1," of ",S.length,": ",S[t].title]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",onClick:$,className:"p-2 rounded-lg bg-blue-100 text-blue-600 hover:bg-blue-200 transition-colors",title:"Save Draft",children:e.jsx(L,{className:"w-5 h-5"})}),e.jsx("button",{type:"button",onClick:H,className:"p-2 rounded-lg bg-red-100 text-red-600 hover:bg-red-200 transition-colors",title:"Clear Form",children:e.jsx(J,{className:"w-5 h-5"})})]})]}),e.jsx(z,{currentStep:t+1,totalSteps:S.length,labels:S.map(m=>m.title)})]})}),e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsx(T,{mode:"wait",children:e.jsx(N.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:e.jsx(_,{formData:d,onChange:c,onNext:g,onBack:I,onGoToStep:V,onSubmit:M,errors:o})},t)})}),e.jsx(T,{children:x&&e.jsx(N.div,{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:e.jsxs(N.div,{className:"bg-white dark:bg-gray-800 rounded-xl shadow-2xl max-w-md w-full p-6",initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:"Resume Draft?"}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:["We found a saved draft from"," ",b&&new Date(b.savedAt).toLocaleString(),". Would you like to resume where you left off?"]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"button",onClick:s,className:"flex-1 px-4 py-3 bg-gray-200 hover:bg-gray-300 text-gray-800 font-semibold rounded-xl transition-colors",children:"Start Fresh"}),e.jsx("button",{type:"button",onClick:k,className:"flex-1 px-4 py-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-xl transition-colors",children:"Resume Draft"})]})]})})}),e.jsx(T,{children:y&&e.jsx(N.div,{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",initial:{opacity:0},animate:{opacity:1},children:e.jsxs(N.div,{className:"bg-white dark:bg-gray-800 rounded-xl shadow-2xl max-w-md w-full p-8 text-center",initial:{scale:.9,y:20},animate:{scale:1,y:0},children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("svg",{className:"w-8 h-8 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsx("h3",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Form Submitted!"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"Your ICS-212 form has been successfully submitted and logged."}),e.jsx("button",{type:"button",onClick:()=>{i(!1),a(E),n(0)},className:"w-full px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-xl transition-colors",children:"Start New Form"})]})})})]})};export{be as ICS212Form,be as default};
//# sourceMappingURL=ICS212Form-xwLHsUen.js.map
