{"version":3,"file":"FormDetail-BlTIkk_g.js","sources":["../../src/components/admin/FormDetail.tsx"],"sourcesContent":["/**\n * Form Detail Component\n * \n * Displays complete ICS-212 form information with PDF preview\n * Features:\n * - PDF preview in iframe\n * - Complete form metadata\n * - Download PDF button\n * - Email distribution button\n * - Vehicle history timeline\n */\n\nimport { useState, useEffect } from 'react';\nimport { API_BASE_URL } from '../../lib/config';\nimport { TouchFeedback } from '../mobile/TouchFeedback';\nimport { showToast } from '../mobile/Toast';\n\ninterface FormDetailProps {\n  formId: string;\n}\n\nexport function FormDetail({ formId }: FormDetailProps) {\n  const [loading, setLoading] = useState(true);\n  const [form, setForm] = useState<any>(null);\n\n  useEffect(() => {\n    fetchFormDetail();\n  }, [formId]);\n\n  const fetchFormDetail = async () => {\n    try {\n      const response = await fetch(`${API_BASE_URL}/ics212/forms/${formId}`);\n      if (!response.ok) throw new Error('Failed to fetch form');\n      const data = await response.json();\n      setForm(data.form);\n    } catch (error) {\n      console.error('Error fetching form detail:', error);\n      showToast({ message: 'Failed to load form details', type: 'error' });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleDownloadPDF = () => {\n    const downloadUrl = `${API_BASE_URL}/ics212/pdf?formId=${formId}`;\n    window.open(downloadUrl, '_blank');\n  };\n\n  if (loading) {\n    return (\n      <div className=\"p-4 space-y-4\">\n        <div className=\"animate-pulse space-y-3\">\n          <div className=\"h-4 bg-gray-200 dark:bg-gray-700 rounded w-3/4\"></div>\n          <div className=\"h-32 bg-gray-200 dark:bg-gray-700 rounded\"></div>\n        </div>\n      </div>\n    );\n  }\n\n  if (!form) {\n    return (\n      <div className=\"p-4 text-center\">\n        <p className=\"text-red-500\">Form not found</p>\n      </div>\n    );\n  }\n\n  // Construct PDF preview URL from form ID\n  const pdfPreviewUrl = form.pdf_url ? `${API_BASE_URL}/ics212/pdf/preview?formId=${formId}` : null;\n\n  return (\n    <div className=\"space-y-4 max-h-[80vh] overflow-y-auto\">\n      {/* Header */}\n      <div className=\"sticky top-0 bg-white dark:bg-gray-800 p-4 border-b border-gray-200 dark:border-gray-700\">\n        <h3 className=\"font-bold text-xl text-gray-900 dark:text-white\">\n          {form.vehicle_id_no}\n        </h3>\n        <p className=\"text-sm text-gray-600 dark:text-gray-400\">{form.incident_name}</p>\n        <div className=\"mt-2\">\n          <span className={`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${\n            form.release_decision === 'hold' \n              ? 'bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200'\n              : 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200'\n          }`}>\n            {form.release_decision === 'hold' ? 'üî¥ HOLD' : 'üü¢ RELEASED'}\n          </span>\n        </div>\n      </div>\n\n      {/* PDF Preview */}\n      {pdfPreviewUrl ? (\n        <div className=\"px-4\">\n          <div className=\"border border-gray-300 dark:border-gray-600 rounded-lg overflow-hidden bg-gray-100 dark:bg-gray-900\">\n            <iframe\n              src={pdfPreviewUrl}\n              className=\"w-full\"\n              style={{ height: '400px' }}\n              title=\"PDF Preview\"\n            />\n          </div>\n          <TouchFeedback>\n            <button\n              onClick={handleDownloadPDF}\n              className=\"w-full mt-2 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-colors\"\n            >\n              üì• Download PDF\n            </button>\n          </TouchFeedback>\n        </div>\n      ) : (\n        <div className=\"px-4\">\n          <div className=\"border border-yellow-300 dark:border-yellow-600 rounded-lg p-4 bg-yellow-50 dark:bg-yellow-900/20\">\n            <p className=\"text-yellow-800 dark:text-yellow-200 text-sm\">\n              ‚ö†Ô∏è PDF not available. It may still be generating or there was an error during submission.\n            </p>\n          </div>\n        </div>\n      )}\n\n      {/* Form Details */}\n      <div className=\"px-4 space-y-3\">\n        <h4 className=\"font-semibold text-gray-900 dark:text-white\">Inspection Details</h4>\n        \n        <div className=\"grid grid-cols-2 gap-3 text-sm\">\n          <div>\n            <span className=\"font-medium text-gray-700 dark:text-gray-300\">Inspector:</span>\n            <p className=\"text-gray-900 dark:text-white\">{form.inspector_name_print}</p>\n          </div>\n          <div>\n            <span className=\"font-medium text-gray-700 dark:text-gray-300\">Date:</span>\n            <p className=\"text-gray-900 dark:text-white\">{form.inspector_date}</p>\n          </div>\n          <div>\n            <span className=\"font-medium text-gray-700 dark:text-gray-300\">Time:</span>\n            <p className=\"text-gray-900 dark:text-white\">{form.inspector_time}</p>\n          </div>\n          <div>\n            <span className=\"font-medium text-gray-700 dark:text-gray-300\">Vehicle Type:</span>\n            <p className=\"text-gray-900 dark:text-white\">{form.vehicle_type}</p>\n          </div>\n          <div>\n            <span className=\"font-medium text-gray-700 dark:text-gray-300\">License:</span>\n            <p className=\"text-gray-900 dark:text-white\">{form.vehicle_license_no}</p>\n          </div>\n          <div>\n            <span className=\"font-medium text-gray-700 dark:text-gray-300\">Agency/Unit:</span>\n            <p className=\"text-gray-900 dark:text-white\">{form.agency_reg_unit}</p>\n          </div>\n        </div>\n\n        {form.additional_comments && (\n          <div>\n            <span className=\"font-medium text-gray-700 dark:text-gray-300\">Comments:</span>\n            <p className=\"text-sm text-gray-900 dark:text-white mt-1 p-2 bg-gray-50 dark:bg-gray-700 rounded\">\n              {form.additional_comments}\n            </p>\n          </div>\n        )}\n\n        {form.github_issue_number && (\n          <TouchFeedback>\n            <a\n              href={`https://github.com/pdarleyjr/mbfd-checkout-system/issues/${form.github_issue_number}`}\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n              className=\"block w-full py-2 px-4 bg-gray-100 dark:bg-gray-700 text-blue-600 dark:text-blue-400 rounded-lg text-center font-medium hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors\"\n            >\n              View GitHub Issue #{form.github_issue_number} ‚Üí\n            </a>\n          </TouchFeedback>\n        )}\n      </div>\n    </div>\n  );\n}\n"],"names":["FormDetail","formId","loading","setLoading","useState","form","setForm","useEffect","fetchFormDetail","response","API_BASE_URL","data","error","showToast","handleDownloadPDF","downloadUrl","jsxs","jsx","pdfPreviewUrl","TouchFeedback"],"mappings":"+MAqBO,SAASA,EAAW,CAAE,OAAAC,GAA2B,CACtD,KAAM,CAACC,EAASC,CAAU,EAAIC,EAAAA,SAAS,EAAI,EACrC,CAACC,EAAMC,CAAO,EAAIF,EAAAA,SAAc,IAAI,EAE1CG,EAAAA,UAAU,IAAM,CACdC,EAAA,CACF,EAAG,CAACP,CAAM,CAAC,EAEX,MAAMO,EAAkB,SAAY,CAClC,GAAI,CACF,MAAMC,EAAW,MAAM,MAAM,GAAGC,CAAY,iBAAiBT,CAAM,EAAE,EACrE,GAAI,CAACQ,EAAS,GAAI,MAAM,IAAI,MAAM,sBAAsB,EACxD,MAAME,EAAO,MAAMF,EAAS,KAAA,EAC5BH,EAAQK,EAAK,IAAI,CACnB,OAASC,EAAO,CACd,QAAQ,MAAM,8BAA+BA,CAAK,EAClDC,EAAU,CAAE,QAAS,8BAA+B,KAAM,QAAS,CACrE,QAAA,CACEV,EAAW,EAAK,CAClB,CACF,EAEMW,EAAoB,IAAM,CAC9B,MAAMC,EAAc,GAAGL,CAAY,sBAAsBT,CAAM,GAC/D,OAAO,KAAKc,EAAa,QAAQ,CACnC,EAEA,GAAIb,EACF,aACG,MAAA,CAAI,UAAU,gBACb,SAAAc,EAAAA,KAAC,MAAA,CAAI,UAAU,0BACb,SAAA,CAAAC,EAAAA,IAAC,MAAA,CAAI,UAAU,gDAAA,CAAiD,EAChEA,EAAAA,IAAC,MAAA,CAAI,UAAU,2CAAA,CAA4C,CAAA,CAAA,CAC7D,CAAA,CACF,EAIJ,GAAI,CAACZ,EACH,OACEY,EAAAA,IAAC,OAAI,UAAU,kBACb,eAAC,IAAA,CAAE,UAAU,eAAe,SAAA,gBAAA,CAAc,CAAA,CAC5C,EAKJ,MAAMC,EAAgBb,EAAK,QAAU,GAAGK,CAAY,8BAA8BT,CAAM,GAAK,KAE7F,OACEe,EAAAA,KAAC,MAAA,CAAI,UAAU,yCAEb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,2FACb,SAAA,CAAAC,EAAAA,IAAC,KAAA,CAAG,UAAU,kDACX,SAAAZ,EAAK,cACR,EACAY,EAAAA,IAAC,IAAA,CAAE,UAAU,2CAA4C,WAAK,cAAc,QAC3E,MAAA,CAAI,UAAU,OACb,SAAAA,EAAAA,IAAC,OAAA,CAAK,UAAW,uEACfZ,EAAK,mBAAqB,OACtB,4DACA,mEACN,GACG,SAAAA,EAAK,mBAAqB,OAAS,UAAY,cAClD,CAAA,CACF,CAAA,EACF,EAGCa,EACCF,EAAAA,KAAC,MAAA,CAAI,UAAU,OACb,SAAA,CAAAC,EAAAA,IAAC,MAAA,CAAI,UAAU,sGACb,SAAAA,EAAAA,IAAC,SAAA,CACC,IAAKC,EACL,UAAU,SACV,MAAO,CAAE,OAAQ,OAAA,EACjB,MAAM,aAAA,CAAA,EAEV,QACCC,EAAA,CACC,SAAAF,EAAAA,IAAC,SAAA,CACC,QAASH,EACT,UAAU,qGACX,SAAA,iBAAA,CAAA,CAED,CACF,CAAA,EACF,EAEAG,MAAC,MAAA,CAAI,UAAU,OACb,SAAAA,EAAAA,IAAC,MAAA,CAAI,UAAU,oGACb,eAAC,IAAA,CAAE,UAAU,+CAA+C,SAAA,2FAAA,CAE5D,EACF,EACF,EAIFD,EAAAA,KAAC,MAAA,CAAI,UAAU,iBACb,SAAA,CAAAC,EAAAA,IAAC,KAAA,CAAG,UAAU,8CAA8C,SAAA,qBAAkB,EAE9ED,EAAAA,KAAC,MAAA,CAAI,UAAU,iCACb,SAAA,CAAAA,OAAC,MAAA,CACC,SAAA,CAAAC,EAAAA,IAAC,OAAA,CAAK,UAAU,+CAA+C,SAAA,aAAU,EACzEA,EAAAA,IAAC,IAAA,CAAE,UAAU,gCAAiC,WAAK,oBAAA,CAAqB,CAAA,EAC1E,SACC,MAAA,CACC,SAAA,CAAAA,EAAAA,IAAC,OAAA,CAAK,UAAU,+CAA+C,SAAA,QAAK,EACpEA,EAAAA,IAAC,IAAA,CAAE,UAAU,gCAAiC,WAAK,cAAA,CAAe,CAAA,EACpE,SACC,MAAA,CACC,SAAA,CAAAA,EAAAA,IAAC,OAAA,CAAK,UAAU,+CAA+C,SAAA,QAAK,EACpEA,EAAAA,IAAC,IAAA,CAAE,UAAU,gCAAiC,WAAK,cAAA,CAAe,CAAA,EACpE,SACC,MAAA,CACC,SAAA,CAAAA,EAAAA,IAAC,OAAA,CAAK,UAAU,+CAA+C,SAAA,gBAAa,EAC5EA,EAAAA,IAAC,IAAA,CAAE,UAAU,gCAAiC,WAAK,YAAA,CAAa,CAAA,EAClE,SACC,MAAA,CACC,SAAA,CAAAA,EAAAA,IAAC,OAAA,CAAK,UAAU,+CAA+C,SAAA,WAAQ,EACvEA,EAAAA,IAAC,IAAA,CAAE,UAAU,gCAAiC,WAAK,kBAAA,CAAmB,CAAA,EACxE,SACC,MAAA,CACC,SAAA,CAAAA,EAAAA,IAAC,OAAA,CAAK,UAAU,+CAA+C,SAAA,eAAY,EAC3EA,EAAAA,IAAC,IAAA,CAAE,UAAU,gCAAiC,WAAK,eAAA,CAAgB,CAAA,CAAA,CACrE,CAAA,EACF,EAECZ,EAAK,qBACJW,EAAAA,KAAC,MAAA,CACC,SAAA,CAAAC,EAAAA,IAAC,OAAA,CAAK,UAAU,+CAA+C,SAAA,YAAS,EACxEA,EAAAA,IAAC,IAAA,CAAE,UAAU,qFACV,WAAK,mBAAA,CACR,CAAA,EACF,EAGDZ,EAAK,qBACJY,EAAAA,IAACE,EAAA,CACC,SAAAH,EAAAA,KAAC,IAAA,CACC,KAAM,4DAA4DX,EAAK,mBAAmB,GAC1F,OAAO,SACP,IAAI,sBACJ,UAAU,qLACX,SAAA,CAAA,sBACqBA,EAAK,oBAAoB,IAAA,CAAA,CAAA,CAC/C,CACF,CAAA,CAAA,CAEJ,CAAA,EACF,CAEJ"}