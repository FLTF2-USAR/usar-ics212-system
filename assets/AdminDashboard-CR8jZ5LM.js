import{r,j as e,u as ge}from"./index-DQ55tkwN.js";import{c as j,B as o,C as n,a as c,A as ie,f as ue}from"./config-C5T7sV41.js";import{T as M,a as S,g,C as ae,M as pe}from"./github-Db1Z7m6V.js";const be=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],je=j("arrow-left",be);const ye=[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]],B=j("brain",ye);const fe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],le=j("circle-alert",fe);const Ne=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],ve=j("lock",Ne);const we=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],W=j("mail",we);const ke=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],G=j("package",ke);const Ce=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Ae=j("refresh-cw",Ce);const Se=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],re=j("sparkles",Se);const _e=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],ne=j("trending-up",_e);const Ie=[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]],q=j("truck",Ie),Le=({adminPassword:C,onCriticalAlertCount:_})=>{const[d,u]=r.useState(null),[b,E]=r.useState(!1),[p,m]=r.useState(null),[y,U]=r.useState("week"),[I,$]=r.useState("all"),L=async()=>{if(!C){m("Admin authentication required");return}E(!0),m(null);try{const t=I==="all"?void 0:I,h=await g.getAIInsights(C,y,t);u(h);const F=h.insights.filter(A=>A.toLowerCase().includes("critical")||A.toLowerCase().includes("immediate")||A.toLowerCase().includes("urgent")).length;_&&_(F)}catch(t){console.error("Error loading AI insights:",t),m(t.message||"Failed to load AI insights")}finally{E(!1)}};r.useEffect(()=>{C&&L()},[y,I,C]);const R=(t,h)=>{const F=t.toLowerCase().includes("critical")||t.toLowerCase().includes("urgent"),A=t.toLowerCase().includes("warning")||t.toLowerCase().includes("attention"),P=t.toLowerCase().includes("good")||t.toLowerCase().includes("excellent")||t.toLowerCase().includes("optimal");let x="bg-blue-50",f="border-blue-200",N="text-blue-800",v=e.jsx(S,{className:"w-5 h-5 text-blue-600"});return F?(x="bg-red-50",f="border-red-200",N="text-red-800",v=e.jsx(M,{className:"w-5 h-5 text-red-600"})):A?(x="bg-yellow-50",f="border-yellow-200",N="text-yellow-800",v=e.jsx(M,{className:"w-5 h-5 text-yellow-600"})):P&&(x="bg-green-50",f="border-green-200",N="text-green-800",v=e.jsx(S,{className:"w-5 h-5 text-green-600"})),e.jsxs("div",{className:`flex items-start gap-3 p-4 ${x} rounded-lg border ${f}`,children:[v,e.jsx("p",{className:`text-sm font-medium ${N} flex-1`,children:t})]},h)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(B,{className:"w-7 h-7 text-blue-600"}),"Fleet Insights - AI Analysis"]}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1 flex items-center gap-2",children:[e.jsx(re,{className:"w-4 h-4 text-purple-600"}),"Powered by Cloudflare Workers AI (Llama 3 8B)"]})]}),e.jsxs(o,{onClick:L,disabled:b,variant:"secondary",className:"flex items-center gap-2",children:[e.jsx(Ae,{className:`w-4 h-4 ${b?"animate-spin":""}`}),"Refresh Analysis"]})]}),e.jsx(n,{children:e.jsxs(c,{className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Analysis Timeframe"}),e.jsx("div",{className:"flex gap-2",children:[{value:"week",label:"Last Week"},{value:"month",label:"Last Month"},{value:"all",label:"All Time"}].map(({value:t,label:h})=>e.jsx("button",{onClick:()=>U(t),className:`flex-1 px-4 py-2 rounded-lg font-medium transition-all ${y===t?"bg-blue-600 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:h},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Filter by Apparatus"}),e.jsxs("select",{value:I,onChange:t=>$(t.target.value),className:"w-full px-4 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",children:[e.jsx("option",{value:"all",children:"All Apparatus"}),ie.map(t=>e.jsx("option",{value:t,children:t},t))]})]})]}),e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:e.jsxs(o,{onClick:L,disabled:b,className:"w-full md:w-auto flex items-center gap-2",children:[e.jsx(B,{className:"w-5 h-5"}),b?"Analyzing Fleet...":"Analyze Fleet"]})})]})}),b&&e.jsx(n,{children:e.jsx(c,{className:"py-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full mb-4 animate-pulse",children:e.jsx(re,{className:"w-8 h-8 text-white"})}),e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:"AI Analysis in Progress"}),e.jsx("p",{className:"text-gray-600",children:"Analyzing inspection data and generating insights..."}),e.jsx("div",{className:"mt-4 w-48 h-2 bg-gray-200 rounded-full mx-auto overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-blue-500 to-purple-600 animate-pulse"})})]})})}),p&&!b&&e.jsx(n,{className:"border-red-300",children:e.jsx(c,{className:"p-6",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(M,{className:"w-6 h-6 text-red-600 flex-shrink-0 mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-bold text-red-900 mb-2",children:"Analysis Unavailable"}),e.jsx("p",{className:"text-red-700 text-sm mb-4",children:p}),p.includes("503")||p.includes("enabled")?e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 text-sm text-red-800",children:[e.jsx("p",{className:"font-semibold mb-2",children:"AI service is temporarily unavailable."}),e.jsx("p",{children:"This could be due to:"}),e.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[e.jsx("li",{children:"Cloudflare Workers AI service maintenance"}),e.jsx("li",{children:"AI features not configured in the worker"}),e.jsx("li",{children:"Network connectivity issues"})]}),e.jsx("p",{className:"mt-3 font-medium",children:"You can still view raw data in other dashboard tabs."})]}):e.jsx(o,{onClick:L,variant:"secondary",children:"Try Again"})]})]})})}),!d&&!b&&!p&&e.jsx(n,{children:e.jsxs(c,{className:"py-12 text-center",children:[e.jsx(B,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:"No Analysis Data"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"No inspection data available for this timeframe."}),e.jsx("p",{className:"text-sm text-gray-500",children:"Try expanding the timeframe or checking other apparatus."})]})}),d&&!b&&e.jsxs("div",{className:"space-y-6",children:[e.jsx(n,{className:"border-blue-300 bg-gradient-to-br from-blue-50 to-purple-50",children:e.jsx(c,{className:"p-6",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"bg-gradient-to-br from-blue-600 to-purple-600 p-3 rounded-full",children:e.jsx(ne,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Analysis Summary"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Data Points"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:d.dataPoints})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Timeframe"}),e.jsx("p",{className:"text-lg font-semibold text-gray-900 capitalize",children:d.timeframe})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Apparatus"}),e.jsx("p",{className:"text-lg font-semibold text-gray-900",children:d.apparatus||"All"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Insights Found"}),e.jsx("p",{className:"text-2xl font-bold text-purple-600",children:d.insights.length})]})]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Generated at: ",new Date(d.generatedAt).toLocaleString()]})]})]})})}),e.jsx(n,{children:e.jsxs(c,{className:"p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(M,{className:"w-5 h-5 text-orange-600"}),"AI-Generated Insights"]}),d.insights.length>0?e.jsx("div",{className:"space-y-3",children:d.insights.map((t,h)=>R(t,h))}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(S,{className:"w-12 h-12 text-green-600 mx-auto mb-4"}),e.jsx("p",{className:"text-lg font-semibold text-gray-900",children:"Fleet Operating Optimally"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"AI analysis found no issues or recommendations at this time."})]})]})}),e.jsx(n,{children:e.jsxs(c,{className:"p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(G,{className:"w-5 h-5 text-green-600"}),"Fleet Health Score"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Overall Fleet Health"}),e.jsxs("span",{className:`text-lg font-bold ${d.dataPoints>0?"text-green-600":"text-gray-500"}`,children:[d.dataPoints>0?Math.max(70,100-d.insights.length*5):0,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:e.jsx("div",{className:"h-3 rounded-full bg-gradient-to-r from-green-500 to-emerald-600 transition-all duration-500",style:{width:`${d.dataPoints>0?Math.max(70,100-d.insights.length*5):0}%`}})})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 pt-4 border-t border-gray-200",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Critical"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:d.insights.filter(t=>t.toLowerCase().includes("critical")).length})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Warnings"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:d.insights.filter(t=>t.toLowerCase().includes("warning")).length})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Recommendations"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:d.insights.filter(t=>!t.toLowerCase().includes("critical")&&!t.toLowerCase().includes("warning")).length})]})]})]})]})})]})]})},$e=()=>{const C=ge(),[_,d]=r.useState(!1),[u,b]=r.useState(""),[E,p]=r.useState(""),[m,y]=r.useState("fleet"),[U,I]=r.useState(new Map),[$,L]=r.useState([]),[R,t]=r.useState(null),[h,F]=r.useState([]),[A,P]=r.useState(!1),[x,f]=r.useState(null),[N,v]=r.useState(""),[H,K]=r.useState(!1),[ce,Y]=r.useState(!1),[a,D]=r.useState(null),[de,J]=r.useState(!1),[T,Q]=r.useState(!1),[X,z]=r.useState(null),[Z,ee]=r.useState(0),se=async()=>{if(!u.trim()){p("Please enter a password");return}g.setAdminPassword(u);try{await O(),d(!0),p("")}catch(s){console.error("Authentication failed:",s),s instanceof Error&&s.message.includes("Unauthorized")?p("Incorrect password. Please try again."):s instanceof Error&&s.message.includes("Failed to fetch")?p("Network error. Please check your connection and try again."):p("Authentication failed. Please try again."),g.clearAdminPassword()}},O=async()=>{try{P(!0);const s=await g.getAllDefects(),l=g.computeFleetStatus(s);I(l),L(s);try{const i=await g.getDailySubmissions();t(i)}catch(i){console.error("Error fetching daily submissions:",i)}try{const i=await g.analyzeLowStockItems();F(i)}catch(i){console.error("Error analyzing low stock:",i)}}catch(s){throw console.error("Error loading dashboard data:",s),s instanceof Error&&s.message.includes("Unauthorized")&&(d(!1),g.clearAdminPassword()),s}finally{P(!1)}},oe=async()=>{if(!x||!N.trim()){alert("Please enter resolution notes");return}if(!x.issueNumber){alert("Unable to resolve: Issue number not found");return}K(!0);try{await g.resolveDefect(x.issueNumber,N,"Admin"),await O(),f(null),v(""),Y(!0),setTimeout(()=>Y(!1),3e3)}catch(s){console.error("Error resolving defect:",s),s instanceof Error&&s.message.includes("Unauthorized")?(alert("Session expired. Please re-enter the admin password."),d(!1),g.clearAdminPassword()):alert("Error resolving defect. Please try again.")}finally{K(!1)}},te=async()=>{if(u){J(!0),z(null);try{const s=await g.getEmailConfig(u);D(s)}catch(s){z(s instanceof Error?s.message:"Failed to load email configuration")}finally{J(!1)}}},w=async s=>{if(!(!u||!a)){Q(!0),z(null);try{const l=await g.updateEmailConfig(u,s);D(l.config),alert("Email configuration updated successfully")}catch(l){z(l instanceof Error?l.message:"Failed to update email configuration")}finally{Q(!1)}}},me=async()=>{if(u&&confirm("Send a test daily digest email now?"))try{await g.sendManualDigest(u),alert("Test digest sent successfully! Check your email.")}catch(s){alert("Failed to send test digest: "+(s instanceof Error?s.message:"Unknown error"))}};if(r.useEffect(()=>{if(!_)return;const s=setInterval(()=>{O().catch(console.error)},12e4);return()=>clearInterval(s)},[_]),!_)return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-gray-100 flex items-center justify-center p-4",children:e.jsx(n,{className:"max-w-md w-full",children:e.jsxs(c,{className:"py-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-blue-600 rounded-2xl mb-4",children:e.jsx(ve,{className:"w-8 h-8 text-white"})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Admin Access Required"}),e.jsx("p",{className:"text-gray-600",children:"Enter the admin password to continue"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-semibold text-gray-700 mb-2",children:"Password"}),e.jsx("input",{id:"password",type:"password",value:u,onChange:s=>{b(s.target.value),p("")},onKeyDown:s=>{s.key==="Enter"&&se()},placeholder:"Enter admin password",className:"w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition-all",autoFocus:!0}),E&&e.jsx("p",{className:"text-red-600 text-sm mt-2",children:E})]}),e.jsx(o,{onClick:se,className:"w-full",size:"lg",children:"Access Admin Dashboard"}),e.jsx("div",{className:"text-center mt-4",children:e.jsx("button",{onClick:()=>C("/"),className:"text-sm text-gray-600 hover:text-gray-900 font-medium",children:"← Back to Login"})})]})]})})});if(A)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading dashboard..."})]})});const V=ie,xe=new Date().toLocaleDateString("en-US");return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[ce&&e.jsxs("div",{className:"fixed bottom-4 right-4 bg-green-600 text-white px-6 py-3 rounded-lg shadow-lg z-50 flex items-center gap-2",children:[e.jsx(S,{className:"w-5 h-5"}),e.jsx("span",{className:"font-semibold",children:"Defect resolved successfully!"})]}),e.jsx("div",{className:"bg-white border-b border-gray-200",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Admin Dashboard"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"MBFD Fleet Management System"})]}),e.jsxs(o,{onClick:()=>C("/"),variant:"secondary",className:"flex items-center gap-2",children:[e.jsx(je,{className:"w-5 h-5"}),"Back to Login"]})]}),e.jsxs("div",{className:"flex gap-2 border-b border-gray-200",children:[e.jsxs("button",{onClick:()=>y("fleet"),className:`px-6 py-3 font-semibold transition-all flex items-center gap-2 ${m==="fleet"?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-900"}`,children:[e.jsx(q,{className:"w-5 h-5"}),"Fleet Status"]}),e.jsxs("button",{onClick:()=>y("activity"),className:`px-6 py-3 font-semibold transition-all flex items-center gap-2 ${m==="activity"?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-900"}`,children:[e.jsx(ae,{className:"w-5 h-5"}),"Daily Activity"]}),e.jsxs("button",{onClick:()=>y("supplies"),className:`px-6 py-3 font-semibold transition-all flex items-center gap-2 ${m==="supplies"?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-900"}`,children:[e.jsx(G,{className:"w-5 h-5"}),"Supply Alerts",h.length>0&&e.jsx("span",{className:"bg-red-500 text-white text-xs px-2 py-0.5 rounded-full",children:h.length})]}),e.jsxs("button",{onClick:()=>{y("notifications"),a||te()},className:`px-6 py-3 font-semibold transition-all flex items-center gap-2 ${m==="notifications"?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-900"}`,children:[e.jsx(W,{className:"w-5 h-5"}),"Notifications"]}),e.jsxs("button",{onClick:()=>{y("insights"),ee(0)},className:`px-6 py-3 font-semibold transition-all flex items-center gap-2 relative ${m==="insights"?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-900"}`,children:[e.jsx(B,{className:"w-5 h-5"}),"Fleet Insights",Z>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs w-5 h-5 rounded-full flex items-center justify-center font-bold",children:Z})]})]})]})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[m==="fleet"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Fleet Status"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4",children:V.map(s=>{const l=U.get(s)||0,i=l===0;return e.jsx(n,{className:i?"border-green-500":"border-red-500",children:e.jsxs(c,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx(q,{className:`w-8 h-8 ${i?"text-green-500":"text-red-500"}`}),i?e.jsx(S,{className:"w-6 h-6 text-green-500"}):e.jsx(le,{className:"w-6 h-6 text-red-500"})]}),e.jsx("h3",{className:"font-bold text-gray-900 mb-1",children:s}),e.jsx("p",{className:`text-sm font-semibold ${i?"text-green-600":"text-red-600"}`,children:i?"✓ All Clear":`${l} Defect${l!==1?"s":""}`})]})},s)})})]}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:["Open Defects (",$.length,")"]}),$.length===0?e.jsx(n,{children:e.jsxs(c,{className:"py-12 text-center",children:[e.jsx(S,{className:"w-12 h-12 text-green-500 mx-auto mb-4"}),e.jsx("p",{className:"text-lg font-semibold text-gray-900",children:"No Open Defects"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"All apparatus are fully operational"})]})}):e.jsx("div",{className:"space-y-3",children:$.map(s=>e.jsx(n,{className:"hover:shadow-md transition-shadow",children:e.jsx(c,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2 flex-wrap",children:[e.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm font-semibold",children:s.apparatus}),e.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-semibold ${s.status==="missing"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:s.status==="missing"?"❌ Missing":"⚠️ Damaged"})]}),e.jsxs("h3",{className:"text-lg font-bold text-gray-900 mb-1",children:[s.compartment,": ",s.item]}),e.jsxs("p",{className:"text-gray-600 text-sm mb-2",children:["Reported by ",s.reportedBy," on ",ue(s.reportedAt)]}),s.notes&&e.jsx("p",{className:"text-gray-700 text-sm bg-gray-50 p-3 rounded-lg",children:s.notes.split(`
`).slice(0,3).join(`
`)})]}),e.jsx(o,{onClick:()=>f(s),variant:"primary",size:"sm",className:"mt-3 md:mt-0 md:ml-4",children:"Resolve"})]})})},`${s.apparatus}-${s.item}`))})]})]}),m==="activity"&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(ae,{className:"w-6 h-6"}),"Daily Activity - ",xe]}),e.jsx(n,{className:"mb-6",children:e.jsxs(c,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Today's Submissions"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4",children:V.map(s=>{const l=R?.today.includes(s)||!1;return e.jsxs("div",{className:`p-4 rounded-lg border-2 ${l?"bg-green-50 border-green-500":"bg-gray-50 border-gray-300"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(q,{className:`w-6 h-6 ${l?"text-green-600":"text-gray-400"}`}),l?e.jsx(S,{className:"w-5 h-5 text-green-600"}):e.jsx(le,{className:"w-5 h-5 text-gray-400"})]}),e.jsx("p",{className:"font-bold text-gray-900",children:s}),e.jsx("p",{className:`text-sm font-semibold ${l?"text-green-600":"text-gray-500"}`,children:l?"✓ Submitted":"Pending"})]},s)})})]})}),e.jsx(n,{children:e.jsxs(c,{className:"p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(ne,{className:"w-5 h-5"}),"Submission Statistics (Last 30 Days)"]}),e.jsx("div",{className:"space-y-3",children:V.map(s=>{const l=R?.totals.get(s)||0,i=R?.lastSubmission.get(s),k=Math.round(l/30*100);return e.jsxs("div",{className:"border-b border-gray-200 pb-3 last:border-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(q,{className:"w-5 h-5 text-blue-600"}),e.jsx("span",{className:"font-semibold text-gray-900",children:s})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"text-2xl font-bold text-blue-600",children:l}),e.jsx("span",{className:"text-sm text-gray-600 ml-1",children:"submissions"})]})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[e.jsxs("span",{children:[k,"% compliance rate"]}),i&&e.jsxs("span",{children:["Last: ",i]})]}),e.jsx("div",{className:"mt-2 w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full ${k>=80?"bg-green-500":k>=50?"bg-yellow-500":"bg-red-500"}`,style:{width:`${Math.min(k,100)}%`}})})]},s)})})]})})]})}),m==="supplies"&&e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(M,{className:"w-6 h-6 text-orange-600"}),"Supply Alerts"]}),h.length===0?e.jsx(n,{children:e.jsxs(c,{className:"py-12 text-center",children:[e.jsx(G,{className:"w-12 h-12 text-green-500 mx-auto mb-4"}),e.jsx("p",{className:"text-lg font-semibold text-gray-900",children:"No Supply Concerns"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"All items are adequately stocked"})]})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-orange-50 border-l-4 border-orange-500 p-4 rounded",children:e.jsxs("p",{className:"text-sm text-orange-800",children:[e.jsx("strong",{children:"Note:"})," Items listed below have been reported missing multiple times across different apparatus in the last 30 days. This may indicate a supply shortage requiring attention."]})}),h.map((s,l)=>e.jsx(n,{className:"border-orange-300",children:e.jsx(c,{className:"p-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(M,{className:"w-6 h-6 text-orange-600"}),e.jsxs("h3",{className:"text-lg font-bold text-gray-900",children:[s.compartment,": ",s.item]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{className:"text-sm text-gray-700",children:[e.jsxs("strong",{children:["Reported missing ",s.occurrences," time",s.occurrences!==1?"s":""]})," in the last 30 days"]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Affected apparatus:"}),s.apparatus.map(i=>e.jsx("span",{className:"px-2 py-1 bg-orange-100 text-orange-800 rounded text-xs font-semibold",children:i},i))]})]})]}),e.jsx("div",{className:"ml-4",children:e.jsx("span",{className:"inline-flex items-center justify-center w-12 h-12 bg-orange-100 rounded-full",children:e.jsx("span",{className:"text-xl font-bold text-orange-600",children:s.occurrences})})})]})})},l))]})]}),m==="insights"&&e.jsx(e.Fragment,{children:e.jsx(Le,{adminPassword:u,onCriticalAlertCount:ee})}),m==="notifications"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Email Notifications"}),e.jsxs(o,{onClick:me,variant:"secondary",className:"flex items-center gap-2",children:[e.jsx(W,{className:"w-5 h-5"}),"Send Test Digest"]})]}),X&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:X}),de?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading configuration..."})]}):a?e.jsxs("div",{className:"space-y-6",children:[e.jsx(n,{children:e.jsx(c,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Email Notifications"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:a.enabled?"Notifications are currently enabled":"Notifications are currently disabled"})]}),e.jsx(o,{onClick:()=>w({enabled:!a.enabled}),className:a.enabled?"bg-red-600 hover:bg-red-700":"bg-green-600 hover:bg-green-700",disabled:T,children:a.enabled?"Disable":"Enable"})]})})}),e.jsx(n,{children:e.jsxs(c,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Email Mode"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-start gap-3 p-3 border-2 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors",children:[e.jsx("input",{type:"radio",name:"email_mode",value:"daily_digest",checked:a.email_mode==="daily_digest",onChange:s=>w({email_mode:s.target.value}),className:"mt-1 w-5 h-5 text-blue-600"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Daily Digest (Recommended)"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Send one summary email per day at ",a.digest_send_time]})]})]}),e.jsxs("label",{className:"flex items-start gap-3 p-3 border-2 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors",children:[e.jsx("input",{type:"radio",name:"email_mode",value:"per_submission",checked:a.email_mode==="per_submission",onChange:s=>w({email_mode:s.target.value}),className:"mt-1 w-5 h-5 text-blue-600"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Per Submission"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Send an email immediately after each inspection"})]})]}),e.jsxs("label",{className:"flex items-start gap-3 p-3 border-2 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors",children:[e.jsx("input",{type:"radio",name:"email_mode",value:"hybrid",checked:a.email_mode==="hybrid",onChange:s=>w({email_mode:s.target.value}),className:"mt-1 w-5 h-5 text-blue-600"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Hybrid"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Immediate for critical defects, daily digest for routine"})]})]})]})]})}),e.jsx(n,{children:e.jsxs(c,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Email Recipients"}),e.jsxs("div",{className:"space-y-3",children:[a.recipients.map((s,l)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"email",value:s,onChange:i=>{const k=[...a.recipients];k[l]=i.target.value,D({...a,recipients:k})},className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"email@example.com"}),e.jsx(o,{onClick:()=>{const i=a.recipients.filter((k,he)=>he!==l);w({recipients:i})},variant:"secondary",className:"bg-red-50 hover:bg-red-100 text-red-700",children:"Remove"})]},l)),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(o,{onClick:()=>{const s=[...a.recipients,""];D({...a,recipients:s})},variant:"secondary",children:"+ Add Recipient"}),e.jsx(o,{onClick:()=>w({recipients:a.recipients.filter(s=>s!=="")}),disabled:T,children:"Save Recipients"})]})]})]})}),e.jsx(n,{children:e.jsx(c,{className:"p-6",children:e.jsxs("label",{className:"flex items-start gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:a.enable_immediate_for_critical,onChange:s=>w({enable_immediate_for_critical:s.target.checked}),className:"mt-1 w-5 h-5 text-blue-600 rounded"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-gray-900",children:"Immediate Alerts for Critical Defects"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Send immediate email when critical defects are found (only in hybrid mode)"})]})]})})}),e.jsx(n,{children:e.jsxs(c,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Daily Email Limit"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("input",{type:"number",value:a.daily_email_hard_cap,onChange:s=>D({...a,daily_email_hard_cap:parseInt(s.target.value)||250}),className:"w-32 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",min:"1",max:"500"}),e.jsx("span",{className:"text-gray-600",children:"emails per day (max: 500)"}),e.jsx(o,{onClick:()=>w({daily_email_hard_cap:a.daily_email_hard_cap}),disabled:T,children:"Save"})]}),e.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:["Current: ",a.daily_email_hard_cap," / Recommended: 250"]})]})}),e.jsx(n,{children:e.jsxs(c,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Email Subject Template"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("input",{type:"text",value:a.email_subject_template,onChange:s=>D({...a,email_subject_template:s.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"MBFD Daily Inspection Summary - {date}"}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Use ","{date}"," for the current date"]}),e.jsx(o,{onClick:()=>w({email_subject_template:a.email_subject_template}),disabled:T,children:"Save Template"})]})]})})]}):e.jsx(n,{children:e.jsxs(c,{className:"py-12 text-center",children:[e.jsx(W,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Click the button below to load email configuration"}),e.jsx(o,{onClick:te,children:"Load Configuration"})]})})]})]}),e.jsx(pe,{isOpen:!!x,onClose:()=>{f(null),v("")},title:"Resolve Defect",children:x&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Apparatus"}),e.jsx("p",{className:"font-semibold text-gray-900",children:x.apparatus}),e.jsx("p",{className:"text-sm text-gray-600 mt-3 mb-1",children:"Item"}),e.jsxs("p",{className:"font-semibold text-gray-900",children:[x.compartment,": ",x.item]}),e.jsx("p",{className:"text-sm text-gray-600 mt-3 mb-1",children:"Status"}),e.jsx("p",{className:"font-semibold text-gray-900",children:x.status==="missing"?"Missing":"Damaged"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Resolution Notes"}),e.jsx("textarea",{value:N,onChange:s=>v(s.target.value),placeholder:"Describe how this was resolved (e.g., 'Replaced with spare', 'Item found and returned', 'Repaired by maintenance')",rows:4,className:"w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition-all resize-none"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(o,{onClick:oe,disabled:H||!N.trim(),className:"flex-1",children:H?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),"Resolving..."]}):"Mark as Resolved"}),e.jsx(o,{onClick:()=>{f(null),v("")},variant:"secondary",className:"flex-1",disabled:H,children:"Cancel"})]})]})})]})};export{$e as AdminDashboard};
//# sourceMappingURL=AdminDashboard-CR8jZ5LM.js.map
