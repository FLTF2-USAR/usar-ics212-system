{"version":3,"file":"FormDetail-ZE7AheSf.js","sources":["../../src/components/admin/FormDetail.tsx"],"sourcesContent":["/**\r\n * Form Detail Component\r\n * \r\n * Displays complete ICS-212 form information with PDF preview\r\n * Features:\r\n * - PDF preview in iframe\r\n * - Complete form metadata\r\n * - Download PDF button\r\n * - Email distribution button\r\n * - Vehicle history timeline\r\n */\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport { API_BASE_URL } from '../../lib/config';\r\nimport { TouchFeedback } from '../mobile/TouchFeedback';\r\nimport { showToast } from '../mobile/Toast';\r\n\r\ninterface FormDetailProps {\r\n  formId: string;\r\n}\r\n\r\nexport function FormDetail({ formId }: FormDetailProps) {\r\n  const [loading, setLoading] = useState(true);\r\n  const [form, setForm] = useState<any>(null);\r\n\r\n  useEffect(() => {\r\n    fetchFormDetail();\r\n  }, [formId]);\r\n\r\n  const fetchFormDetail = async () => {\r\n    try {\r\n      const response = await fetch(`${API_BASE_URL}/ics212/forms/${formId}`);\r\n      if (!response.ok) throw new Error('Failed to fetch form');\r\n      const data = await response.json();\r\n      setForm(data.form);\r\n    } catch (error) {\r\n      console.error('Error fetching form detail:', error);\r\n      showToast({ message: 'Failed to load form details', type: 'error' });\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleDownloadPDF = () => {\r\n    const downloadUrl = `${API_BASE_URL}/ics212/pdf?formId=${formId}`;\r\n    window.open(downloadUrl, '_blank');\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"p-4 space-y-4\">\r\n        <div className=\"animate-pulse space-y-3\">\r\n          <div className=\"h-4 bg-gray-200 dark:bg-gray-700 rounded w-3/4\"></div>\r\n          <div className=\"h-32 bg-gray-200 dark:bg-gray-700 rounded\"></div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!form) {\r\n    return (\r\n      <div className=\"p-4 text-center\">\r\n        <p className=\"text-red-500\">Form not found</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Construct PDF preview URL from form ID\r\n  const pdfPreviewUrl = form.pdf_url ? `${API_BASE_URL}/ics212/pdf/preview?formId=${formId}` : null;\r\n\r\n  return (\r\n    <div className=\"space-y-4 max-h-[80vh] overflow-y-auto\">\r\n      {/* Header */}\r\n      <div className=\"sticky top-0 bg-white dark:bg-gray-800 p-4 border-b border-gray-200 dark:border-gray-700\">\r\n        <h3 className=\"font-bold text-xl text-gray-900 dark:text-white\">\r\n          {form.vehicle_id_no}\r\n        </h3>\r\n        <p className=\"text-sm text-gray-600 dark:text-gray-400\">{form.incident_name}</p>\r\n        <div className=\"mt-2\">\r\n          <span className={`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${\r\n            form.release_decision === 'hold' \r\n              ? 'bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200'\r\n              : 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200'\r\n          }`}>\r\n            {form.release_decision === 'hold' ? 'üî¥ HOLD' : 'üü¢ RELEASED'}\r\n          </span>\r\n        </div>\r\n      </div>\r\n\r\n      {/* PDF Preview */}\r\n      {pdfPreviewUrl ? (\r\n        <div className=\"px-4\">\r\n          <div className=\"border border-gray-300 dark:border-gray-600 rounded-lg overflow-hidden bg-gray-100 dark:bg-gray-900\">\r\n            <iframe\r\n              src={pdfPreviewUrl}\r\n              className=\"w-full\"\r\n              style={{ height: '400px' }}\r\n              title=\"PDF Preview\"\r\n            />\r\n          </div>\r\n          <TouchFeedback>\r\n            <button\r\n              onClick={handleDownloadPDF}\r\n              className=\"w-full mt-2 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-colors\"\r\n            >\r\n              üì• Download PDF\r\n            </button>\r\n          </TouchFeedback>\r\n        </div>\r\n      ) : (\r\n        <div className=\"px-4\">\r\n          <div className=\"border border-yellow-300 dark:border-yellow-600 rounded-lg p-4 bg-yellow-50 dark:bg-yellow-900/20\">\r\n            <p className=\"text-yellow-800 dark:text-yellow-200 text-sm\">\r\n              ‚ö†Ô∏è PDF not available. It may still be generating or there was an error during submission.\r\n            </p>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Form Details */}\r\n      <div className=\"px-4 space-y-3\">\r\n        <h4 className=\"font-semibold text-gray-900 dark:text-white\">Inspection Details</h4>\r\n        \r\n        <div className=\"grid grid-cols-2 gap-3 text-sm\">\r\n          <div>\r\n            <span className=\"font-medium text-gray-700 dark:text-gray-300\">Inspector:</span>\r\n            <p className=\"text-gray-900 dark:text-white\">{form.inspector_name_print}</p>\r\n          </div>\r\n          <div>\r\n            <span className=\"font-medium text-gray-700 dark:text-gray-300\">Date:</span>\r\n            <p className=\"text-gray-900 dark:text-white\">{form.inspector_date}</p>\r\n          </div>\r\n          <div>\r\n            <span className=\"font-medium text-gray-700 dark:text-gray-300\">Time:</span>\r\n            <p className=\"text-gray-900 dark:text-white\">{form.inspector_time}</p>\r\n          </div>\r\n          <div>\r\n            <span className=\"font-medium text-gray-700 dark:text-gray-300\">Vehicle Type:</span>\r\n            <p className=\"text-gray-900 dark:text-white\">{form.vehicle_type}</p>\r\n          </div>\r\n          <div>\r\n            <span className=\"font-medium text-gray-700 dark:text-gray-300\">License:</span>\r\n            <p className=\"text-gray-900 dark:text-white\">{form.vehicle_license_no}</p>\r\n          </div>\r\n          <div>\r\n            <span className=\"font-medium text-gray-700 dark:text-gray-300\">Agency/Unit:</span>\r\n            <p className=\"text-gray-900 dark:text-white\">{form.agency_reg_unit}</p>\r\n          </div>\r\n        </div>\r\n\r\n        {form.additional_comments && (\r\n          <div>\r\n            <span className=\"font-medium text-gray-700 dark:text-gray-300\">Comments:</span>\r\n            <p className=\"text-sm text-gray-900 dark:text-white mt-1 p-2 bg-gray-50 dark:bg-gray-700 rounded\">\r\n              {form.additional_comments}\r\n            </p>\r\n          </div>\r\n        )}\r\n\r\n        {form.github_issue_number && (\r\n          <TouchFeedback>\r\n            <a\r\n              href={`https://github.com/pdarleyjr/mbfd-checkout-system/issues/${form.github_issue_number}`}\r\n              target=\"_blank\"\r\n              rel=\"noopener noreferrer\"\r\n              className=\"block w-full py-2 px-4 bg-gray-100 dark:bg-gray-700 text-blue-600 dark:text-blue-400 rounded-lg text-center font-medium hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors\"\r\n            >\r\n              View GitHub Issue #{form.github_issue_number} ‚Üí\r\n            </a>\r\n          </TouchFeedback>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":["FormDetail","formId","loading","setLoading","useState","form","setForm","useEffect","fetchFormDetail","response","API_BASE_URL","data","error","showToast","handleDownloadPDF","downloadUrl","jsxs","jsx","pdfPreviewUrl","TouchFeedback"],"mappings":"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"}