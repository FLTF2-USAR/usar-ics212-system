{"version":3,"file":"ICS218Form-DP9anysA.js","sources":["../../src/components/ics218/IncidentInfoStep.tsx","../../src/components/VehicleAutocomplete.tsx","../../src/components/ics218/VehicleTableStep.tsx","../../src/components/ics218/PreparedByStep.tsx","../../src/components/ics218/ReviewStep.tsx","../../src/components/ics218/ICS218Form.tsx"],"sourcesContent":["import React from 'react';\r\nimport { motion } from 'framer-motion';\r\nimport TouchFeedback from '../mobile/TouchFeedback';\r\nimport type { ICS218FormData } from '../../types';\r\n\r\ninterface IncidentInfoStepProps {\r\n  formData: Partial<ICS218FormData>;\r\n  onChange: (field: keyof ICS218FormData, value: any) => void;\r\n  onNext: () => void;\r\n  errors: Record<string, string>;\r\n}\r\n\r\nconst VEHICLE_CATEGORIES = [\r\n  'Buses',\r\n  'Generators',\r\n  'Dozers',\r\n  'Pickups/Sedans',\r\n  'Rental Cars',\r\n  'Heavy Equipment',\r\n  'Emergency Vehicles',\r\n  'Support Vehicles',\r\n  'Other',\r\n];\r\n\r\nexport const IncidentInfoStep: React.FC<IncidentInfoStepProps> = ({\r\n  formData,\r\n  onChange,\r\n  onNext,\r\n  errors,\r\n}) => {\r\n  const handleSubmit = (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    onNext();\r\n  };\r\n\r\n  const getCurrentDate = () => {\r\n    return new Date().toISOString().split('T')[0]; // YYYY-MM-DD\r\n  };\r\n\r\n  const getCurrentTime = () => {\r\n    const now = new Date();\r\n    const hours = String(now.getHours()).padStart(2, '0');\r\n    const minutes = String(now.getMinutes()).padStart(2, '0');\r\n    return `${hours}:${minutes}`; // HH:MM\r\n  };\r\n\r\n  return (\r\n    <motion.form\r\n      className=\"space-y-6 p-4 md:p-6\"\r\n      onSubmit={handleSubmit}\r\n      initial={{ opacity: 0, x: 20 }}\r\n      animate={{ opacity: 1, x: 0 }}\r\n      exit={{ opacity: 0, x: -20 }}\r\n      transition={{ duration: 0.3 }}\r\n    >\r\n      <div>\r\n        <h2 className=\"text-2xl font-bold text-gray-900 dark:text-white mb-2\">\r\n          Incident Information\r\n        </h2>\r\n        <p className=\"text-sm text-gray-600 dark:text-gray-400\">\r\n          Basic incident details for vehicle inventory\r\n        </p>\r\n      </div>\r\n\r\n      {/* Incident Name */}\r\n      <div>\r\n        <label\r\n          htmlFor=\"incidentName\"\r\n          className=\"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2\"\r\n        >\r\n          Incident Name *\r\n        </label>\r\n        <input\r\n          type=\"text\"\r\n          id=\"incidentName\"\r\n          value={formData.incidentName || ''}\r\n          onChange={(e) => onChange('incidentName', e.target.value)}\r\n          placeholder=\"e.g., Wildfire Response 2024\"\r\n          maxLength={100}\r\n          className={`\r\n            w-full px-4 py-3 text-base rounded-xl border-2 transition-all\r\n            focus:outline-none focus:ring-4\r\n            ${errors.incidentName \r\n              ? 'border-red-500 focus:border-red-500 focus:ring-red-100' \r\n              : 'border-gray-300 focus:border-orange-500 focus:ring-orange-100'\r\n            }\r\n          `}\r\n          style={{ minHeight: '56px' }}\r\n        />\r\n        {errors.incidentName && (\r\n          <p className=\"mt-1 text-sm text-red-600\">{errors.incidentName}</p>\r\n        )}\r\n      </div>\r\n\r\n      {/* Incident Number */}\r\n      <div>\r\n        <label\r\n          htmlFor=\"incidentNumber\"\r\n          className=\"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2\"\r\n        >\r\n          Incident Number *\r\n        </label>\r\n        <input\r\n          type=\"text\"\r\n          id=\"incidentNumber\"\r\n          value={formData.incidentNumber || ''}\r\n          onChange={(e) => onChange('incidentNumber', e.target.value)}\r\n          placeholder=\"e.g., INC-2024-00123\"\r\n          maxLength={50}\r\n          className={`\r\n            w-full px-4 py-3 text-base rounded-xl border-2 transition-all\r\n            focus:outline-none focus:ring-4\r\n            ${errors.incidentNumber \r\n              ? 'border-red-500 focus:border-red-500 focus:ring-red-100' \r\n              : 'border-gray-300 focus:border-orange-500 focus:ring-orange-100'\r\n            }\r\n          `}\r\n          style={{ minHeight: '56px' }}\r\n        />\r\n        {errors.incidentNumber && (\r\n          <p className=\"mt-1 text-sm text-red-600\">{errors.incidentNumber}</p>\r\n        )}\r\n      </div>\r\n\r\n      {/* Date/Time Prepared Row */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n        <div>\r\n          <label\r\n            htmlFor=\"datePrepared\"\r\n            className=\"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2\"\r\n          >\r\n            Date Prepared *\r\n          </label>\r\n          <input\r\n            type=\"date\"\r\n            id=\"datePrepared\"\r\n            value={formData.datePrepared || getCurrentDate()}\r\n            onChange={(e) => onChange('datePrepared', e.target.value)}\r\n            max={getCurrentDate()}\r\n            className={`\r\n              w-full px-4 py-3 text-base rounded-xl border-2 transition-all\r\n              focus:outline-none focus:ring-4\r\n              ${errors.datePrepared \r\n                ? 'border-red-500 focus:border-red-500 focus:ring-red-100' \r\n                : 'border-gray-300 focus:border-orange-500 focus:ring-orange-100'\r\n              }\r\n            `}\r\n            style={{ minHeight: '56px' }}\r\n          />\r\n          {errors.datePrepared && (\r\n            <p className=\"mt-1 text-sm text-red-600\">{errors.datePrepared}</p>\r\n          )}\r\n        </div>\r\n\r\n        <div>\r\n          <label\r\n            htmlFor=\"timePrepared\"\r\n            className=\"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2\"\r\n          >\r\n            Time Prepared *\r\n          </label>\r\n          <input\r\n            type=\"time\"\r\n            id=\"timePrepared\"\r\n            value={formData.timePrepared || getCurrentTime()}\r\n            onChange={(e) => onChange('timePrepared', e.target.value)}\r\n            className={`\r\n              w-full px-4 py-3 text-base rounded-xl border-2 transition-all\r\n              focus:outline-none focus:ring-4\r\n              ${errors.timePrepared \r\n                ? 'border-red-500 focus:border-red-500 focus:ring-red-100' \r\n                : 'border-gray-300 focus:border-orange-500 focus:ring-orange-100'\r\n              }\r\n            `}\r\n            style={{ minHeight: '56px' }}\r\n          />\r\n          {errors.timePrepared && (\r\n            <p className=\"mt-1 text-sm text-red-600\">{errors.timePrepared}</p>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Vehicle Category */}\r\n      <div>\r\n        <label\r\n          htmlFor=\"vehicleCategory\"\r\n          className=\"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2\"\r\n        >\r\n          Vehicle/Equipment Category *\r\n        </label>\r\n        <select\r\n          id=\"vehicleCategory\"\r\n          value={formData.vehicleCategory || ''}\r\n          onChange={(e) => onChange('vehicleCategory', e.target.value)}\r\n          className={`\r\n            w-full px-4 py-3 text-base rounded-xl border-2 transition-all\r\n            focus:outline-none focus:ring-4\r\n            ${errors.vehicleCategory \r\n              ? 'border-red-500 focus:border-red-500 focus:ring-red-100' \r\n              : 'border-gray-300 focus:border-orange-500 focus:ring-orange-100'\r\n            }\r\n          `}\r\n          style={{ minHeight: '56px' }}\r\n        >\r\n          <option value=\"\">Select a category...</option>\r\n          {VEHICLE_CATEGORIES.map(category => (\r\n            <option key={category} value={category}>\r\n              {category}\r\n            </option>\r\n          ))}\r\n        </select>\r\n        {errors.vehicleCategory && (\r\n          <p className=\"mt-1 text-sm text-red-600\">{errors.vehicleCategory}</p>\r\n        )}\r\n      </div>\r\n\r\n      {/* Operational Period (Optional) */}\r\n      <div>\r\n        <label\r\n          htmlFor=\"operationalPeriod\"\r\n          className=\"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2\"\r\n        >\r\n          Operational Period <span className=\"text-gray-500\">(Optional)</span>\r\n        </label>\r\n        <input\r\n          type=\"text\"\r\n          id=\"operationalPeriod\"\r\n          value={formData.operationalPeriod || ''}\r\n          onChange={(e) => onChange('operationalPeriod', e.target.value)}\r\n          placeholder=\"e.g., 0800-2000 Day 1\"\r\n          maxLength={50}\r\n          className=\"\r\n            w-full px-4 py-3 text-base rounded-xl border-2 border-gray-300\r\n            transition-all focus:outline-none focus:ring-4\r\n            focus:border-orange-500 focus:ring-orange-100\r\n          \"\r\n          style={{ minHeight: '56px' }}\r\n        />\r\n      </div>\r\n\r\n      {/* Next Button */}\r\n      <TouchFeedback onTap={() => onNext()} hapticType=\"medium\">\r\n        <button\r\n          type=\"submit\"\r\n          className=\"\r\n            w-full bg-orange-600 hover:bg-orange-700 text-white font-bold\r\n            py-4 px-6 rounded-xl transition-all shadow-lg hover:shadow-xl\r\n            focus:outline-none focus:ring-4 focus:ring-orange-300\r\n          \"\r\n          style={{ minHeight: '56px' }}\r\n        >\r\n          Next: Vehicle Table\r\n        </button>\r\n      </TouchFeedback>\r\n    </motion.form>\r\n  );\r\n};\r\n\r\nexport default IncidentInfoStep;\r\n","import React, { useState, useEffect, useRef } from 'react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport type { Vehicle } from '../types';\r\nimport SkeletonLoader from './mobile/SkeletonLoader';\r\n\r\ninterface VehicleAutocompleteProps {\r\n  value: string;\r\n  onChange: (value: string, vehicle?: Vehicle) => void;\r\n  onVehicleSelect?: (vehicle: Vehicle) => void;\r\n  apiEndpoint?: string;\r\n  className?: string;\r\n  error?: string;\r\n}\r\n\r\nexport const VehicleAutocomplete: React.FC<VehicleAutocompleteProps> = ({\r\n  value,\r\n  onChange,\r\n  onVehicleSelect,\r\n  apiEndpoint = '/api/vehicles/autocomplete',\r\n  className = '',\r\n  error,\r\n}) => {\r\n  const [isOpen, setIsOpen] = useState(false);\r\n  const [vehicles, setVehicles] = useState<Vehicle[]>([]);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [searchQuery, setSearchQuery] = useState(value);\r\n  const debounceTimer = useRef<number | null>(null);\r\n  const containerRef = useRef<HTMLDivElement>(null);\r\n\r\n  // Debounced search\r\n  useEffect(() => {\r\n    if (debounceTimer.current) {\r\n      clearTimeout(debounceTimer.current);\r\n    }\r\n\r\n    if (searchQuery.trim().length < 2) {\r\n      setVehicles([]);\r\n      setIsOpen(false);\r\n      return;\r\n    }\r\n\r\n    debounceTimer.current = setTimeout(async () => {\r\n      setIsLoading(true);\r\n      try {\r\n        const response = await fetch(`${apiEndpoint}?q=${encodeURIComponent(searchQuery)}`);\r\n        if (response.ok) {\r\n          const data = await response.json();\r\n          setVehicles(data.vehicles || []);\r\n          setIsOpen(true);\r\n        }\r\n      } catch (error)  {\r\n        console.error('Vehicle search error:', error);\r\n        setVehicles([]);\r\n      } finally {\r\n        setIsLoading(false);\r\n      }\r\n    }, 300);\r\n\r\n    return () => {\r\n      if (debounceTimer.current) {\r\n        clearTimeout(debounceTimer.current);\r\n      }\r\n    };\r\n  }, [searchQuery, apiEndpoint]);\r\n\r\n  // Handle click outside\r\n  useEffect(() => {\r\n    const handleClickOutside = (event: MouseEvent) => {\r\n      if (containerRef.current && !containerRef.current.contains(event.target as Node)) {\r\n        setIsOpen(false);\r\n      }\r\n    };\r\n\r\n    document.addEventListener('mousedown', handleClickOutside);\r\n    return () => document.removeEventListener('mousedown', handleClickOutside);\r\n  }, []);\r\n\r\n  const handleInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const newValue = e.target.value;\r\n    setSearchQuery(newValue);\r\n    onChange(newValue);\r\n  };\r\n\r\n  const handleVehicleSelect = (vehicle: Vehicle) => {\r\n    setSearchQuery(vehicle.regUnit || '');\r\n    onChange(vehicle.regUnit || '', vehicle);\r\n    onVehicleSelect?.(vehicle);\r\n    setIsOpen(false);\r\n  };\r\n\r\n  return (\r\n    <div ref={containerRef} className={`relative ${className}`}>\r\n      {/* Input Field */}\r\n      <div className=\"relative\">\r\n        <input\r\n          type=\"text\"\r\n          value={searchQuery}\r\n          onChange={handleInputChange}\r\n          onFocus={() => searchQuery.length >= 2 && setIsOpen(true)}\r\n          placeholder=\"Search vehicle ID, make, or type...\"\r\n          className={`\r\n            w-full px-4 py-3 text-base rounded-xl border-2 transition-all\r\n            focus:outline-none focus:ring-4\r\n            ${error \r\n              ? 'border-red-500 focus:border-red-500 focus:ring-red-100' \r\n              : 'border-gray-300 focus:border-blue-500 focus:ring-blue-100'\r\n            }\r\n            ${isLoading ? 'pr-12' : ''}\r\n          `}\r\n          style={{ minHeight: '48px' }} // 88px touch target with padding\r\n        />\r\n        {isLoading && (\r\n          <div className=\"absolute right-4 top-1/2 -translate-y-1/2\">\r\n            <motion.div\r\n              className=\"w-5 h-5 border-3 border-blue-500 border-t-transparent rounded-full\"\r\n              animate={{ rotate: 360 }}\r\n              transition={{ repeat: Infinity, duration: 1, ease: 'linear' }}\r\n            />\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Error Message */}\r\n      {error && (\r\n        <p className=\"mt-1 text-sm text-red-600\">{error}</p>\r\n      )}\r\n\r\n      {/* Dropdown Results */}\r\n      <AnimatePresence>\r\n        {isOpen && vehicles.length > 0 && (\r\n          <motion.div\r\n            className=\"absolute z-50 w-full mt-2 bg-white dark:bg-gray-800 rounded-xl shadow-2xl max-h-80 overflow-y-auto\"\r\n            initial={{ opacity: 0, y: -10 }}\r\n            animate={{ opacity: 1, y: 0 }}\r\n            exit={{ opacity: 0, y: -10 }}\r\n            transition={{ duration: 0.2 }}\r\n          >\r\n            {vehicles.map((vehicle) => (\r\n              <motion.button\r\n                key={vehicle.id}\r\n                onClick={() => handleVehicleSelect(vehicle)}\r\n                className=\"w-full px-4 py-3 text-left hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors border-b border-gray-200 dark:border-gray-700 last:border-b-0\"\r\n                style={{ minHeight: '56px' }}\r\n                whileHover={{ backgroundColor: 'rgba(59, 130, 246, 0.1)' }}\r\n                whileTap={{ scale: 0.98 }}\r\n              >\r\n                <div className=\"flex items-center justify-between\">\r\n                  <div className=\"flex-1\">\r\n                    <p className=\"font-semibold text-gray-900 dark:text-white\">\r\n                      {vehicle.regUnit}\r\n                    </p>\r\n                    {(vehicle.vehicleMake || vehicle.vehicleType) && (\r\n                      <p className=\"text-sm text-gray-600 dark:text-gray-400\">\r\n                        {[vehicle.vehicleMake, vehicle.vehicleType]\r\n                          .filter(Boolean)\r\n                          .join(' ')}\r\n                      </p>\r\n                    )}\r\n                    {vehicle.licenseNumber && (\r\n                      <p className=\"text-xs text-gray-500 dark:text-gray-500 mt-0.5\">\r\n                        {vehicle.licenseNumber}\r\n                      </p>\r\n                    )}\r\n                  </div>\r\n                  {vehicle.vehicleStatus && (\r\n                    <span\r\n                      className={`\r\n                        ml-3 px-2 py-1 text-xs font-medium rounded-full\r\n                        ${vehicle.vehicleStatus === 'Active' \r\n                          ? 'bg-green-100 text-green-800' \r\n                          : vehicle.vehicleStatus === 'Inactive'\r\n                          ? 'bg-red-100 text-red-800'\r\n                          : 'bg-yellow-100 text-yellow-800'\r\n                        }\r\n                      `}\r\n                    >\r\n                      {vehicle.vehicleStatus}\r\n                    </span>\r\n                  )}\r\n                </div>\r\n              </motion.button>\r\n            ))}\r\n          </motion.div>\r\n        )}\r\n      </AnimatePresence>\r\n\r\n      {/* Loading Skeleton */}\r\n      {isLoading && isOpen && (\r\n        <div className=\"absolute z-50 w-full mt-2 bg-white dark:bg-gray-800 rounded-xl shadow-2xl p-4\">\r\n          <SkeletonLoader type=\"text\" count={3} />\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default VehicleAutocomplete;\r\n","import React, { useState } from 'react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport TouchFeedback from '../mobile/TouchFeedback';\r\nimport VehicleAutocomplete from '../VehicleAutocomplete';\r\nimport type { ICS218FormData, Vehicle } from '../../types';\r\n\r\ninterface VehicleTableStepProps {\r\n  formData: Partial<ICS218FormData>;\r\n  onChange: (field: keyof ICS218FormData, value: any) => void;\r\n  onNext: () => void;\r\n  onBack: () => void;\r\n  errors: Record<string, string>;\r\n}\r\n\r\nexport const VehicleTableStep: React.FC<VehicleTableStepProps> = ({\r\n  formData,\r\n  onChange,\r\n  onNext,\r\n  onBack,\r\n  errors,\r\n}) => {\r\n  const [expandedRow, setExpandedRow] = useState<number | null>(0);\r\n\r\n  const handleSubmit = (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    onNext();\r\n  };\r\n\r\n  const handleAddVehicle = () => {\r\n    const newVehicle = {\r\n      orderRequestNumber: '',\r\n      incidentIdNo: '',\r\n      classification: '',\r\n      make: '',\r\n      categoryKindType: '',\r\n      features: '',\r\n      agencyOwner: '',\r\n      operatorNameContact: '',\r\n      vehicleLicenseId: '',\r\n      incidentAssignment: '',\r\n      startDateTime: new Date().toISOString().slice(0, 16), // Format for datetime-local input\r\n      releaseDateTime: '',\r\n      airtableId: '',\r\n    };\r\n    \r\n    const updatedVehicles = [...(formData.vehicles || []), newVehicle];\r\n    onChange('vehicles', updatedVehicles);\r\n    setExpandedRow(updatedVehicles.length - 1); // Expand new row\r\n  };\r\n\r\n  const handleRemoveVehicle = (index: number) => {\r\n    const updatedVehicles = (formData.vehicles || []).filter((_, i) => i !== index);\r\n    onChange('vehicles', updatedVehicles);\r\n    if (expandedRow === index) {\r\n      setExpandedRow(null);\r\n    } else if (expandedRow !== null && expandedRow > index) {\r\n      setExpandedRow(expandedRow - 1);\r\n    }\r\n  };\r\n\r\n  const handleVehicleFieldChange = (index: number, field: string, value: any) => {\r\n    const updatedVehicles = [...(formData.vehicles || [])];\r\n    updatedVehicles[index] = {\r\n      ...updatedVehicles[index],\r\n      [field]: value,\r\n    };\r\n    onChange('vehicles', updatedVehicles);\r\n  };\r\n\r\n  const handleAirtableVehicleSelect = (index: number, vehicle: Vehicle) => {\r\n    // Auto-populate 7 fields from Airtable per ICS218_FORM_ANALYSIS.md\r\n    const updatedVehicles = [...(formData.vehicles || [])];\r\n    updatedVehicles[index] = {\r\n      ...updatedVehicles[index],\r\n      // Auto-populated fields\r\n      incidentIdNo: vehicle.vehicleId || '',         // Incident ID from Vehicle ID\r\n      classification: vehicle.vehicleType || '',       // Classification\r\n      make: vehicle.vehicleMake || '',                // Make\r\n      categoryKindType: vehicle.vehicleType || '',    // Category/Kind/Type\r\n      features: vehicle.features || '',               // Features\r\n      agencyOwner: vehicle.agency || '',              // Agency/Owner\r\n      vehicleLicenseId: vehicle.licenseNumber || '',  // License/ID\r\n      airtableId: vehicle.id || '',                   // Store Airtable reference\r\n    };\r\n    onChange('vehicles', updatedVehicles);\r\n  };\r\n\r\n  return (\r\n    <motion.form\r\n      className=\"space-y-6 p-4 md:p-6\"\r\n      onSubmit={handleSubmit}\r\n      initial={{ opacity: 0, x: 20 }}\r\n      animate={{ opacity: 1, x: 0 }}\r\n      exit={{ opacity: 0, x: -20 }}\r\n      transition={{ duration: 0.3 }}\r\n    >\r\n      <div>\r\n        <h2 className=\"text-2xl font-bold text-gray-900 dark:text-white mb-2\">\r\n          Vehicle/Equipment Inventory\r\n        </h2>\r\n        <p className=\"text-sm text-gray-600 dark:text-gray-400\">\r\n          Add vehicles using Airtable autocomplete. Many fields auto-fill from database.\r\n        </p>\r\n      </div>\r\n\r\n      {/* Vehicle List */}\r\n      <div className=\"space-y-4\">\r\n        {(formData.vehicles || []).map((vehicle, index) => (\r\n          <motion.div\r\n            key={index}\r\n            className=\"border-2 border-gray-300 dark:border-gray-600 rounded-xl overflow-hidden bg-white dark:bg-gray-800\"\r\n            initial={{ opacity: 0, y: 20 }}\r\n            animate={{ opacity: 1, y: 0 }}\r\n            transition={{ delay: index * 0.05 }}\r\n          >\r\n            {/* Vehicle Header */}\r\n            <div\r\n              className=\"flex items-center justify-between p-4 cursor-pointer bg-gray-50 dark:bg-gray-700 hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors\"\r\n              onClick={() => setExpandedRow(expandedRow === index ? null : index)}\r\n            >\r\n              <div className=\"flex items-center gap-3\">\r\n                <span className=\"text-lg font-bold text-gray-700 dark:text-gray-300\">\r\n                  #{index + 1}\r\n                </span>\r\n                <div>\r\n                  <p className=\"font-semibold text-gray-900 dark:text-white\">\r\n                    {vehicle.make || 'New Vehicle'}\r\n                  </p>\r\n                  <p className=\"text-xs text-gray-500 dark:text-gray-400\">\r\n                    {vehicle.vehicleLicenseId || 'No license set'}\r\n                  </p>\r\n                </div>\r\n              </div>\r\n              <div className=\"flex items-center gap-2\">\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={(e) => {\r\n                    e.stopPropagation();\r\n                    handleRemoveVehicle(index);\r\n                  }}\r\n                  className=\"text-red-600 hover:text-red-700 hover:bg-red-50 dark:hover:bg-red-900/20 p-2 rounded-lg transition-colors\"\r\n                >\r\n                  <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\" />\r\n                  </svg>\r\n                </button>\r\n                <svg\r\n                  className={`w-5 h-5 transition-transform ${expandedRow === index ? 'rotate-180' : ''}`}\r\n                  fill=\"none\"\r\n                  stroke=\"currentColor\"\r\n                  viewBox=\"0 0 24 24\"\r\n                >\r\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 9l-7 7-7-7\" />\r\n                </svg>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Expanded Form */}\r\n            <AnimatePresence>\r\n              {expandedRow === index && (\r\n                <motion.div\r\n                  className=\"p-4 space-y-4 border-t border-gray-200 dark:border-gray-700\"\r\n                  initial={{ height: 0, opacity: 0 }}\r\n                  animate={{ height: 'auto', opacity: 1 }}\r\n                  exit={{ height: 0, opacity: 0 }}\r\n                  transition={{ duration: 0.2 }}\r\n                >\r\n                  {/* Airtable Autocomplete */}\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                      üîç Search Vehicle (Auto-populate from Airtable)\r\n                    </label>\r\n                    <VehicleAutocomplete\r\n                      value={vehicle.make || ''}\r\n                      onChange={(value) => handleVehicleFieldChange(index, 'make', value)}\r\n                      onVehicleSelect={(selectedVehicle) => handleAirtableVehicleSelect(index, selectedVehicle)}\r\n                      className=\"w-full\"\r\n                    />\r\n                    <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\r\n                      Search by vehicle ID, make, or type to auto-fill fields\r\n                    </p>\r\n                  </div>\r\n\r\n                  {/* Grid Layout for Fields */}\r\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                    {/* Order Request Number (Manual) */}\r\n                    <div>\r\n                      <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                        Order Request # (optional)\r\n                      </label>\r\n                      <input\r\n                        type=\"text\"\r\n                        value={vehicle.orderRequestNumber || ''}\r\n                        onChange={(e) => handleVehicleFieldChange(index, 'orderRequestNumber', e.target.value)}\r\n                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                      />\r\n                    </div>\r\n\r\n                    {/* Incident ID (Auto-filled) */}\r\n                    <div>\r\n                      <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                        Incident ID # ‚ú® Auto\r\n                      </label>\r\n                      <input\r\n                        type=\"text\"\r\n                        value={vehicle.incidentIdNo || ''}\r\n                        onChange={(e) => handleVehicleFieldChange(index, 'incidentIdNo', e.target.value)}\r\n                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white bg-blue-50 dark:bg-blue-900/20\"\r\n                      />\r\n                    </div>\r\n\r\n                    {/* Classification (Auto-filled) */}\r\n                    <div>\r\n                      <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                        Classification ‚ú® Auto *\r\n                      </label>\r\n                      <input\r\n                        type=\"text\"\r\n                        value={vehicle.classification || ''}\r\n                        onChange={(e) => handleVehicleFieldChange(index, 'classification', e.target.value)}\r\n                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white bg-blue-50 dark:bg-blue-900/20\"\r\n                        required\r\n                      />\r\n                    </div>\r\n\r\n                    {/* Make (Auto-filled) */}\r\n                    <div>\r\n                      <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                        Make ‚ú® Auto *\r\n                      </label>\r\n                      <input\r\n                        type=\"text\"\r\n                        value={vehicle.make || ''}\r\n                        onChange={(e) => handleVehicleFieldChange(index, 'make', e.target.value)}\r\n                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white bg-blue-50 dark:bg-blue-900/20\"\r\n                        required\r\n                      />\r\n                    </div>\r\n\r\n                    {/* Category/Kind/Type (Auto-filled) */}\r\n                    <div className=\"md:col-span-2\">\r\n                      <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                        Category/Kind/Type ‚ú® Auto *\r\n                      </label>\r\n                      <input\r\n                        type=\"text\"\r\n                        value={vehicle.categoryKindType || ''}\r\n                        onChange={(e) => handleVehicleFieldChange(index, 'categoryKindType', e.target.value)}\r\n                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white bg-blue-50 dark:bg-blue-900/20\"\r\n                        required\r\n                      />\r\n                    </div>\r\n\r\n                    {/* Features (Auto-filled) */}\r\n                    <div className=\"md:col-span-2\">\r\n                      <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                        Features ‚ú® Auto\r\n                      </label>\r\n                      <input\r\n                        type=\"text\"\r\n                        value={vehicle.features || ''}\r\n                        onChange={(e) => handleVehicleFieldChange(index, 'features', e.target.value)}\r\n                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white bg-blue-50 dark:bg-blue-900/20\"\r\n                      />\r\n                    </div>\r\n\r\n                    {/* Agency/Owner (Auto-filled) */}\r\n                    <div>\r\n                      <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                        Agency/Owner ‚ú® Auto *\r\n                      </label>\r\n                      <input\r\n                        type=\"text\"\r\n                        value={vehicle.agencyOwner || ''}\r\n                        onChange={(e) => handleVehicleFieldChange(index, 'agencyOwner', e.target.value)}\r\n                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white bg-blue-50 dark:bg-blue-900/20\"\r\n                        required\r\n                      />\r\n                    </div>\r\n\r\n                    {/* Operator Name/Contact (Manual) */}\r\n                    <div>\r\n                      <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                        Operator Name/Contact *\r\n                      </label>\r\n                      <input\r\n                        type=\"text\"\r\n                        value={vehicle.operatorNameContact || ''}\r\n                        onChange={(e) => handleVehicleFieldChange(index, 'operatorNameContact', e.target.value)}\r\n                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                        required\r\n                      />\r\n                    </div>\r\n\r\n                    {/* License/ID (Auto-filled) */}\r\n                    <div>\r\n                      <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                        License/ID # ‚ú® Auto *\r\n                      </label>\r\n                      <input\r\n                        type=\"text\"\r\n                        value={vehicle.vehicleLicenseId || ''}\r\n                        onChange={(e) => handleVehicleFieldChange(index, 'vehicleLicenseId', e.target.value)}\r\n                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white bg-blue-50 dark:bg-blue-900/20\"\r\n                        required\r\n                      />\r\n                    </div>\r\n\r\n                    {/* Incident Assignment (Manual) */}\r\n                    <div>\r\n                      <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                        Incident Assignment *\r\n                      </label>\r\n                      <input\r\n                        type=\"text\"\r\n                        value={vehicle.incidentAssignment || ''}\r\n                        onChange={(e) => handleVehicleFieldChange(index, 'incidentAssignment', e.target.value)}\r\n                        placeholder=\"e.g., Search & Rescue, Transport\"\r\n                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                        required\r\n                      />\r\n                    </div>\r\n\r\n                    {/* Start Date/Time (Manual) */}\r\n                    <div>\r\n                      <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                        Start Date/Time *\r\n                      </label>\r\n                      <input\r\n                        type=\"datetime-local\"\r\n                        value={vehicle.startDateTime || ''}\r\n                        onChange={(e) => handleVehicleFieldChange(index, 'startDateTime', e.target.value)}\r\n                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                        required\r\n                      />\r\n                    </div>\r\n\r\n                    {/* Release Date/Time (Manual, Optional) */}\r\n                    <div>\r\n                      <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                        Release Date/Time (optional)\r\n                      </label>\r\n                      <input\r\n                        type=\"datetime-local\"\r\n                        value={vehicle.releaseDateTime || ''}\r\n                        onChange={(e) => handleVehicleFieldChange(index, 'releaseDateTime', e.target.value)}\r\n                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                      />\r\n                    </div>\r\n                  </div>\r\n                </motion.div>\r\n              )}\r\n            </AnimatePresence>\r\n          </motion.div>\r\n        ))}\r\n      </div>\r\n\r\n      {/* Add Vehicle Button */}\r\n      <TouchFeedback onTap={handleAddVehicle} hapticType=\"light\">\r\n        <button\r\n          type=\"button\"\r\n          onClick={handleAddVehicle}\r\n          className=\"\r\n            w-full bg-blue-600 hover:bg-blue-700 text-white font-medium\r\n            py-4 px-6 rounded-xl transition-all shadow-lg hover:shadow-xl\r\n            focus:outline-none focus:ring-4 focus:ring-blue-300\r\n            flex items-center justify-center gap-2\r\n          \"\r\n        >\r\n          <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 4v16m8-8H4\" />\r\n          </svg>\r\n          Add Vehicle\r\n        </button>\r\n      </TouchFeedback>\r\n\r\n      {errors.vehicles && (\r\n        <p className=\"text-sm text-red-600 bg-red-50 dark:bg-red-900/20 rounded-lg p-3\">\r\n          {errors.vehicles}\r\n        </p>\r\n      )}\r\n\r\n      <p className=\"text-xs text-gray-500 dark:text-gray-400\">\r\n        * Required fields | ‚ú® Auto = Auto-populated from Airtable\r\n      </p>\r\n\r\n      {/* Navigation Buttons */}\r\n      <div className=\"flex gap-3\">\r\n        <TouchFeedback onTap={onBack} hapticType=\"medium\">\r\n          <button\r\n            type=\"button\"\r\n            onClick={onBack}\r\n            className=\"\r\n              flex-1 bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold\r\n              py-4 px-6 rounded-xl transition-all shadow-lg hover:shadow-xl\r\n              focus:outline-none focus:ring-4 focus:ring-gray-300\r\n            \"\r\n            style={{ minHeight: '56px' }}\r\n          >\r\n            Back\r\n          </button>\r\n        </TouchFeedback>\r\n\r\n        <TouchFeedback onTap={() => onNext()} hapticType=\"medium\">\r\n          <button\r\n            type=\"submit\"\r\n            className=\"\r\n              flex-1 bg-orange-600 hover:bg-orange-700 text-white font-bold\r\n              py-4 px-6 rounded-xl transition-all shadow-lg hover:shadow-xl\r\n              focus:outline-none focus:ring-4 focus:ring-orange-300\r\n            \"\r\n            style={{ minHeight: '56px' }}\r\n          >\r\n            Next: Prepared By ({(formData.vehicles || []).length} Vehicles)\r\n          </button>\r\n        </TouchFeedback>\r\n      </div>\r\n    </motion.form>\r\n  );\r\n};\r\n\r\nexport default VehicleTableStep;\r\n","import React, { useState } from 'react';\r\nimport { motion } from 'framer-motion';\r\nimport TouchFeedback from '../mobile/TouchFeedback';\r\nimport SignatureCanvas from '../SignatureCanvas';\r\nimport type { ICS218FormData } from '../../types';\r\n\r\ninterface PreparedByStepProps {\r\n  formData: Partial<ICS218FormData>;\r\n  onChange: (field: keyof ICS218FormData, value: any) => void;\r\n  onNext: () => void;\r\n  onBack: () => void;\r\n  errors: Record<string, string>;\r\n}\r\n\r\nexport const PreparedByStep: React.FC<PreparedByStepProps> = ({\r\n  formData,\r\n  onChange,\r\n  onNext,\r\n  onBack,\r\n  errors,\r\n}) => {\r\n  const [showSignaturePad, setShowSignaturePad] = useState(false);\r\n\r\n  const handleSubmit = (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    onNext();\r\n  };\r\n\r\n  const handleSignatureSave = (signature: string) => {\r\n    onChange('preparedBy', {\r\n      ...formData.preparedBy,\r\n      signature,\r\n      signatureTimestamp: new Date().toISOString(),\r\n    });\r\n    setShowSignaturePad(false);\r\n  };\r\n\r\n  const handleSignatureClear = () => {\r\n    onChange('preparedBy', {\r\n      ...formData.preparedBy,\r\n      signature: '',\r\n      signatureTimestamp: '',\r\n    });\r\n  };\r\n\r\n  return (\r\n    <motion.form\r\n      className=\"space-y-6 p-4 md:p-6\"\r\n      onSubmit={handleSubmit}\r\n      initial={{ opacity: 0, x: 20 }}\r\n      animate={{ opacity: 1, x: 0 }}\r\n      exit={{ opacity: 0, x: -20 }}\r\n      transition={{ duration: 0.3 }}\r\n    >\r\n      <div>\r\n        <h2 className=\"text-2xl font-bold text-gray-900 dark:text-white mb-2\">\r\n          Prepared By Information\r\n        </h2>\r\n        <p className=\"text-sm text-gray-600 dark:text-gray-400\">\r\n         Form preparer details and signature\r\n        </p>\r\n      </div>\r\n\r\n      {/* Name */}\r\n      <div>\r\n        <label\r\n          htmlFor=\"preparedByName\"\r\n          className=\"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2\"\r\n        >\r\n          Name *\r\n        </label>\r\n        <input\r\n          type=\"text\"\r\n          id=\"preparedByName\"\r\n          value={formData.preparedBy?.name || ''}\r\n          onChange={(e) => onChange('preparedBy', {\r\n            ...formData.preparedBy,\r\n            name: e.target.value,\r\n          })}\r\n          placeholder=\"Enter your full name\"\r\n          maxLength={100}\r\n          className={`\r\n            w-full px-4 py-3 text-base rounded-xl border-2 transition-all\r\n            focus:outline-none focus:ring-4\r\n            ${errors.preparedByName \r\n              ? 'border-red-500 focus:border-red-500 focus:ring-red-100' \r\n              : 'border-gray-300 focus:border-orange-500 focus:ring-orange-100'\r\n            }\r\n          `}\r\n          style={{ minHeight: '56px' }}\r\n        />\r\n        {errors.preparedByName && (\r\n          <p className=\"mt-1 text-sm text-red-600\">{errors.preparedByName}</p>\r\n        )}\r\n      </div>\r\n\r\n      {/* Position/Title */}\r\n      <div>\r\n        <label\r\n          htmlFor=\"preparedByPosition\"\r\n          className=\"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2\"\r\n        >\r\n          Position/Title *\r\n        </label>\r\n        <input\r\n          type=\"text\"\r\n          id=\"preparedByPosition\"\r\n          value={formData.preparedBy?.positionTitle || ''}\r\n          onChange={(e) => onChange('preparedBy', {\r\n            ...formData.preparedBy,\r\n            positionTitle: e.target.value,\r\n          })}\r\n          placeholder=\"e.g., Equipment Manager, Logistics Chief\"\r\n          maxLength={100}\r\n          className={`\r\n            w-full px-4 py-3 text-base rounded-xl border-2 transition-all\r\n            focus:outline-none focus:ring-4\r\n            ${errors.preparedByPosition \r\n              ? 'border-red-500 focus:border-red-500 focus:ring-red-100' \r\n              : 'border-gray-300 focus:border-orange-500 focus:ring-orange-100'\r\n            }\r\n          `}\r\n          style={{ minHeight: '56px' }}\r\n        />\r\n        {errors.preparedByPosition && (\r\n          <p className=\"mt-1 text-sm text-red-600\">{errors.preparedByPosition}</p>\r\n        )}\r\n      </div>\r\n\r\n      {/* Signature */}\r\n      <div>\r\n        <label className=\"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2\">\r\n          Signature *\r\n        </label>\r\n        \r\n        {!formData.preparedBy?.signature ? (\r\n          <div className=\"space-y-3\">\r\n            <button\r\n              type=\"button\"\r\n              onClick={() => setShowSignaturePad(true)}\r\n              className=\"\r\n                w-full bg-orange-100 hover:bg-orange-200 text-orange-700 font-medium\r\n                py-4 px-6 rounded-xl transition-all border-2 border-dashed border-orange-300\r\n                focus:outline-none focus:ring-4 focus:ring-orange-200\r\n              \"\r\n              style={{ minHeight: '56px' }}\r\n            >\r\n              <span className=\"text-lg\">‚úçÔ∏è</span> Tap to Sign\r\n            </button>\r\n            {errors.preparedBySignature && (\r\n              <p className=\"text-sm text-red-600\">{errors.preparedBySignature}</p>\r\n            )}\r\n          </div>\r\n        ) : (\r\n          <div className=\"space-y-3\">\r\n            <div className=\"bg-white dark:bg-gray-700 border-2 border-green-500 rounded-xl p-4\">\r\n              <img\r\n                src={formData.preparedBy.signature}\r\n                alt=\"Signature\"\r\n                className=\"max-w-full h-auto\"\r\n                style={{ maxHeight: '100px' }}\r\n              />\r\n              <p className=\"text-xs text-gray-600 dark:text-gray-400 mt-2\">\r\n                Signed: {formData.preparedBy.signatureTimestamp ? new Date(formData.preparedBy.signatureTimestamp).toLocaleString() : 'Unknown'}\r\n              </p>\r\n            </div>\r\n            <button\r\n              type=\"button\"\r\n              onClick={handleSignatureClear}\r\n              className=\"\r\n                w-full bg-red-100 hover:bg-red-200 text-red-700 font-medium\r\n                py-3 px-6 rounded-xl transition-all\r\n                focus:outline-none focus:ring-4 focus:ring-red-200\r\n              \"\r\n            >\r\n              Clear Signature\r\n            </button>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Navigation Buttons */}\r\n      <div className=\"flex gap-3\">\r\n        <TouchFeedback onTap={onBack} hapticType=\"medium\">\r\n          <button\r\n            type=\"button\"\r\n            onClick={onBack}\r\n            className=\"\r\n              flex-1 bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold\r\n              py-4 px-6 rounded-xl transition-all shadow-lg hover:shadow-xl\r\n              focus:outline-none focus:ring-4 focus:ring-gray-300\r\n            \"\r\n            style={{ minHeight: '56px' }}\r\n          >\r\n            Back\r\n          </button>\r\n        </TouchFeedback>\r\n\r\n        <TouchFeedback onTap={() => onNext()} hapticType=\"medium\">\r\n          <button\r\n            type=\"submit\"\r\n            className=\"\r\n              flex-1 bg-orange-600 hover:bg-orange-700 text-white font-bold\r\n              py-4 px-6 rounded-xl transition-all shadow-lg hover:shadow-xl\r\n              focus:outline-none focus:ring-4 focus:ring-orange-300\r\n            \"\r\n            style={{ minHeight: '56px' }}\r\n          >\r\n            Next: Review & Submit\r\n          </button>\r\n        </TouchFeedback>\r\n      </div>\r\n\r\n      {/* Signature Pad Modal */}\r\n      {showSignaturePad && (\r\n        <div className=\"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4\">\r\n          <div className=\"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-2xl w-full p-6\">\r\n            <div className=\"flex items-center justify-between mb-4\">\r\n              <h3 className=\"text-xl font-bold text-gray-900 dark:text-white\">\r\n                Sign Here\r\n              </h3>\r\n              <button\r\n                type=\"button\"\r\n                onClick={() => setShowSignaturePad(false)}\r\n                className=\"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors\">\r\n                <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\r\n                </svg>\r\n              </button>\r\n            </div>\r\n            <SignatureCanvas\r\n              onSave={handleSignatureSave}\r\n            />\r\n          </div>\r\n        </div>\r\n      )}\r\n    </motion.form>\r\n  );\r\n};\r\n\r\nexport default PreparedByStep;\r\n","import React, { useState } from 'react';\r\nimport { motion } from 'framer-motion';\r\nimport TouchFeedback from '../mobile/TouchFeedback';\r\nimport type { ICS218FormData } from '../../types';\r\n\r\ninterface ReviewStepProps {\r\n  formData: Partial<ICS218FormData>;\r\n  onSubmit: () => void;\r\n  onBack: () => void;\r\n  onGoToStep: (step: number) => void;\r\n}\r\n\r\nexport const ReviewStep: React.FC<ReviewStepProps> = ({\r\n  formData,\r\n  onSubmit,\r\n  onBack,\r\n  onGoToStep,\r\n}) => {\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n\r\n  const handleSubmit = async () => {\r\n    setIsSubmitting(true);\r\n    try {\r\n      await onSubmit();\r\n    } catch (error) {\r\n      console.error('Submission error:', error);\r\n    } finally {\r\n      setIsSubmitting(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <motion.div\r\n      className=\"space-y-6 p-4 md:p-6\"\r\n      initial={{ opacity: 0, x: 20 }}\r\n      animate={{ opacity: 1, x: 0 }}\r\n      exit={{ opacity: 0, x: -20 }}\r\n      transition={{ duration: 0.3 }}\r\n    >\r\n      <div>\r\n        <h2 className=\"text-2xl font-bold text-gray-900 dark:text-white mb-2\">\r\n          Review & Submit\r\n        </h2>\r\n        <p className=\"text-sm text-gray-600 dark:text-gray-400\">\r\n          Review all information before submitting\r\n        </p>\r\n      </div>\r\n\r\n      {/* Incident Information Section */}\r\n      <div className=\"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm\">\r\n        <div className=\"flex items-center justify-between mb-4\">\r\n          <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white\">\r\n            Incident Information\r\n          </h3>\r\n          <button\r\n            type=\"button\"\r\n            onClick={() => onGoToStep(0)}\r\n            className=\"text-orange-600 hover:text-orange-700 text-sm font-medium\"\r\n          >\r\n            Edit\r\n          </button>\r\n        </div>\r\n        <div className=\"space-y-2 text-sm\">\r\n          <div className=\"flex justify-between\">\r\n            <span className=\"text-gray-600 dark:text-gray-400\">Incident Name:</span>\r\n            <span className=\"font-medium text-gray-900 dark:text-white\">{formData.incidentName}</span>\r\n          </div>\r\n          <div className=\"flex justify-between\">\r\n            <span className=\"text-gray-600 dark:text-gray-400\">Incident Number:</span>\r\n            <span className=\"font-medium text-gray-900 dark:text-white\">{formData.incidentNumber}</span>\r\n          </div>\r\n          <div className=\"flex justify-between\">\r\n            <span className=\"text-gray-600 dark:text-gray-400\">Date Prepared:</span>\r\n            <span className=\"font-medium text-gray-900 dark:text-white\">{formData.datePrepared} {formData.timePrepared}</span>\r\n          </div>\r\n          <div className=\"flex justify-between\">\r\n            <span className=\"text-gray-600 dark:text-gray-400\">Vehicle Category:</span>\r\n            <span className=\"font-medium text-gray-900 dark:text-white\">{formData.vehicleCategory}</span>\r\n          </div>\r\n          {formData.operationalPeriod && (\r\n            <div className=\"flex justify-between\">\r\n              <span className=\"text-gray-600 dark:text-gray-400\">Operational Period:</span>\r\n              <span className=\"font-medium text-gray-900 dark:text-white\">{formData.operationalPeriod}</span>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Vehicle Table Section */}\r\n      <div className=\"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm\">\r\n        <div className=\"flex items-center justify-between mb-4\">\r\n          <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white\">\r\n            Vehicle Inventory\r\n          </h3>\r\n          <button\r\n            type=\"button\"\r\n            onClick={() => onGoToStep(1)}\r\n            className=\"text-orange-600 hover:text-orange-700 text-sm font-medium\"\r\n          >\r\n            Edit\r\n          </button>\r\n        </div>\r\n        <div className=\"text-sm\">\r\n          <p className=\"text-gray-600 dark:text-gray-400\">\r\n            Total vehicles: <span className=\"font-semibold text-gray-900 dark:text-white\">{formData.vehicles?.length || 0}</span>\r\n          </p>\r\n          {formData.vehicles && formData.vehicles.length > 0 && (\r\n            <div className=\"mt-3 space-y-2\">\r\n              {formData.vehicles.map((vehicle, index) => (\r\n                <div key={index} className=\"flex items-center gap-2 text-gray-700 dark:text-gray-300\">\r\n                  <span className=\"text-orange-600 font-medium\">#{index + 1}</span>\r\n                  <span className=\"truncate\">\r\n                    {vehicle.make} {vehicle.classification} - {vehicle.vehicleLicenseId}\r\n                  </span>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Prepared By Section */}\r\n      <div className=\"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm\">\r\n        <div className=\"flex items-center justify-between mb-4\">\r\n          <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white\">\r\n            Prepared By\r\n          </h3>\r\n          <button\r\n            type=\"button\"\r\n            onClick={() => onGoToStep(2)}\r\n            className=\"text-orange-600 hover:text-orange-700 text-sm font-medium\"\r\n          >\r\n            Edit\r\n          </button>\r\n        </div>\r\n        <div className=\"space-y-3\">\r\n          <div className=\"space-y-2 text-sm\">\r\n            <div className=\"flex justify-between\">\r\n              <span className=\"text-gray-600 dark:text-gray-400\">Name:</span>\r\n              <span className=\"font-medium text-gray-900 dark:text-white\">{formData.preparedBy?.name}</span>\r\n            </div>\r\n            <div className=\"flex justify-between\">\r\n              <span className=\"text-gray-600 dark:text-gray-400\">Position/Title:</span>\r\n              <span className=\"font-medium text-gray-900 dark:text-white\">{formData.preparedBy?.positionTitle}</span>\r\n            </div>\r\n          </div>\r\n          {formData.preparedBy?.signature && (\r\n            <div className=\"bg-gray-50 dark:bg-gray-700 rounded-lg p-3\">\r\n              <p className=\"text-xs text-gray-600 dark:text-gray-400 mb-2\">Signature:</p>\r\n              <img\r\n                src={formData.preparedBy.signature}\r\n                alt=\"Signature\"\r\n                className=\"max-w-full h-auto\"\r\n                style={{ maxHeight: '60px' }}\r\n              />\r\n              <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\r\n                {formData.preparedBy.signatureTimestamp && new Date(formData.preparedBy.signatureTimestamp).toLocaleString()}\r\n              </p>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Important Notice */}\r\n      <div className=\"bg-orange-50 dark:bg-orange-900/20 border-2 border-orange-200 dark:border-orange-800 rounded-xl p-4\">\r\n        <div className=\"flex items-start gap-3\">\r\n          <div className=\"text-orange-600 dark:text-orange-400 text-2xl\">‚ö†Ô∏è</div>\r\n          <div>\r\n            <h4 className=\"font-semibold text-orange-900 dark:text-orange-300 mb-1\">\r\n              Before Submitting\r\n            </h4>\r\n            <p className=\"text-sm text-orange-800 dark:text-orange-400\">\r\n              Please verify all information is correct. Once submitted, this form will be logged\r\n              and cannot be edited.\r\n            </p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Navigation Buttons */}\r\n      <div className=\"flex gap-3\">\r\n        <TouchFeedback onTap={onBack} hapticType=\"medium\">\r\n          <button\r\n            type=\"button\"\r\n            onClick={onBack}\r\n            disabled={isSubmitting}\r\n            className=\"\r\n              flex-1 bg-gray-200 hover:bg-gray-300 disabled:bg-gray-100 text-gray-800 font-bold\r\n              py-4 px-6 rounded-xl transition-all shadow-lg hover:shadow-xl\r\n              focus:outline-none focus:ring-4 focus:ring-gray-300\r\n              disabled:cursor-not-allowed\r\n            \"\r\n            style={{ minHeight: '56px' }}\r\n          >\r\n            Back\r\n          </button>\r\n        </TouchFeedback>\r\n\r\n        <TouchFeedback onTap={handleSubmit} hapticType=\"heavy\">\r\n          <button\r\n            type=\"button\"\r\n            onClick={handleSubmit}\r\n            disabled={isSubmitting}\r\n            className=\"\r\n              flex-1 bg-gradient-to-r from-orange-600 to-orange-700 hover:from-orange-700 hover:to-orange-800\r\n              disabled:from-gray-300 disabled:to-gray-400 text-white font-bold\r\n              py-4 px-6 rounded-xl transition-all shadow-lg hover:shadow-xl\r\n              focus:outline-none focus:ring-4 focus:ring-orange-300\r\n              disabled:cursor-not-allowed\r\n            \"\r\n            style={{ minHeight: '56px' }}\r\n          >\r\n            {isSubmitting ? (\r\n              <span className=\"flex items-center justify-center gap-2\">\r\n                <svg className=\"animate-spin h-5 w-5\" viewBox=\"0 0 24 24\">\r\n                  <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\" fill=\"none\" />\r\n                  <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\" />\r\n                </svg>\r\n                Submitting...\r\n              </span>\r\n            ) : (\r\n              '‚úì Submit Form'\r\n            )}\r\n          </button>\r\n        </TouchFeedback>\r\n      </div>\r\n    </motion.div>\r\n  );\r\n};\r\n\r\nexport default ReviewStep;\r\n","import React, { useState, useEffect } from 'react';\r\nimport { AnimatePresence, motion } from 'framer-motion';\r\nimport toast from 'react-hot-toast';\r\nimport { Save, Trash2, ArrowLeft, LayoutDashboard } from 'lucide-react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport ProgressIndicator from '../mobile/ProgressIndicator';\r\nimport IncidentInfoStep from './IncidentInfoStep';\r\nimport VehicleTableStep from './VehicleTableStep';\r\nimport PreparedByStep from './PreparedByStep';\r\nimport ReviewStep from './ReviewStep';\r\nimport type { ICS218FormData, ICS218DraftData } from '../../types';\r\n\r\nconst STEPS = [\r\n  { id: 0, title: 'Incident Info', component: IncidentInfoStep },\r\n  { id: 1, title: 'Vehicle Table', component: VehicleTableStep },\r\n  { id: 2, title: 'Prepared By', component: PreparedByStep },\r\n  { id: 3, title: 'Review & Submit', component: ReviewStep },\r\n];\r\n\r\nconst INITIAL_FORM_DATA: Partial<ICS218FormData> = {\r\n  status: 'draft',\r\n  incidentName: '',\r\n  incidentNumber: '',\r\n  datePrepared: new Date().toISOString().split('T')[0],\r\n  timePrepared: new Date().toTimeString().slice(0, 5),\r\n  vehicleCategory: '',\r\n  operationalPeriod: '',\r\n  vehicles: [],\r\n  preparedBy: {\r\n    name: '',\r\n    positionTitle: '',\r\n    signature: '',\r\n    signatureTimestamp: '',\r\n  },\r\n};\r\n\r\nexport const ICS218Form: React.FC = () => {\r\n  const navigate = useNavigate();\r\n  const [currentStep, setCurrentStep] = useState(0);\r\n  const [formData, setFormData] = useState<Partial<ICS218FormData>>(INITIAL_FORM_DATA);\r\n  const [errors, setErrors] = useState<Record<string, string>>({});\r\n  const [isSubmitted, setIsSubmitted] = useState(false);\r\n  const [showDraftDialog, setShowDraftDialog] = useState(false);\r\n  const [recoveredDraft, setRecoveredDraft] = useState<ICS218DraftData | null>(null);\r\n\r\n  // Auto-save to localStorage every 30 seconds\r\n  useEffect(() => {\r\n    const saveInterval = setInterval(() => {\r\n      if (formData && !isSubmitted && currentStep > 0) {\r\n        const draft: ICS218DraftData = {\r\n          formData,\r\n          currentStep,\r\n          savedAt: new Date().toISOString(),\r\n          expiresAt: new Date(Date.now() + 7 * 24 * 60 * 60 * 1000).toISOString(), // 7 days\r\n        };\r\n        localStorage.setItem('ics218-draft', JSON.stringify(draft));\r\n        toast.success('Draft auto-saved', { duration: 1500, icon: 'üíæ' });\r\n      }\r\n    }, 30000); // 30 seconds\r\n\r\n    return () => clearInterval(saveInterval);\r\n  }, [formData, currentStep, isSubmitted]);\r\n\r\n  // Draft recovery on mount\r\n  useEffect(() => {\r\n    const draftJson = localStorage.getItem('ics218-draft');\r\n    if (draftJson) {\r\n      try {\r\n        const draft = JSON.parse(draftJson) as ICS218DraftData;\r\n        const expiryDate = new Date(draft.expiresAt);\r\n        const now = new Date();\r\n        \r\n        if (expiryDate > now) {\r\n          setRecoveredDraft(draft);\r\n          setShowDraftDialog(true);\r\n        } else {\r\n          // Draft expired, clear it\r\n          localStorage.removeItem('ics218-draft');\r\n        }\r\n      } catch (error) {\r\n        console.error('Failed to parse draft:', error);\r\n        localStorage.removeItem('ics218-draft');\r\n      }\r\n    }\r\n  }, []);\r\n\r\n  const handleResumeDraft = () => {\r\n    if (recoveredDraft) {\r\n      setFormData(recoveredDraft.formData);\r\n      setCurrentStep(recoveredDraft.currentStep);\r\n      setShowDraftDialog(false);\r\n      toast.success('Draft restored!');\r\n    }\r\n  };\r\n\r\n  const handleDiscardDraft = () => {\r\n    localStorage.removeItem('ics218-draft');\r\n    setShowDraftDialog(false);\r\n    setRecoveredDraft(null);\r\n    toast('Draft discarded', { icon: 'üóëÔ∏è' });\r\n  };\r\n\r\n  const handleFieldChange = (field: keyof ICS218FormData, value: any) => {\r\n    setFormData(prev => ({ ...prev, [field]: value }));\r\n    // Clear error for this field\r\n    if (errors[field]) {\r\n      setErrors(prev => {\r\n        const newErrors = { ...prev };\r\n        delete newErrors[field];\r\n        return newErrors;\r\n      });\r\n    }\r\n  };\r\n\r\n  const validateStep = (step: number): boolean => {\r\n    const newErrors: Record<string, string> = {};\r\n\r\n    switch (step) {\r\n      case 0: // Incident Info\r\n        if (!formData.incidentName || formData.incidentName.length < 3) {\r\n          newErrors.incidentName = 'Incident name must be at least 3 characters';\r\n        }\r\n        if (!formData.incidentNumber) {\r\n          newErrors.incidentNumber = 'Incident number is required';\r\n        }\r\n        if (!formData.datePrepared) {\r\n          newErrors.datePrepared = 'Date is required';\r\n        }\r\n        if (!formData.timePrepared) {\r\n          newErrors.timePrepared = 'Time is required';\r\n        }\r\n        if (!formData.vehicleCategory) {\r\n          newErrors.vehicleCategory = 'Vehicle category is required';\r\n        }\r\n        break;\r\n\r\n      case 1: // Vehicle Table\r\n        if (!formData.vehicles || formData.vehicles.length === 0) {\r\n          newErrors.vehicles = 'At least one vehicle must be added';\r\n        }\r\n        break;\r\n\r\n      case 2: // Prepared By\r\n        if (!formData.preparedBy?.name || (formData.preparedBy?.name || '').length < 2) {\r\n          newErrors.preparedByName = 'Name must be at least 2 characters';\r\n        }\r\n        if (!formData.preparedBy?.positionTitle) {\r\n          newErrors.preparedByPosition = 'Position/Title is required';\r\n        }\r\n        if (!formData.preparedBy?.signature) {\r\n          newErrors.preparedBySignature = 'Signature is required';\r\n        }\r\n        break;\r\n    }\r\n\r\n    setErrors(newErrors);\r\n    return Object.keys(newErrors).length === 0;\r\n  };\r\n\r\n  const handleNext = () => {\r\n    if (validateStep(currentStep)) {\r\n      if (currentStep < STEPS.length - 1) {\r\n        setCurrentStep(currentStep + 1);\r\n      }\r\n    } else {\r\n      toast.error('Please complete all required fields');\r\n    }\r\n  };\r\n\r\n  const handleBack = () => {\r\n    if (currentStep > 0) {\r\n      setCurrentStep(currentStep - 1);\r\n    }\r\n  };\r\n\r\n  const handleGoToStep = (step: number) => {\r\n    if (step >= 0 && step < STEPS.length) {\r\n      setCurrentStep(step);\r\n    }\r\n  };\r\n\r\n  const handleManualSave = () => {\r\n    const draft: ICS218DraftData = {\r\n      formData,\r\n      currentStep,\r\n      savedAt: new Date().toISOString(),\r\n      expiresAt: new Date(Date.now() + 7 * 24 * 60 * 60 * 1000).toISOString(),\r\n    };\r\n    localStorage.setItem('ics218-draft', JSON.stringify(draft));\r\n    toast.success('Draft saved manually!', { icon: 'üíæ' });\r\n  };\r\n\r\n  const handleClearForm = () => {\r\n    if (confirm('Are you sure you want to clear all form data? This cannot be undone.')) {\r\n      setFormData(INITIAL_FORM_DATA);\r\n      setCurrentStep(0);\r\n      setErrors({});\r\n      localStorage.removeItem('ics218-draft');\r\n      toast('Form cleared', { icon: 'üóëÔ∏è' });\r\n    }\r\n  };\r\n\r\n  const handleSubmit = async () => {\r\n    try {\r\n      // Prepare submission data\r\n      const submissionData: Partial<ICS218FormData> = {\r\n        ...formData,\r\n        id: `ICS218-${Date.now()}`,\r\n        submittedAt: new Date().toISOString(),\r\n        status: 'submitted',\r\n      };\r\n\r\n      // Submit to backend (Phase 3 will implement this)\r\n      // const response = await fetch('/api/ics218/submit', {\r\n      //   method: 'POST',\r\n      //   headers: {\r\n      //     'Content-Type': 'application/json',\r\n      //     'Authorization': `Bearer ${sessionStorage.getItem('ics218_access_token')}`,\r\n      //   },\r\n      //   body: JSON.stringify(submissionData),\r\n      // });\r\n\r\n      // For Phase 1/2, just show success\r\n      console.log('ICS 218 Form Data:', submissionData);\r\n      setIsSubmitted(true);\r\n      localStorage.removeItem('ics218-draft');\r\n      toast.success('Form submitted successfully!');\r\n      \r\n    } catch (error) {\r\n      console.error('Submission error:', error);\r\n      toast.error('Failed to submit form. Please try again.');\r\n      throw error;\r\n    }\r\n  };\r\n\r\n  const CurrentStepComponent = STEPS[currentStep].component;\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50 dark:bg-gray-900\">\r\n      {/* Navigation Header */}\r\n      <div className=\"bg-gradient-to-r from-orange-600 to-orange-700 border-b border-orange-800 sticky top-0 z-50 shadow-lg\">\r\n        <div className=\"max-w-4xl mx-auto px-4 py-3\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <button\r\n              onClick={() => navigate('/')}\r\n              className=\"flex items-center gap-2 text-white hover:bg-white/10 px-3 py-2 rounded-lg transition-colors\"\r\n            >\r\n              <ArrowLeft className=\"w-5 h-5\" />\r\n              <span className=\"font-medium\">Back to Form Hub</span>\r\n            </button>\r\n            <button\r\n              onClick={() => navigate('/admin')}\r\n              className=\"flex items-center gap-2 text-white hover:bg-white/10 px-3 py-2 rounded-lg transition-colors\"\r\n            >\r\n              <LayoutDashboard className=\"w-5 h-5\" />\r\n              <span className=\"font-medium\">Admin Dashboard</span>\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Header */}\r\n      <div className=\"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 sticky top-[52px] z-40 shadow-sm\">\r\n        <div className=\"max-w-4xl mx-auto px-4 py-4\">\r\n          <div className=\"flex items-center justify-between mb-4\">\r\n            <div className=\"flex items-center gap-3 flex-1\">\r\n              <img \r\n                src=\"/taskforce-io-logo.png\" \r\n                alt=\"TASKFORCE IO\" \r\n                className=\"w-10 h-10 object-contain\"\r\n              />\r\n              <div>\r\n                <h1 className=\"text-xl font-bold text-gray-900 dark:text-white\">\r\n                  ICS-218 Support Vehicle/Equipment Inventory\r\n                </h1>\r\n                <p className=\"text-sm text-gray-600 dark:text-gray-400\">\r\n                  Step {currentStep + 1} of {STEPS.length}: {STEPS[currentStep].title}\r\n                </p>\r\n              </div>\r\n            </div>\r\n            <div className=\"flex gap-2\">\r\n              <button\r\n                type=\"button\"\r\n                onClick={handleManualSave}\r\n                className=\"p-2 rounded-lg bg-orange-100 text-orange-600 hover:bg-orange-200 transition-colors\"\r\n                title=\"Save Draft\"\r\n              >\r\n                <Save className=\"w-5 h-5\" />\r\n              </button>\r\n              <button\r\n                type=\"button\"\r\n                onClick={handleClearForm}\r\n                className=\"p-2 rounded-lg bg-red-100 text-red-600 hover:bg-red-200 transition-colors\"\r\n                title=\"Clear Form\"\r\n              >\r\n                <Trash2 className=\"w-5 h-5\" />\r\n              </button>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Progress Indicator */}\r\n          <ProgressIndicator\r\n            currentStep={currentStep + 1}\r\n            totalSteps={STEPS.length}\r\n            labels={STEPS.map(s => s.title)}\r\n          />\r\n        </div>\r\n      </div>\r\n\r\n      {/* Form Content */}\r\n      <div className=\"max-w-4xl mx-auto\">\r\n        <AnimatePresence mode=\"wait\">\r\n          <motion.div\r\n            key={currentStep}\r\n            initial={{ opacity: 0, x: 20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            exit={{ opacity: 0, x: -20 }}\r\n            transition={{ duration: 0.3 }}\r\n          >\r\n            <CurrentStepComponent\r\n              formData={formData}\r\n              onChange={handleFieldChange}\r\n              onNext={handleNext}\r\n              onBack={handleBack}\r\n              onGoToStep={handleGoToStep}\r\n              onSubmit={handleSubmit}\r\n              errors={errors}\r\n            />\r\n          </motion.div>\r\n        </AnimatePresence>\r\n      </div>\r\n\r\n      {/* Draft Recovery Dialog */}\r\n      <AnimatePresence>\r\n        {showDraftDialog && (\r\n          <motion.div\r\n            className=\"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4\"\r\n            initial={{ opacity: 0 }}\r\n            animate={{ opacity: 1 }}\r\n            exit={{ opacity: 0 }}\r\n          >\r\n            <motion.div\r\n              className=\"bg-white dark:bg-gray-800 rounded-xl shadow-2xl max-w-md w-full p-6\"\r\n              initial={{ scale: 0.9, y: 20 }}\r\n              animate={{ scale: 1, y: 0 }}\r\n              exit={{ scale: 0.9, y: 20 }}\r\n            >\r\n              <h3 className=\"text-xl font-bold text-gray-900 dark:text-white mb-2\">\r\n                Resume Draft?\r\n              </h3>\r\n              <p className=\"text-gray-600 dark:text-gray-400 mb-4\">\r\n                We found a saved draft from{' '}\r\n                {recoveredDraft && new Date(recoveredDraft.savedAt).toLocaleString()}.\r\n                Would you like to resume where you left off?\r\n              </p>\r\n              <div className=\"flex gap-3\">\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={handleDiscardDraft}\r\n                  className=\"flex-1 px-4 py-3 bg-gray-200 hover:bg-gray-300 text-gray-800 font-semibold rounded-xl transition-colors\"\r\n                >\r\n                  Start Fresh\r\n                </button>\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={handleResumeDraft}\r\n                  className=\"flex-1 px-4 py-3 bg-orange-600 hover:bg-orange-700 text-white font-semibold rounded-xl transition-colors\"\r\n                >\r\n                  Resume Draft\r\n                </button>\r\n              </div>\r\n            </motion.div>\r\n          </motion.div>\r\n        )}\r\n      </AnimatePresence>\r\n\r\n      {/* Submission Success Screen */}\r\n      <AnimatePresence>\r\n        {isSubmitted && (\r\n          <motion.div\r\n            className=\"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4\"\r\n            initial={{ opacity: 0 }}\r\n            animate={{ opacity: 1 }}\r\n          >\r\n            <motion.div\r\n              className=\"bg-white dark:bg-gray-800 rounded-xl shadow-2xl max-w-md w-full p-8 text-center\"\r\n              initial={{ scale: 0.9, y: 20 }}\r\n              animate={{ scale: 1, y: 0 }}\r\n            >\r\n              <div className=\"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4\">\r\n                <svg className=\"w-8 h-8 text-green-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 13l4 4L19 7\" />\r\n                </svg>\r\n              </div>\r\n              <h3 className=\"text-2xl font-bold text-gray-900 dark:text-white mb-2\">\r\n                Form Submitted!\r\n              </h3>\r\n              <p className=\"text-gray-600 dark:text-gray-400 mb-6\">\r\n                Your ICS-218 form has been successfully submitted and logged.\r\n              </p>\r\n              <div className=\"flex gap-3\">\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => navigate('/')}\r\n                  className=\"flex-1 px-6 py-3 bg-gray-200 hover:bg-gray-300 text-gray-800 font-semibold rounded-xl transition-colors\"\r\n                >\r\n                  Go Home\r\n                </button>\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => {\r\n                    setIsSubmitted(false);\r\n                    setFormData(INITIAL_FORM_DATA);\r\n                    setCurrentStep(0);\r\n                  }}\r\n                  className=\"flex-1 px-6 py-3 bg-orange-600 hover:bg-orange-700 text-white font-semibold rounded-xl transition-colors\"\r\n                >\r\n                  New Form\r\n                </button>\r\n              </div>\r\n            </motion.div>\r\n          </motion.div>\r\n        )}\r\n      </AnimatePresence>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ICS218Form;\r\n"],"names":["VEHICLE_CATEGORIES","IncidentInfoStep","formData","onChange","onNext","errors","handleSubmit","e","getCurrentDate","getCurrentTime","now","hours","minutes","jsxs","motion","jsx","category","TouchFeedback","VehicleAutocomplete","value","onVehicleSelect","apiEndpoint","className","error","isOpen","setIsOpen","useState","vehicles","setVehicles","isLoading","setIsLoading","searchQuery","setSearchQuery","debounceTimer","useRef","containerRef","useEffect","response","data","handleClickOutside","event","handleInputChange","newValue","handleVehicleSelect","vehicle","AnimatePresence","SkeletonLoader","VehicleTableStep","onBack","expandedRow","setExpandedRow","handleAddVehicle","newVehicle","updatedVehicles","handleRemoveVehicle","index","_","i","handleVehicleFieldChange","field","handleAirtableVehicleSelect","selectedVehicle","PreparedByStep","showSignaturePad","setShowSignaturePad","handleSignatureSave","signature","handleSignatureClear","SignatureCanvas","ReviewStep","onSubmit","onGoToStep","isSubmitting","setIsSubmitting","STEPS","INITIAL_FORM_DATA","ICS218Form","navigate","useNavigate","currentStep","setCurrentStep","setFormData","setErrors","isSubmitted","setIsSubmitted","showDraftDialog","setShowDraftDialog","recoveredDraft","setRecoveredDraft","saveInterval","draft","toast","draftJson","handleResumeDraft","handleDiscardDraft","handleFieldChange","prev","newErrors","validateStep","step","handleNext","handleBack","handleGoToStep","handleManualSave","handleClearForm","submissionData","CurrentStepComponent","ArrowLeft","LayoutDashboard","Save","Trash2","ProgressIndicator","s"],"mappings":"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"}